<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ğŸ”§ ÙØ­Øµ Supabase - Elite Investors</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Arial', sans-serif;
        }
        
        body {
            background: #0f172a;
            color: white;
            padding: 20px;
        }
        
        .container {
            max-width: 800px;
            margin: 0 auto;
        }
        
        h1 {
            color: #7c3aed;
            text-align: center;
            margin-bottom: 30px;
        }
        
        .test-card {
            background: #1e293b;
            border-radius: 20px;
            padding: 25px;
            margin-bottom: 20px;
            border: 2px solid #7c3aed;
        }
        
        .success {
            background: rgba(16, 185, 129, 0.2);
            border: 2px solid #10b981;
            color: #10b981;
        }
        
        .error {
            background: rgba(239, 68, 68, 0.2);
            border: 2px solid #ef4444;
            color: #ef4444;
        }
        
        .warning {
            background: rgba(245, 158, 11, 0.2);
            border: 2px solid #f59e0b;
            color: #f59e0b;
        }
        
        .step {
            padding: 15px;
            background: rgba(255,255,255,0.05);
            border-radius: 10px;
            margin-bottom: 15px;
        }
        
        .btn {
            background: #7c3aed;
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 50px;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
            width: 100%;
            margin-top: 20px;
        }
        
        .code {
            background: #0f172a;
            padding: 15px;
            border-radius: 10px;
            font-family: monospace;
            direction: ltr;
            text-align: left;
            overflow-x: auto;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ”§ ÙØ­Øµ Ø§ØªØµØ§Ù„ Supabase</h1>
        
        <div id="results">
            <div class="test-card" id="step1">
                <h3>ğŸ“¡ 1. ØªØ­Ù…ÙŠÙ„ Ù…ÙƒØªØ¨Ø© Supabase</h3>
                <div id="step1-status">â³ Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„...</div>
            </div>
        </div>
        
        <button class="btn" onclick="location.reload()">
            <i class="fas fa-redo"></i> Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„ÙØ­Øµ
        </button>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <script>
        const SUPABASE_URL = 'https://wabyirjjhndrwxvcrdvn.supabase.co';
        const SUPABASE_ANON_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6IndhYnlpcmpqaG5kcnd4dmNyZHZuIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NzA4OTM0OTAsImV4cCI6MjA4NjQ2OTQ5MH0.AWDpHfWQLBto-Jn8_9fO0UmPS5Da9pgX611Bl6Q6u2w';
        
        async function runTests() {
            // ========== Ø§Ù„Ø®Ø·ÙˆØ© 1: ÙØ­Øµ Ù…ÙƒØªØ¨Ø© Supabase ==========
            const step1 = document.getElementById('step1');
            const step1Status = document.getElementById('step1-status');
            
            if (typeof window.supabase === 'undefined') {
                step1Status.innerHTML = 'âŒ Ù…ÙƒØªØ¨Ø© Supabase ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯Ø©!';
                step1.classList.add('error');
                return;
            } else {
                step1Status.innerHTML = 'âœ… Ù…ÙƒØªØ¨Ø© Supabase Ù…ÙˆØ¬ÙˆØ¯Ø©';
                step1.classList.add('success');
            }
            
            // ========== Ø§Ù„Ø®Ø·ÙˆØ© 2: Ø¥Ù†Ø´Ø§Ø¡ Ø§ØªØµØ§Ù„ ==========
            const step2 = document.createElement('div');
            step2.className = 'test-card';
            step2.innerHTML = '<h3>ğŸ”Œ 2. Ø¥Ù†Ø´Ø§Ø¡ Ø§ØªØµØ§Ù„ Supabase</h3><div id="step2-status">â³ Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø§ØªØµØ§Ù„...</div>';
            document.getElementById('results').appendChild(step2);
            
            let supabase;
            try {
                supabase = window.supabase.createClient(SUPABASE_URL, SUPABASE_ANON_KEY);
                document.getElementById('step2-status').innerHTML = 'âœ… ØªÙ… Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ù†Ø¬Ø§Ø­';
                step2.classList.add('success');
            } catch (e) {
                document.getElementById('step2-status').innerHTML = `âŒ ÙØ´Ù„ Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø§ØªØµØ§Ù„: ${e.message}`;
                step2.classList.add('error');
                return;
            }
            
            // ========== Ø§Ù„Ø®Ø·ÙˆØ© 3: Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ==========
            const step3 = document.createElement('div');
            step3.className = 'test-card';
            step3.innerHTML = '<h3>ğŸ—„ï¸ 3. Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª</h3><div id="step3-status">â³ Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±...</div>';
            document.getElementById('results').appendChild(step3);
            
            try {
                const { data, error } = await supabase.from('packages').select('count', { count: 'exact', head: true });
                
                if (error) {
                    throw error;
                }
                
                document.getElementById('step3-status').innerHTML = 'âœ… Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù†Ø§Ø¬Ø­';
                step3.classList.add('success');
            } catch (e) {
                document.getElementById('step3-status').innerHTML = `âŒ ÙØ´Ù„ Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª: ${e.message}`;
                step3.classList.add('error');
                
                // Ø¹Ø±Ø¶ Ø§Ù„Ø­Ù„
                const solution = document.createElement('div');
                solution.className = 'test-card warning';
                solution.innerHTML = `
                    <h3>ğŸ’¡ Ø§Ù„Ø­Ù„ Ø§Ù„Ù…Ù‚ØªØ±Ø­</h3>
                    <p style="margin-bottom: 15px;">Ø§Ù„Ù…Ø´ÙƒÙ„Ø© ÙÙŠ ØµÙ„Ø§Ø­ÙŠØ§Øª RLS. Ø´ØºÙ„ Ù‡Ø°Ø§ Ø§Ù„ÙƒÙˆØ¯ ÙÙŠ SQL Editor:</p>
                    <div class="code">
ALTER TABLE packages DISABLE ROW LEVEL SECURITY;<br>
GRANT SELECT ON packages TO anon;<br>
GRANT SELECT ON packages TO authenticated;<br>
<br>
INSERT INTO packages (id, name, price, profit, daily_profit, tasks, duration, category, status) VALUES<br>
    (1, 'Ø§Ù„Ø¨Ø§Ù‚Ø© Ø§Ù„ÙØ¶ÙŠØ©', 500, 2.5, 12.5, 5, 30, 'standard', 'active'),<br>
    (2, 'Ø§Ù„Ø¨Ø§Ù‚Ø© Ø§Ù„Ø°Ù‡Ø¨ÙŠØ©', 1000, 2.5, 25, 5, 30, 'premium', 'active'),<br>
    (3, 'Ø§Ù„Ø¨Ø§Ù‚Ø© Ø§Ù„Ù…Ø§Ø³ÙŠØ©', 5000, 2.5, 125, 5, 30, 'vip', 'active');<br>
<br>
SELECT * FROM packages;
                    </div>
                `;
                document.getElementById('results').appendChild(solution);
                return;
            }
            
            // ========== Ø§Ù„Ø®Ø·ÙˆØ© 4: Ø¬Ù„Ø¨ Ø§Ù„Ø¨Ø§Ù‚Ø§Øª ==========
            const step4 = document.createElement('div');
            step4.className = 'test-card';
            step4.innerHTML = '<h3>ğŸ“¦ 4. Ø¬Ù„Ø¨ Ø§Ù„Ø¨Ø§Ù‚Ø§Øª</h3><div id="step4-status">â³ Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„...</div>';
            document.getElementById('results').appendChild(step4);
            
            try {
                const { data, error } = await supabase
                    .from('packages')
                    .select('*')
                    .eq('status', 'active')
                    .order('price', { ascending: true });
                
                if (error) throw error;
                
                if (data && data.length > 0) {
                    document.getElementById('step4-status').innerHTML = `âœ… ØªÙ… ØªØ­Ù…ÙŠÙ„ ${data.length} Ø¨Ø§Ù‚Ø©`;
                    step4.classList.add('success');
                    
                    // Ø¹Ø±Ø¶ Ø§Ù„Ø¨Ø§Ù‚Ø§Øª
                    const packagesList = document.createElement('div');
                    packagesList.className = 'test-card success';
                    packagesList.innerHTML = '<h3>ğŸ“Š Ø§Ù„Ø¨Ø§Ù‚Ø§Øª Ø§Ù„Ù…ÙˆØ¬ÙˆØ¯Ø©</h3>';
                    
                    data.forEach(pkg => {
                        packagesList.innerHTML += `
                            <div style="margin-top: 15px; padding: 15px; background: rgba(255,255,255,0.05); border-radius: 10px;">
                                <strong>${pkg.name}</strong> - ${pkg.price}$ (${pkg.category})
                            </div>
                        `;
                    });
                    
                    document.getElementById('results').appendChild(packagesList);
                } else {
                    document.getElementById('step4-status').innerHTML = 'âš ï¸ Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¨Ø§Ù‚Ø§Øª ÙÙŠ Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª';
                    step4.classList.add('warning');
                }
            } catch (e) {
                document.getElementById('step4-status').innerHTML = `âŒ ÙØ´Ù„ Ø¬Ù„Ø¨ Ø§Ù„Ø¨Ø§Ù‚Ø§Øª: ${e.message}`;
                step4.classList.add('error');
            }
        }
        
        runTests();
    </script>
</body>
</html>