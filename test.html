<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ğŸ” ØªØ´Ø®ÙŠØµ Ù…Ø´Ø§ÙƒÙ„ Elite Investors</title>
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: system-ui, 'Segoe UI', Tahoma, sans-serif;
        }
        body {
            background: #0f172a;
            color: white;
            padding: 15px;
            min-height: 100vh;
        }
        .container {
            max-width: 500px;
            margin: 0 auto;
        }
        h1 {
            color: #7c3aed;
            font-size: 22px;
            text-align: center;
            margin-bottom: 25px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }
        .card {
            background: #1e293b;
            border-radius: 20px;
            padding: 20px;
            margin-bottom: 20px;
            border: 1px solid #7c3aed30;
        }
        .status-item {
            background: #0f172a;
            border-radius: 12px;
            padding: 15px;
            margin-bottom: 12px;
        }
        .status-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 8px;
        }
        .status-name {
            font-weight: bold;
            color: #cbd5e1;
        }
        .status-badge {
            padding: 5px 12px;
            border-radius: 30px;
            font-size: 13px;
            font-weight: bold;
        }
        .badge-success {
            background: #10b98120;
            color: #10b981;
            border: 1px solid #10b981;
        }
        .badge-error {
            background: #ef444420;
            color: #ef4444;
            border: 1px solid #ef4444;
        }
        .badge-warning {
            background: #f59e0b20;
            color: #f59e0b;
            border: 1px solid #f59e0b;
        }
        .details {
            background: #00000030;
            padding: 12px;
            border-radius: 8px;
            font-family: monospace;
            font-size: 13px;
            color: #94a3b8;
            margin-top: 10px;
            word-break: break-word;
        }
        .btn {
            background: #7c3aed;
            color: white;
            border: none;
            padding: 15px;
            border-radius: 12px;
            font-weight: bold;
            width: 100%;
            margin: 5px 0;
            cursor: pointer;
            font-size: 16px;
        }
        .btn-outline {
            background: transparent;
            border: 2px solid #7c3aed;
            color: #7c3aed;
        }
        .btn-success {
            background: #10b981;
        }
        .login-box {
            background: #0f172a;
            border-radius: 12px;
            padding: 20px;
            margin-top: 15px;
        }
        .login-box input {
            width: 100%;
            padding: 12px;
            margin: 8px 0;
            background: #1e293b;
            border: 1px solid #334155;
            border-radius: 8px;
            color: white;
        }
        .row {
            display: flex;
            gap: 10px;
        }
        .small {
            font-size: 12px;
            color: #94a3b8;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>
            <span>ğŸ”</span>
            ØªØ´Ø®ÙŠØµ Ø§Ù„Ù…Ø´Ø§ÙƒÙ„ - Elite Investors
        </h1>

        <!-- Ù†ØªØ§Ø¦Ø¬ Ø§Ù„ØªØ´Ø®ÙŠØµ -->
        <div class="card">
            <div style="display: flex; justify-content: space-between; margin-bottom: 15px;">
                <span style="color: #7c3aed; font-weight: bold;">ğŸ“‹ Ù†ØªØ§Ø¦Ø¬ Ø§Ù„ÙØ­Øµ</span>
                <span class="small" id="timestamp"></span>
            </div>
            
            <div id="results">
                <div class="status-item">
                    <div class="status-header">
                        <span class="status-name">ğŸ”„ Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ´Ø®ÙŠØµ...</span>
                    </div>
                </div>
            </div>
        </div>

        <!-- Ø§Ø®ØªØ¨Ø§Ø± ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø§Ù„Ø³Ø±ÙŠØ¹ -->
        <div class="card">
            <div style="color: #7c3aed; font-weight: bold; margin-bottom: 15px;">ğŸ”‘ Ø§Ø®ØªØ¨Ø§Ø± ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„</div>
            
            <div class="login-box">
                <input type="text" id="loginUser" placeholder="Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…" value="admin">
                <input type="password" id="loginPass" placeholder="ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±" value="admin123">
                <button class="btn btn-success" onclick="testLogin()" style="margin-top: 10px;">ğŸ”“ ØªØ¬Ø±Ø¨Ø© ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„</button>
                <div id="loginResult" style="margin-top: 15px; padding: 10px; background: #1e293b; border-radius: 8px;"></div>
            </div>
        </div>

        <!-- Ø£Ø²Ø±Ø§Ø± Ø§Ù„ØªØ­ÙƒÙ… -->
        <div class="row">
            <button class="btn btn-outline" onclick="runDiagnostic()" style="flex: 1;">ğŸ”„ Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„ÙØ­Øµ</button>
            <button class="btn btn-outline" onclick="clearAll()" style="flex: 1;">ğŸ§¹ ØªÙ†Ø¸ÙŠÙ</button>
        </div>
        <button class="btn" onclick="fixRLS()">ğŸ”§ Ù…Ø­Ø§ÙˆÙ„Ø© Ø¥ØµÙ„Ø§Ø­ RLS</button>
        <button class="btn btn-outline" onclick="window.location.reload()">ğŸ”„ ØªØ­Ø¯ÙŠØ« Ø§Ù„ØµÙØ­Ø©</button>

        <!-- Ø³Ø¬Ù„ Ø§Ù„Ø£Ø®Ø·Ø§Ø¡ -->
        <div class="card">
            <div style="color: #ef4444; margin-bottom: 10px;">âš ï¸ Ø³Ø¬Ù„ Ø§Ù„Ø£Ø®Ø·Ø§Ø¡</div>
            <div id="errorLog" style="background: #0f172a; padding: 15px; border-radius: 8px; font-family: monospace; font-size: 12px; max-height: 200px; overflow-y: auto;"></div>
        </div>
    </div>

    <script>
        // Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Supabase
        const SUPABASE_URL = 'https://kfwbcewtnfoofllhxron.supabase.co';
        const SUPABASE_ANON_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Imtmd2JjZXd0bmZvb2ZsbGh4cm9uIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NzA5MjEwMzksImV4cCI6MjA4NjQ5NzAzOX0.Mgf7Dg4Ji3eKHQPz3SUGTfwSfsl7anYneA4ZPIYgbIU';

        let supabase = null;
        
        // Ø¯Ø§Ù„Ø© ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø£Ø®Ø·Ø§Ø¡
        function logError(msg, error = null) {
            const log = document.getElementById('errorLog');
            const time = new Date().toLocaleTimeString();
            const errorText = error ? ` - ${error.message || error}` : '';
            log.innerHTML = `<div style="color: #ef4444;">âŒ [${time}] ${msg}${errorText}</div>` + log.innerHTML;
            console.error(msg, error);
        }

        function logSuccess(msg) {
            const log = document.getElementById('errorLog');
            const time = new Date().toLocaleTimeString();
            log.innerHTML = `<div style="color: #10b981;">âœ… [${time}] ${msg}</div>` + log.innerHTML;
        }

        function logInfo(msg) {
            const log = document.getElementById('errorLog');
            const time = new Date().toLocaleTimeString();
            log.innerHTML = `<div style="color: #3b82f6;">â„¹ï¸ [${time}] ${msg}</div>` + log.innerHTML;
        }

        // ØªØ´ØºÙŠÙ„ Ø§Ù„ØªØ´Ø®ÙŠØµ
        async function runDiagnostic() {
            document.getElementById('timestamp').textContent = new Date().toLocaleString();
            
            let resultsHTML = '';
            
            // 1. ÙØªØ­ Ø§Ù„Ø§ØªØµØ§Ù„
            try {
                if (typeof supabase === 'undefined') throw new Error('Ù…ÙƒØªØ¨Ø© Supabase ØºÙŠØ± Ù…Ø­Ù…Ù„Ø©');
                supabase = window.supabase.createClient(SUPABASE_URL, SUPABASE_ANON_KEY);
                
                resultsHTML += `
                    <div class="status-item">
                        <div class="status-header">
                            <span class="status-name">ğŸ“¡ Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª</span>
                            <span class="status-badge badge-success">âœ… Ù†Ø§Ø¬Ø­</span>
                        </div>
                        <div class="details">âœ… ØªÙ… Ø¥Ù†Ø´Ø§Ø¡ Ø¹Ù…ÙŠÙ„ Supabase Ø¨Ù†Ø¬Ø§Ø­</div>
                    </div>
                `;
                logSuccess('Ø§ØªØµØ§Ù„ Supabase Ù†Ø§Ø¬Ø­');
            } catch (e) {
                resultsHTML += `
                    <div class="status-item">
                        <div class="status-header">
                            <span class="status-name">ğŸ“¡ Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª</span>
                            <span class="status-badge badge-error">âŒ ÙØ´Ù„</span>
                        </div>
                        <div class="details error">${e.message}</div>
                    </div>
                `;
                logError('ÙØ´Ù„ Ø§Ù„Ø§ØªØµØ§Ù„', e);
                document.getElementById('results').innerHTML = resultsHTML;
                return;
            }

            // 2. ÙØ­Øµ Ø§Ù„Ø¬Ø¯Ø§ÙˆÙ„
            const tables = ['users', 'packages', 'tasks'];
            for (const table of tables) {
                try {
                    const { data, error } = await supabase
                        .from(table)
                        .select('count', { count: 'exact', head: true });
                    
                    if (error && error.code === '42P01') {
                        resultsHTML += `
                            <div class="status-item">
                                <div class="status-header">
                                    <span class="status-name">ğŸ“Š Ø¬Ø¯ÙˆÙ„ ${table}</span>
                                    <span class="status-badge badge-error">âŒ ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯</span>
                                </div>
                                <div class="details">Ø§Ù„Ø¬Ø¯ÙˆÙ„ ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯ ÙÙŠ Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª - ÙŠØ¬Ø¨ Ø¥Ù†Ø´Ø§Ø¤Ù‡ Ø£ÙˆÙ„Ø§Ù‹</div>
                            </div>
                        `;
                        logError(`Ø§Ù„Ø¬Ø¯ÙˆÙ„ ${table} ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯`);
                    } else if (error) {
                        resultsHTML += `
                            <div class="status-item">
                                <div class="status-header">
                                    <span class="status-name">ğŸ“Š Ø¬Ø¯ÙˆÙ„ ${table}</span>
                                    <span class="status-badge badge-error">âŒ Ø®Ø·Ø£</span>
                                </div>
                                <div class="details">${error.message}</div>
                            </div>
                        `;
                        logError(`Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø¬Ø¯ÙˆÙ„ ${table}`, error);
                    } else {
                        resultsHTML += `
                            <div class="status-item">
                                <div class="status-header">
                                    <span class="status-name">ğŸ“Š Ø¬Ø¯ÙˆÙ„ ${table}</span>
                                    <span class="status-badge badge-success">âœ… Ù…ÙˆØ¬ÙˆØ¯</span>
                                </div>
                                <div class="details">Ø§Ù„Ø¬Ø¯ÙˆÙ„ Ù…ÙˆØ¬ÙˆØ¯ ÙˆÙŠØ¹Ù…Ù„ Ø¨Ø´ÙƒÙ„ Ø·Ø¨ÙŠØ¹ÙŠ</div>
                            </div>
                        `;
                        logSuccess(`Ø§Ù„Ø¬Ø¯ÙˆÙ„ ${table} Ù…ÙˆØ¬ÙˆØ¯`);
                    }
                } catch (e) {
                    resultsHTML += `
                        <div class="status-item">
                            <div class="status-header">
                                <span class="status-name">ğŸ“Š Ø¬Ø¯ÙˆÙ„ ${table}</span>
                                <span class="status-badge badge-error">âŒ Ø§Ø³ØªØ«Ù†Ø§Ø¡</span>
                            </div>
                            <div class="details">${e.message}</div>
                        </div>
                    `;
                    logError(`Ø§Ø³ØªØ«Ù†Ø§Ø¡ ÙÙŠ Ø§Ù„Ø¬Ø¯ÙˆÙ„ ${table}`, e);
                }
            }

            // 3. ÙØ­Øµ RLS
            try {
                const { data, error } = await supabase
                    .from('users')
                    .select('*')
                    .limit(1);
                
                if (error && error.code === '42501') {
                    resultsHTML += `
                        <div class="status-item">
                            <div class="status-header">
                                <span class="status-name">ğŸ”’ RLS (ØµÙ„Ø§Ø­ÙŠØ§Øª)</span>
                                <span class="status-badge badge-error">âŒ Ù…Ù‚ÙŠØ¯</span>
                            </div>
                            <div class="details">
                                RLS ÙŠÙ…Ù†Ø¹ Ø§Ù„ÙˆØµÙˆÙ„! Ù‡Ø°Ø§ Ù‡Ùˆ Ø³Ø¨Ø¨ Ø§Ù„Ù…Ø´ÙƒÙ„Ø©.<br>
                                <strong>Ø§Ù„Ø­Ù„:</strong> Ø§Ø¶ØºØ· Ø¹Ù„Ù‰ Ø²Ø± "Ù…Ø­Ø§ÙˆÙ„Ø© Ø¥ØµÙ„Ø§Ø­ RLS"
                            </div>
                        </div>
                    `;
                    logError('RLS ÙŠÙ…Ù†Ø¹ Ø§Ù„ÙˆØµÙˆÙ„ - Ù‡Ø°Ø§ Ù‡Ùˆ Ø§Ù„Ù…Ø´ÙƒÙ„Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©');
                } else if (error) {
                    resultsHTML += `
                        <div class="status-item">
                            <div class="status-header">
                                <span class="status-name">ğŸ”’ RLS</span>
                                <span class="status-badge badge-error">âŒ Ø®Ø·Ø£</span>
                            </div>
                            <div class="details">${error.message}</div>
                        </div>
                    `;
                } else {
                    resultsHTML += `
                        <div class="status-item">
                            <div class="status-header">
                                <span class="status-name">ğŸ”’ RLS</span>
                                <span class="status-badge badge-success">âœ… Ù…ÙØªÙˆØ­</span>
                            </div>
                            <div class="details">RLS Ù…ÙØªÙˆØ­ØŒ ÙŠÙ…ÙƒÙ† Ø§Ù„ÙˆØµÙˆÙ„ Ù„Ù„Ø¨ÙŠØ§Ù†Ø§Øª</div>
                        </div>
                    `;
                }
            } catch (e) {
                resultsHTML += `
                    <div class="status-item">
                        <div class="status-header">
                            <span class="status-name">ğŸ”’ RLS</span>
                            <span class="status-badge badge-error">âŒ Ø®Ø·Ø£</span>
                        </div>
                        <div class="details">${e.message}</div>
                    </div>
                `;
            }

            // 4. ÙØ­Øµ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†
            try {
                const { data: users, error } = await supabase
                    .from('users')
                    .select('username, password, name, is_admin, balance');
                
                if (error) throw error;
                
                if (users && users.length > 0) {
                    let usersList = '';
                    users.forEach(u => {
                        usersList += `ğŸ‘¤ ${u.username} / ${u.password} - ${u.name} (${u.is_admin ? 'Ù…Ø´Ø±Ù' : 'Ù…Ø³ØªØ®Ø¯Ù…'}) ğŸ’° ${u.balance || 0}$<br>`;
                    });
                    
                    resultsHTML += `
                        <div class="status-item">
                            <div class="status-header">
                                <span class="status-name">ğŸ‘¥ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†</span>
                                <span class="status-badge badge-success">âœ… ${users.length} Ù…Ø³ØªØ®Ø¯Ù…</span>
                            </div>
                            <div class="details">${usersList}</div>
                        </div>
                    `;
                    logSuccess(`ØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ ${users.length} Ù…Ø³ØªØ®Ø¯Ù…`);
                    
                    // ØªØ®Ø²ÙŠÙ† Ù„Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù…
                    window.testUsers = users;
                } else {
                    resultsHTML += `
                        <div class="status-item">
                            <div class="status-header">
                                <span class="status-name">ğŸ‘¥ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†</span>
                                <span class="status-badge badge-warning">âš ï¸ Ù„Ø§ ÙŠÙˆØ¬Ø¯</span>
                            </div>
                            <div class="details">Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ† ÙÙŠ Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª</div>
                        </div>
                    `;
                }
            } catch (e) {
                resultsHTML += `
                    <div class="status-item">
                        <div class="status-header">
                            <span class="status-name">ğŸ‘¥ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†</span>
                            <span class="status-badge badge-error">âŒ ÙØ´Ù„</span>
                        </div>
                        <div class="details">${e.message}</div>
                    </div>
                `;
            }

            // 5. ÙØ­Øµ Ø§Ù„Ø¨Ø§Ù‚Ø§Øª
            try {
                const { data: packages, error } = await supabase
                    .from('packages')
                    .select('*');
                
                if (error) throw error;
                
                if (packages && packages.length > 0) {
                    resultsHTML += `
                        <div class="status-item">
                            <div class="status-header">
                                <span class="status-name">ğŸ“¦ Ø§Ù„Ø¨Ø§Ù‚Ø§Øª</span>
                                <span class="status-badge badge-success">âœ… ${packages.length} Ø¨Ø§Ù‚Ø©</span>
                            </div>
                            <div class="details">
                                ${packages.map(p => `${p.name} - ${p.price}$`).join('<br>')}
                            </div>
                        </div>
                    `;
                } else {
                    resultsHTML += `
                        <div class="status-item">
                            <div class="status-header">
                                <span class="status-name">ğŸ“¦ Ø§Ù„Ø¨Ø§Ù‚Ø§Øª</span>
                                <span class="status-badge badge-warning">âš ï¸ Ù„Ø§ ÙŠÙˆØ¬Ø¯</span>
                            </div>
                            <div class="details">Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ø¨Ø§Ù‚Ø§Øª ÙÙŠ Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª</div>
                        </div>
                    `;
                }
            } catch (e) {
                resultsHTML += `
                    <div class="status-item">
                        <div class="status-header">
                            <span class="status-name">ğŸ“¦ Ø§Ù„Ø¨Ø§Ù‚Ø§Øª</span>
                            <span class="status-badge badge-error">âŒ ÙØ´Ù„</span>
                        </div>
                        <div class="details">${e.message}</div>
                    </div>
                `;
            }

            document.getElementById('results').innerHTML = resultsHTML;
        }

        // Ø§Ø®ØªØ¨Ø§Ø± ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„
        async function testLogin() {
            const username = document.getElementById('loginUser').value;
            const password = document.getElementById('loginPass').value;
            const resultDiv = document.getElementById('loginResult');
            
            resultDiv.innerHTML = 'ğŸ”„ Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù‚Ù‚...';
            
            try {
                const { data: user, error } = await supabase
                    .from('users')
                    .select('*')
                    .or(`username.eq.${username},email.eq.${username}`)
                    .eq('password', password)
                    .maybeSingle();
                
                if (error) throw error;
                
                if (user) {
                    resultDiv.innerHTML = `
                        <div style="color: #10b981;">
                            âœ… ØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø¨Ù†Ø¬Ø§Ø­<br>
                            ğŸ‘¤ ${user.name}<br>
                            ğŸ’° Ø§Ù„Ø±ØµÙŠØ¯: ${user.balance || 0}$
                        </div>
                    `;
                    logSuccess(`ØªØ³Ø¬ÙŠÙ„ Ø¯Ø®ÙˆÙ„ Ù†Ø§Ø¬Ø­: ${user.username}`);
                } else {
                    resultDiv.innerHTML = `
                        <div style="color: #ef4444;">
                            âŒ Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø£Ùˆ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± ØºÙŠØ± ØµØ­ÙŠØ­Ø©
                        </div>
                    `;
                }
            } catch (e) {
                resultDiv.innerHTML = `
                    <div style="color: #ef4444;">
                        âŒ Ø®Ø·Ø£: ${e.message}
                    </div>
                `;
                logError('ÙØ´Ù„ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„', e);
            }
        }

        // Ù…Ø­Ø§ÙˆÙ„Ø© Ø¥ØµÙ„Ø§Ø­ RLS
        async function fixRLS() {
            if (!confirm('âš ï¸ Ù‡Ø°Ø§ Ø³ÙŠØ­Ø§ÙˆÙ„ ØªØ¹Ø·ÙŠÙ„ RLS Ù…Ø¤Ù‚ØªØ§Ù‹. Ù‡Ù„ ØªØ±ÙŠØ¯ Ø§Ù„Ù…ØªØ§Ø¨Ø¹Ø©ØŸ')) return;
            
            try {
                // Ù…Ø­Ø§ÙˆÙ„Ø© ØªÙ†ÙÙŠØ° SQL Ù„ØªØ¹Ø·ÙŠÙ„ RLS (ÙŠØ­ØªØ§Ø¬ ØµÙ„Ø§Ø­ÙŠØ§Øª)
                const { error } = await supabase.rpc('disable_rls_temp');
                
                if (error) {
                    logError('ÙØ´Ù„ ØªØ¹Ø·ÙŠÙ„ RLS - ØªØ­ØªØ§Ø¬ Ù„ØªÙ†ÙÙŠØ° SQL ÙŠØ¯ÙˆÙŠØ§Ù‹', error);
                    alert('âŒ ÙØ´Ù„ ØªØ¹Ø·ÙŠÙ„ RLS. ØªØ­ØªØ§Ø¬ Ù„ØªÙ†ÙÙŠØ° Ø£ÙˆØ§Ù…Ø± SQL ÙÙŠ Supabase Dashboard.');
                } else {
                    logSuccess('ØªÙ… ØªØ¹Ø·ÙŠÙ„ RLS Ø¨Ù†Ø¬Ø§Ø­');
                    alert('âœ… ØªÙ… ØªØ¹Ø·ÙŠÙ„ RLS. Ø¬Ø±Ø¨ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø§Ù„Ø¢Ù†.');
                    runDiagnostic();
                }
            } catch (e) {
                logError('ÙØ´Ù„ ØªØ¹Ø·ÙŠÙ„ RLS', e);
                
                // Ø¹Ø±Ø¶ Ø§Ù„Ø­Ù„ Ø§Ù„ÙŠØ¯ÙˆÙŠ
                alert(`âŒ ÙØ´Ù„ ØªØ¹Ø·ÙŠÙ„ RLS ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹.
                
Ø§Ù„Ø­Ù„: Ø§Ø¯Ø®Ù„ Ø¥Ù„Ù‰ Supabase Dashboard:
1. Ø§Ø°Ù‡Ø¨ Ø¥Ù„Ù‰ Authentication > Policies
2. Ø§Ø­Ø°Ù Ø¬Ù…ÙŠØ¹ policies Ø£Ùˆ Ø¹Ø·Ù„ RLS Ù…Ù† Ø§Ù„Ø¬Ø¯Ø§ÙˆÙ„
                
Ø£Ùˆ Ù†ÙØ° Ù‡Ø°Ø§ SQL ÙÙŠ SQL Editor:

ALTER TABLE users DISABLE ROW LEVEL SECURITY;
ALTER TABLE packages DISABLE ROW LEVEL SECURITY;
ALTER TABLE tasks DISABLE ROW LEVEL SECURITY;`);
            }
        }

        // ØªÙ†Ø¸ÙŠÙ Ø§Ù„ØªØ®Ø²ÙŠÙ† Ø§Ù„Ù…Ø­Ù„ÙŠ
        function clearAll() {
            localStorage.clear();
            sessionStorage.clear();
            logSuccess('ØªÙ… ØªÙ†Ø¸ÙŠÙ localStorage Ùˆ sessionStorage');
            alert('âœ… ØªÙ… Ø§Ù„ØªÙ†Ø¸ÙŠÙ. Ø¬Ø±Ø¨ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø§Ù„Ø¢Ù†.');
            setTimeout(() => location.reload(), 1000);
        }

        // ØªØ´ØºÙŠÙ„ ØªÙ„Ù‚Ø§Ø¦ÙŠ
        window.onload = () => {
            document.getElementById('timestamp').textContent = new Date().toLocaleString();
            setTimeout(runDiagnostic, 500);
        };

        // ØªØµØ¯ÙŠØ± Ø§Ù„Ø¯ÙˆØ§Ù„
        window.runDiagnostic = runDiagnostic;
        window.testLogin = testLogin;
        window.fixRLS = fixRLS;
        window.clearAll = clearAll;
    </script>
</body>
</html>