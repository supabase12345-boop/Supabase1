<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=yes">
    <title>Elite Investors | Ù„ÙˆØ­Ø© Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©</title>
    
    <!-- Fonts & Icons -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <!-- Supabase -->
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    
    <style>
        /* ===== Ø§Ù„Ù…ØªØºÙŠØ±Ø§Øª ÙˆØ§Ù„Ø£Ø³Ø§Ø³ÙŠØ§Øª ===== */
        :root {
            --primary: #8b5cf6;
            --primary-dark: #7c3aed;
            --primary-light: #a78bfa;
            --secondary: #06b6d4;
            --success: #10b981;
            --warning: #f59e0b;
            --danger: #ef4444;
            --dark: #0f172a;
            --dark-light: #1e293b;
            --dark-card: #1e293b;
            --text: #f8fafc;
            --text-muted: #94a3b8;
            --border: rgba(139, 92, 246, 0.2);
            --gradient: linear-gradient(135deg, var(--primary), var(--secondary));
            --shadow: 0 10px 40px rgba(0, 0, 0, 0.3);
            --shadow-lg: 0 20px 60px rgba(139, 92, 246, 0.3);
            --radius: 24px;
            --radius-sm: 16px;
            --transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Cairo', sans-serif;
            background: var(--dark);
            color: var(--text);
            line-height: 1.6;
            overflow-x: hidden;
            min-height: 100vh;
        }

        /* ===== Ø§Ù„Ø®Ù„ÙÙŠØ© ===== */
        .bg-gradient {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: radial-gradient(circle at 20% 30%, rgba(139, 92, 246, 0.15) 0%, transparent 50%),
                        radial-gradient(circle at 80% 70%, rgba(6, 182, 212, 0.15) 0%, transparent 50%);
            pointer-events: none;
            z-index: -1;
        }

        /* ===== Ø§Ù„Ø­Ø§ÙˆÙŠØ© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ© ===== */
        .admin-wrapper {
            display: flex;
            min-height: 100vh;
            position: relative;
        }

        /* ===== Ø§Ù„Ø´Ø±ÙŠØ· Ø§Ù„Ø¬Ø§Ù†Ø¨ÙŠ Ø§Ù„ÙØ§Ø®Ø± ===== */
        .sidebar {
            width: 280px;
            background: rgba(15, 23, 42, 0.95);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            border-left: 2px solid var(--border);
            padding: 25px;
            position: fixed;
            height: 100vh;
            overflow-y: auto;
            z-index: 100;
            box-shadow: var(--shadow);
        }

        .sidebar-header {
            text-align: center;
            padding: 20px 0;
            margin-bottom: 30px;
            border-bottom: 2px solid var(--border);
        }

        .logo {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 12px;
            margin-bottom: 10px;
        }

        .logo-icon {
            width: 50px;
            height: 50px;
            background: var(--gradient);
            border-radius: 15px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            color: white;
            transform: rotate(45deg);
            transition: var(--transition);
        }

        .logo-icon i {
            transform: rotate(-45deg);
        }

        .logo-text {
            font-size: 20px;
            font-weight: 800;
            background: var(--gradient);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .sidebar-header small {
            color: var(--text-muted);
            font-size: 12px;
        }

        .sidebar-menu {
            list-style: none;
        }

        .sidebar-menu li {
            margin-bottom: 8px;
        }

        .sidebar-menu a {
            display: flex;
            align-items: center;
            gap: 15px;
            padding: 15px 20px;
            color: var(--text-muted);
            text-decoration: none;
            border-radius: 15px;
            transition: var(--transition);
            border: 1px solid transparent;
            cursor: pointer;
            font-weight: 500;
        }

        .sidebar-menu a:hover {
            background: rgba(139, 92, 246, 0.1);
            color: var(--primary);
            border-color: var(--border);
            transform: translateX(-5px);
        }

        .sidebar-menu a.active {
            background: var(--gradient);
            color: white;
            box-shadow: var(--shadow-lg);
        }

        .sidebar-menu i {
            width: 24px;
            font-size: 18px;
        }

        .sidebar-menu .badge {
            background: var(--danger);
            color: white;
            padding: 4px 8px;
            border-radius: 20px;
            font-size: 11px;
            margin-right: auto;
        }

        /* ===== Ø§Ù„Ù…Ø­ØªÙˆÙ‰ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ ===== */
        .main-content {
            flex: 1;
            margin-right: 280px;
            padding: 25px;
        }

        /* ===== Ø±Ø£Ø³ Ø§Ù„ØµÙØ­Ø© ===== */
        .admin-header {
            background: rgba(30, 41, 59, 0.8);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            padding: 20px 30px;
            border-radius: var(--radius-sm);
            margin-bottom: 25px;
            border: 1px solid var(--border);
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: var(--shadow);
        }

        .admin-header h2 {
            font-size: 24px;
            background: var(--gradient);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        /* ===== Ø¨Ø·Ø§Ù‚Ø§Øª Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª ===== */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(240px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .stat-card {
            background: rgba(30, 41, 59, 0.8);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            padding: 25px;
            border-radius: var(--radius-sm);
            border: 1px solid var(--border);
            transition: var(--transition);
            position: relative;
            overflow: hidden;
        }

        .stat-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 4px;
            background: var(--gradient);
        }

        .stat-card:hover {
            transform: translateY(-5px);
            box-shadow: var(--shadow-lg);
        }

        .stat-icon {
            font-size: 32px;
            color: var(--primary);
            margin-bottom: 15px;
        }

        .stat-value {
            font-size: 32px;
            font-weight: 700;
            color: var(--success);
            margin-bottom: 5px;
        }

        .stat-label {
            color: var(--text-muted);
            font-size: 14px;
        }

        /* ===== Ø§Ù„Ø¬Ø¯Ø§ÙˆÙ„ Ø§Ù„ÙØ§Ø®Ø±Ø© ===== */
        .admin-table {
            background: rgba(30, 41, 59, 0.8);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            border-radius: var(--radius-sm);
            overflow: hidden;
            border: 1px solid var(--border);
            margin-top: 20px;
        }

        .admin-table table {
            width: 100%;
            border-collapse: collapse;
        }

        .admin-table th {
            background: rgba(139, 92, 246, 0.15);
            padding: 18px 15px;
            text-align: right;
            font-weight: 600;
            font-size: 14px;
            color: var(--text);
            border-bottom: 2px solid var(--border);
        }

        .admin-table td {
            padding: 15px;
            border-bottom: 1px solid var(--border);
            font-size: 14px;
        }

        .admin-table tr:hover {
            background: rgba(139, 92, 246, 0.05);
        }

        /* ===== Ø£Ø²Ø±Ø§Ø± ÙØ§Ø®Ø±Ø© ===== */
        .btn {
            padding: 12px 24px;
            border-radius: 50px;
            border: none;
            font-weight: 600;
            font-size: 14px;
            cursor: pointer;
            transition: var(--transition);
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            position: relative;
            overflow: hidden;
        }

        .btn::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 0;
            height: 0;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.2);
            transform: translate(-50%, -50%);
            transition: width 0.6s, height 0.6s;
        }

        .btn:hover::before {
            width: 300px;
            height: 300px;
        }

        .btn-primary {
            background: var(--gradient);
            color: white;
        }

        .btn-success {
            background: linear-gradient(135deg, var(--success), #059669);
            color: white;
        }

        .btn-warning {
            background: linear-gradient(135deg, var(--warning), #d97706);
            color: white;
        }

        .btn-danger {
            background: linear-gradient(135deg, var(--danger), #dc2626);
            color: white;
        }

        .btn-purple {
            background: linear-gradient(135deg, #8b5cf6, #7c3aed);
            color: white;
        }

        .btn-sm {
            padding: 8px 16px;
            font-size: 12px;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.3);
        }

        /* ===== Ø§Ù„Ù†Ù…Ø§Ø°Ø¬ ===== */
        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            color: var(--text-muted);
            font-size: 14px;
            font-weight: 500;
        }

        .form-control {
            width: 100%;
            padding: 14px 18px;
            background: rgba(255, 255, 255, 0.03);
            border: 2px solid var(--border);
            border-radius: 15px;
            color: white;
            font-size: 14px;
            transition: var(--transition);
            font-family: 'Cairo', sans-serif;
        }

        .form-control:focus {
            outline: none;
            border-color: var(--primary);
            background: rgba(139, 92, 246, 0.05);
        }

        select.form-control {
            cursor: pointer;
        }

        textarea.form-control {
            resize: vertical;
            min-height: 80px;
        }

        /* ===== Ø§Ù„Ø¨Ø­Ø« ÙˆØ§Ù„ØªØµÙÙŠØ© ===== */
        .search-box {
            background: rgba(30, 41, 59, 0.8);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            padding: 20px;
            border-radius: var(--radius-sm);
            margin-bottom: 20px;
            border: 1px solid var(--border);
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
        }

        .search-input {
            flex: 1;
            min-width: 250px;
            padding: 12px 18px;
            background: rgba(255, 255, 255, 0.03);
            border: 2px solid var(--border);
            border-radius: 15px;
            color: white;
            font-size: 14px;
        }

        .search-input:focus {
            outline: none;
            border-color: var(--primary);
        }

        /* ===== Ø§Ù„Ø£Ù‚Ø³Ø§Ù… ===== */
        .section {
            display: none;
        }

        .section.active {
            display: block;
            animation: fadeIn 0.3s ease;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* ===== Ø­Ø§Ù„Ø§Øª Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… ===== */
        .status-badge {
            padding: 6px 16px;
            border-radius: 50px;
            font-size: 12px;
            font-weight: 600;
            display: inline-block;
        }

        .status-active {
            background: rgba(16, 185, 129, 0.2);
            color: var(--success);
            border: 1px solid var(--success);
        }

        .status-pending {
            background: rgba(245, 158, 11, 0.2);
            color: var(--warning);
            border: 1px solid var(--warning);
        }

        .status-suspended {
            background: rgba(245, 158, 11, 0.2);
            color: #f59e0b;
            border: 1px solid #f59e0b;
        }

        .status-banned {
            background: rgba(239, 68, 68, 0.2);
            color: var(--danger);
            border: 1px solid var(--danger);
        }

        .status-approved {
            background: rgba(16, 185, 129, 0.2);
            color: var(--success);
            border: 1px solid var(--success);
        }

        .status-rejected {
            background: rgba(239, 68, 68, 0.2);
            color: var(--danger);
            border: 1px solid var(--danger);
        }

        /* ===== ÙƒÙˆØ¯ Ø§Ù„Ø¥Ø­Ø§Ù„Ø© ===== */
        .referral-code {
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            padding: 5px 12px;
            border-radius: 8px;
            font-family: monospace;
            font-size: 12px;
            color: white;
            display: inline-block;
        }

        .commission-badge {
            background: var(--success);
            color: white;
            padding: 4px 10px;
            border-radius: 6px;
            font-size: 11px;
            font-weight: 600;
        }

        /* ===== Ø§Ù„ØªØ¨ÙˆÙŠØ¶ ===== */
        .tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            background: rgba(255, 255, 255, 0.03);
            padding: 5px;
            border-radius: 50px;
        }

        .tab {
            flex: 1;
            padding: 12px;
            background: none;
            border: none;
            color: var(--text-muted);
            cursor: pointer;
            border-radius: 50px;
            font-weight: 600;
            transition: var(--transition);
        }

        .tab.active {
            background: var(--gradient);
            color: white;
        }

        /* ===== Ø§Ù„Ù†ÙˆØ§ÙØ° Ø§Ù„Ù…Ù†Ø¨Ø«Ù‚Ø© ===== */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            z-index: 2000;
            align-items: center;
            justify-content: center;
            padding: 20px;
        }

        .modal.active {
            display: flex;
            animation: fadeIn 0.3s ease;
        }

        .modal-content {
            background: var(--dark-card);
            border-radius: var(--radius);
            padding: 35px;
            width: 100%;
            max-width: 550px;
            border: 2px solid var(--primary);
            box-shadow: var(--shadow-lg);
            animation: slideUp 0.3s ease;
            max-height: 90vh;
            overflow-y: auto;
        }

        .modal-content.large {
            max-width: 750px;
        }

        @keyframes slideUp {
            from {
                opacity: 0;
                transform: translateY(50px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 25px;
        }

        .modal-header h2 {
            font-size: 24px;
            background: var(--gradient);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .close-btn {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.05);
            border: none;
            color: white;
            font-size: 18px;
            cursor: pointer;
            transition: var(--transition);
        }

        .close-btn:hover {
            background: var(--danger);
            transform: rotate(90deg);
        }

        /* ===== Ø§Ù„ØªØ­Ù…ÙŠÙ„ ===== */
        .loading {
            text-align: center;
            padding: 40px;
            color: var(--text-muted);
        }

        .loading i {
            font-size: 40px;
            margin-bottom: 15px;
            color: var(--primary);
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        /* ===== Ø­Ø§Ù„Ø© Ø§Ù„Ø§ØªØµØ§Ù„ ===== */
        .sync-status {
            position: fixed;
            bottom: 20px;
            left: 300px;
            background: rgba(30, 41, 59, 0.95);
            backdrop-filter: blur(10px);
            padding: 10px 20px;
            border-radius: 50px;
            border: 1px solid var(--border);
            font-size: 13px;
            display: flex;
            align-items: center;
            gap: 10px;
            z-index: 999;
            box-shadow: var(--shadow);
        }

        .sync-status.online {
            border-color: var(--success);
            color: var(--success);
        }

        .sync-status.offline {
            border-color: var(--danger);
            color: var(--danger);
        }

        /* ===== Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±Ø§Øª ===== */
        .admin-notification {
            position: fixed;
            top: 100px;
            left: 50%;
            transform: translateX(-50%);
            background: var(--success);
            color: white;
            padding: 15px 30px;
            border-radius: 15px;
            display: none;
            z-index: 3000;
            box-shadow: var(--shadow-lg);
            border-right: 6px solid white;
            min-width: 350px;
            text-align: center;
            font-weight: 500;
            animation: slideDown 0.3s ease;
        }

        .admin-notification.error {
            background: var(--danger);
        }

        @keyframes slideDown {
            from {
                opacity: 0;
                transform: translate(-50%, -30px);
            }
            to {
                opacity: 1;
                transform: translate(-50%, 0);
            }
        }

        /* ===== Ø§Ù„ØªØ±Ù‚ÙŠÙ… ===== */
        .pagination {
            display: flex;
            justify-content: center;
            gap: 10px;
            padding: 20px;
        }

        /* ===== Ø§Ù„ØªØ¬Ø§ÙˆØ¨ Ù…Ø¹ Ø§Ù„Ø´Ø§Ø´Ø§Øª ===== */
        @media (max-width: 1200px) {
            .stats-grid {
                grid-template-columns: repeat(3, 1fr);
            }
        }

        @media (max-width: 992px) {
            .sidebar {
                width: 240px;
            }
            .main-content {
                margin-right: 240px;
            }
            .stats-grid {
                grid-template-columns: repeat(2, 1fr);
            }
            .sync-status {
                left: 260px;
            }
        }

        @media (max-width: 768px) {
            .sidebar {
                position: relative;
                width: 100%;
                height: auto;
            }
            .main-content {
                margin-right: 0;
            }
            .stats-grid {
                grid-template-columns: 1fr;
            }
            .sync-status {
                left: 20px;
                bottom: 80px;
            }
            .admin-header {
                flex-direction: column;
                gap: 15px;
                text-align: center;
            }
            .admin-table {
                overflow-x: auto;
            }
            .admin-table table {
                min-width: 800px;
            }
            .search-box {
                flex-direction: column;
            }
            .search-input {
                width: 100%;
            }
        }

        @media (max-width: 480px) {
            .modal-content {
                padding: 25px;
            }
            .admin-notification {
                min-width: auto;
                right: 10px;
                left: 10px;
            }
        }

        .glass-effect {
            background: rgba(255, 255, 255, 0.03);
            backdrop-filter: blur(10px);
            border: 1px solid var(--border);
        }

        .gradient-text {
            background: var(--gradient);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }
    </style>
</head>
<body>
    <div class="bg-gradient"></div>

    <div class="admin-wrapper">
        <!-- Ø§Ù„Ø´Ø±ÙŠØ· Ø§Ù„Ø¬Ø§Ù†Ø¨ÙŠ -->
        <div class="sidebar">
            <div class="sidebar-header">
                <div class="logo">
                    <div class="logo-icon">
                        <i class="fas fa-shield-alt"></i>
                    </div>
                    <span class="logo-text">Elite Investors</span>
                </div>
                <small>Ù„ÙˆØ­Ø© Ø§Ù„Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…ØªÙ‚Ø¯Ù…Ø© v3.0</small>
            </div>

            <ul class="sidebar-menu">
                <li><a href="#" class="active" onclick="showSection('dashboard'); return false;">
                    <i class="fas fa-tachometer-alt"></i> Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…
                </a></li>
                <li><a href="#" onclick="showSection('users'); return false;">
                    <i class="fas fa-users"></i> Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†
                    <span id="usersCount" class="badge">0</span>
                </a></li>
                <li><a href="#" onclick="showSection('packages'); return false;">
                    <i class="fas fa-crown"></i> Ø§Ù„Ø¨Ø§Ù‚Ø§Øª
                    <span id="packagesCount" class="badge">0</span>
                </a></li>
                <li><a href="#" onclick="showSection('pending'); return false;">
                    <i class="fas fa-clock"></i> Ø§Ù„Ø·Ù„Ø¨Ø§Øª Ø§Ù„Ù…Ø¹Ù„Ù‚Ø©
                    <span id="pendingCount" class="badge">0</span>
                </a></li>
                <li><a href="#" onclick="showSection('withdrawals'); return false;">
                    <i class="fas fa-money-bill-wave"></i> Ø·Ù„Ø¨Ø§Øª Ø§Ù„Ø³Ø­Ø¨
                    <span id="withdrawalsCount" class="badge">0</span>
                </a></li>
                <li><a href="#" onclick="showSection('subscriptions'); return false;">
                    <i class="fas fa-shopping-cart"></i> Ø§Ù„Ø§Ø´ØªØ±Ø§ÙƒØ§Øª
                    <span id="subscriptionsCount" class="badge">0</span>
                </a></li>
                <li><a href="#" onclick="showSection('referrals'); return false;">
                    <i class="fas fa-user-friends"></i> Ø§Ù„Ø¥Ø­Ø§Ù„Ø§Øª
                </a></li>
                <li><a href="#" onclick="showSection('transactions'); return false;">
                    <i class="fas fa-exchange-alt"></i> Ø§Ù„Ù…Ø¹Ø§Ù…Ù„Ø§Øª
                </a></li>
                <li><a href="index.html">
                    <i class="fas fa-sign-out-alt" style="color: var(--danger);"></i> Ø§Ù„Ø¹ÙˆØ¯Ø© Ù„Ù„Ù…ÙˆÙ‚Ø¹
                </a></li>
            </ul>
        </div>

        <!-- Ø§Ù„Ù…Ø­ØªÙˆÙ‰ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ -->
        <div class="main-content">
            <!-- Ù‚Ø³Ù… Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ… -->
            <div id="dashboard-section" class="section active">
                <div class="admin-header">
                    <h2><i class="fas fa-chart-pie"></i> Ù†Ø¸Ø±Ø© Ø¹Ø§Ù…Ø© Ø¹Ù„Ù‰ Ø§Ù„Ù†Ø¸Ø§Ù…</h2>
                    <button class="btn btn-primary btn-sm" onclick="refreshDashboard()">
                        <i class="fas fa-sync-alt"></i> ØªØ­Ø¯ÙŠØ«
                    </button>
                </div>

                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-icon"><i class="fas fa-users"></i></div>
                        <div class="stat-value" id="totalUsers">0</div>
                        <div class="stat-label">Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon"><i class="fas fa-user-check"></i></div>
                        <div class="stat-value" id="activeUsers">0</div>
                        <div class="stat-label">Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ† Ø§Ù„Ù†Ø´Ø·ÙŠÙ†</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon"><i class="fas fa-crown"></i></div>
                        <div class="stat-value" id="totalSubscribers">0</div>
                        <div class="stat-label">Ø§Ù„Ù…Ø´ØªØ±ÙƒÙŠÙ†</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon"><i class="fas fa-clock"></i></div>
                        <div class="stat-value" id="totalPending">0</div>
                        <div class="stat-label">Ø·Ù„Ø¨Ø§Øª Ù…Ø¹Ù„Ù‚Ø©</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon"><i class="fas fa-money-bill-wave"></i></div>
                        <div class="stat-value" id="totalDeposits">0$</div>
                        <div class="stat-label">Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø¥ÙŠØ¯Ø§Ø¹Ø§Øª</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon"><i class="fas fa-hand-holding-usd"></i></div>
                        <div class="stat-value" id="totalWithdrawals">0$</div>
                        <div class="stat-label">Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù…Ø³Ø­ÙˆØ¨Ø§Øª</div>
                    </div>
                </div>
            </div>

            <!-- Ù‚Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ† -->
            <div id="users-section" class="section">
                <div class="admin-header">
                    <h2><i class="fas fa-users-cog"></i> Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†</h2>
                    <div>
                        <button class="btn btn-success btn-sm" onclick="showAddUserModal()">
                            <i class="fas fa-plus"></i> Ø¥Ø¶Ø§ÙØ© Ù…Ø³ØªØ®Ø¯Ù…
                        </button>
                        <button class="btn btn-primary btn-sm" onclick="loadUsers()">
                            <i class="fas fa-sync-alt"></i>
                        </button>
                    </div>
                </div>

                <div class="search-box">
                    <input type="text" class="search-input" id="userSearch" placeholder="ğŸ” Ø¨Ø­Ø« Ø¹Ù† Ù…Ø³ØªØ®Ø¯Ù…..." onkeyup="searchUsers()">
                    <select class="search-input" id="userStatusFilter" onchange="filterUsers()">
                        <option value="all">Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ø§Ù„Ø§Øª</option>
                        <option value="active">ğŸŸ¢ Ù†Ø´Ø·</option>
                        <option value="suspended">ğŸŸ  Ù…Ø¹Ù„Ù‚</option>
                        <option value="banned">ğŸ”´ Ù…Ø­Ø¸ÙˆØ±</option>
                    </select>
                </div>

                <div class="admin-table">
                    <table>
                        <thead>
                            <tr>
                                <th>#</th>
                                <th>Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…</th>
                                <th>Ø§Ù„Ø¨Ø±ÙŠØ¯</th>
                                <th>Ø§Ù„Ù‡Ø§ØªÙ</th>
                                <th>Ø§Ù„Ø±ØµÙŠØ¯</th>
                                <th>Ø§Ù„Ø¨Ø§Ù‚Ø©</th>
                                <th>Ø§Ù„Ø­Ø§Ù„Ø©</th>
                                <th>Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª</th>
                            </tr>
                        </thead>
                        <tbody id="usersTable">
                            <tr><td colspan="8" class="loading"><i class="fas fa-spinner fa-spin"></i><br>Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„...</td></tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Ù‚Ø³Ù… Ø§Ù„Ø¨Ø§Ù‚Ø§Øª -->
            <div id="packages-section" class="section">
                <div class="admin-header">
                    <h2><i class="fas fa-crown"></i> Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø¨Ø§Ù‚Ø§Øª</h2>
                    <button class="btn btn-success btn-sm" onclick="showAddPackageModal()">
                        <i class="fas fa-plus"></i> Ø¥Ø¶Ø§ÙØ© Ø¨Ø§Ù‚Ø©
                    </button>
                </div>

                <div class="admin-table">
                    <table>
                        <thead>
                            <tr>
                                <th>Ø§Ù„Ø§Ø³Ù…</th>
                                <th>Ø§Ù„Ø³Ø¹Ø±</th>
                                <th>Ø§Ù„Ø±Ø¨Ø­</th>
                                <th>Ø§Ù„ÙØ¦Ø©</th>
                                <th>Ø§Ù„Ù…Ù‡Ø§Ù…</th>
                                <th>Ø§Ù„Ù…Ø¯Ø©</th>
                                <th>Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†</th>
                                <th>Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª</th>
                            </tr>
                        </thead>
                        <tbody id="packagesTable">
                            <tr><td colspan="8" class="loading"><i class="fas fa-spinner fa-spin"></i><br>Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„...</td></tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Ù‚Ø³Ù… Ø§Ù„Ø·Ù„Ø¨Ø§Øª Ø§Ù„Ù…Ø¹Ù„Ù‚Ø© -->
            <div id="pending-section" class="section">
                <div class="admin-header">
                    <h2><i class="fas fa-clock"></i> Ø·Ù„Ø¨Ø§Øª Ø§Ù„Ø§Ø´ØªØ±Ø§Ùƒ</h2>
                    <button class="btn btn-primary btn-sm" onclick="loadPending()">
                        <i class="fas fa-sync-alt"></i> ØªØ­Ø¯ÙŠØ«
                    </button>
                </div>

                <div class="admin-table">
                    <table>
                        <thead>
                            <tr>
                                <th>Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…</th>
                                <th>Ø§Ù„Ø¨Ø§Ù‚Ø©</th>
                                <th>Ø§Ù„Ù…Ø¨Ù„Øº</th>
                                <th>Ø§Ù„ØªØ§Ø±ÙŠØ®</th>
                                <th>Ø§Ù„Ø¥Ø­Ø§Ù„Ø©</th>
                                <th>Ø§Ù„Ø­Ø§Ù„Ø©</th>
                                <th>Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª</th>
                            </tr>
                        </thead>
                        <tbody id="pendingTable">
                            <tr><td colspan="7" class="loading"><i class="fas fa-spinner fa-spin"></i><br>Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„...</td></tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Ù‚Ø³Ù… Ø·Ù„Ø¨Ø§Øª Ø§Ù„Ø³Ø­Ø¨ -->
            <div id="withdrawals-section" class="section">
                <div class="admin-header">
                    <h2><i class="fas fa-money-bill-wave"></i> Ø·Ù„Ø¨Ø§Øª Ø§Ù„Ø³Ø­Ø¨</h2>
                    <button class="btn btn-primary btn-sm" onclick="loadWithdrawals()">
                        <i class="fas fa-sync-alt"></i> ØªØ­Ø¯ÙŠØ«
                    </button>
                </div>

                <div class="admin-table">
                    <table>
                        <thead>
                            <tr>
                                <th>Ø±Ù‚Ù… Ø§Ù„Ø·Ù„Ø¨</th>
                                <th>Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…</th>
                                <th>Ø§Ù„Ù…Ø¨Ù„Øº</th>
                                <th>Ø§Ù„Ø±Ø³ÙˆÙ…</th>
                                <th>Ø§Ù„Ù…Ø­ÙØ¸Ø©</th>
                                <th>Ø§Ù„ØªØ§Ø±ÙŠØ®</th>
                                <th>Ø§Ù„Ø­Ø§Ù„Ø©</th>
                                <th>Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª</th>
                            </tr>
                        </thead>
                        <tbody id="withdrawalsTable">
                            <tr><td colspan="8" class="loading"><i class="fas fa-spinner fa-spin"></i><br>Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„...</td></tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Ù‚Ø³Ù… Ø§Ù„Ø§Ø´ØªØ±Ø§ÙƒØ§Øª -->
            <div id="subscriptions-section" class="section">
                <div class="admin-header">
                    <h2><i class="fas fa-shopping-cart"></i> Ø§Ù„Ø§Ø´ØªØ±Ø§ÙƒØ§Øª Ø§Ù„Ù†Ø´Ø·Ø©</h2>
                </div>

                <div class="admin-table">
                    <table>
                        <thead>
                            <tr>
                                <th>Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…</th>
                                <th>Ø§Ù„Ø¨Ø§Ù‚Ø©</th>
                                <th>Ø§Ù„Ù…Ø¨Ù„Øº</th>
                                <th>ØªØ§Ø±ÙŠØ® Ø§Ù„Ø§Ø´ØªØ±Ø§Ùƒ</th>
                                <th>Ø§Ù„Ø­Ø§Ù„Ø©</th>
                            </tr>
                        </thead>
                        <tbody id="subscriptionsTable">
                            <tr><td colspan="5" class="loading"><i class="fas fa-spinner fa-spin"></i><br>Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„...</td></tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Ù‚Ø³Ù… Ø§Ù„Ø¥Ø­Ø§Ù„Ø§Øª -->
            <div id="referrals-section" class="section">
                <div class="admin-header">
                    <h2><i class="fas fa-user-friends"></i> Ù†Ø¸Ø§Ù… Ø§Ù„Ø¥Ø­Ø§Ù„Ø©</h2>
                </div>

                <div class="admin-table">
                    <table>
                        <thead>
                            <tr>
                                <th>Ø§Ù„Ù…Ø³ÙˆÙ‚</th>
                                <th>ÙƒÙˆØ¯ Ø§Ù„Ø¥Ø­Ø§Ù„Ø©</th>
                                <th>Ø¹Ø¯Ø¯ Ø§Ù„Ø¥Ø­Ø§Ù„Ø§Øª</th>
                                <th>Ø§Ù„Ù†Ø´Ø·Ø©</th>
                                <th>Ø§Ù„Ø£Ø±Ø¨Ø§Ø­</th>
                                <th>Ø§Ù„Ù…Ø³ØªØ­Ù‚</th>
                            </tr>
                        </thead>
                        <tbody id="referralsTable">
                            <tr><td colspan="6" class="loading"><i class="fas fa-spinner fa-spin"></i><br>Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„...</td></tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Ù‚Ø³Ù… Ø§Ù„Ù…Ø¹Ø§Ù…Ù„Ø§Øª -->
            <div id="transactions-section" class="section">
                <div class="admin-header">
                    <h2><i class="fas fa-exchange-alt"></i> Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…Ø¹Ø§Ù…Ù„Ø§Øª</h2>
                </div>

                <div class="admin-table">
                    <table>
                        <thead>
                            <tr>
                                <th>Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…</th>
                                <th>Ø§Ù„Ù†ÙˆØ¹</th>
                                <th>Ø§Ù„ÙˆØµÙ</th>
                                <th>Ø§Ù„Ù…Ø¨Ù„Øº</th>
                                <th>Ø§Ù„ØªØ§Ø±ÙŠØ®</th>
                                <th>Ø§Ù„Ø­Ø§Ù„Ø©</th>
                            </tr>
                        </thead>
                        <tbody id="transactionsTable">
                            <tr><td colspan="6" class="loading"><i class="fas fa-spinner fa-spin"></i><br>Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„...</td></tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>

    <!-- Ù†Ø§ÙØ°Ø© Ø¥Ø¶Ø§ÙØ© Ù…Ø³ØªØ®Ø¯Ù… -->
    <div class="modal" id="addUserModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2><i class="fas fa-user-plus"></i> Ø¥Ø¶Ø§ÙØ© Ù…Ø³ØªØ®Ø¯Ù…</h2>
                <button class="close-btn" onclick="closeModal('addUserModal')"><i class="fas fa-times"></i></button>
            </div>

            <div class="form-group">
                <label>Ø§Ù„Ø§Ø³Ù… Ø§Ù„ÙƒØ§Ù…Ù„</label>
                <input type="text" class="form-control" id="userName" placeholder="Ø£Ø¯Ø®Ù„ Ø§Ù„Ø§Ø³Ù… Ø§Ù„ÙƒØ§Ù…Ù„">
            </div>
            <div class="form-group">
                <label>Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…</label>
                <input type="text" class="form-control" id="userUsername" placeholder="Ø§Ø®ØªØ± Ø§Ø³Ù… Ù…Ø³ØªØ®Ø¯Ù…">
            </div>
            <div class="form-group">
                <label>Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ</label>
                <input type="email" class="form-control" id="userEmail" placeholder="Ø£Ø¯Ø®Ù„ Ø§Ù„Ø¨Ø±ÙŠØ¯">
            </div>
            <div class="form-group">
                <label>Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ</label>
                <input type="tel" class="form-control" id="userPhone" placeholder="Ø£Ø¯Ø®Ù„ Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ">
            </div>
            <div class="form-group">
                <label>ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±</label>
                <input type="password" class="form-control" id="userPassword" value="123456">
            </div>
            <div class="form-group">
                <label>Ø§Ù„Ø±ØµÙŠØ¯ ($)</label>
                <input type="number" class="form-control" id="userBalance" value="0">
            </div>
            <div class="form-group">
                <label>Ø§Ù„Ø­Ø§Ù„Ø©</label>
                <select class="form-control" id="userStatus">
                    <option value="active">ğŸŸ¢ Ù†Ø´Ø·</option>
                    <option value="suspended">ğŸŸ  Ù…Ø¹Ù„Ù‚</option>
                    <option value="banned">ğŸ”´ Ù…Ø­Ø¸ÙˆØ±</option>
                </select>
            </div>

            <div style="display: flex; gap: 15px; margin-top: 25px;">
                <button class="btn btn-danger" style="flex: 1;" onclick="closeModal('addUserModal')">Ø¥Ù„ØºØ§Ø¡</button>
                <button class="btn btn-success" style="flex: 2;" onclick="addUser()">Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…</button>
            </div>
        </div>
    </div>

    <!-- Ù†Ø§ÙØ°Ø© Ø¥Ø¶Ø§ÙØ© Ø¨Ø§Ù‚Ø© -->
    <div class="modal" id="addPackageModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2><i class="fas fa-crown"></i> Ø¥Ø¶Ø§ÙØ© Ø¨Ø§Ù‚Ø©</h2>
                <button class="close-btn" onclick="closeModal('addPackageModal')"><i class="fas fa-times"></i></button>
            </div>

            <div class="form-group">
                <label>Ø§Ø³Ù… Ø§Ù„Ø¨Ø§Ù‚Ø©</label>
                <input type="text" class="form-control" id="packageName" placeholder="Ù…Ø«Ø§Ù„: Ø§Ù„Ø¨Ø§Ù‚Ø© Ø§Ù„Ø°Ù‡Ø¨ÙŠØ©">
            </div>
            <div class="form-group">
                <label>Ø§Ù„Ø³Ø¹Ø± ($)</label>
                <input type="number" class="form-control" id="packagePrice" placeholder="1000">
            </div>
            <div class="form-group">
                <label>Ù†Ø³Ø¨Ø© Ø§Ù„Ø±Ø¨Ø­ Ø§Ù„ÙŠÙˆÙ…ÙŠ (%)</label>
                <input type="number" class="form-control" id="packageProfit" value="2.5" step="0.1">
            </div>
            <div class="form-group">
                <label>Ø§Ù„ÙØ¦Ø©</label>
                <select class="form-control" id="packageCategory">
                    <option value="standard">ğŸ¥ˆ Ø¹Ø§Ø¯ÙŠØ©</option>
                    <option value="premium">ğŸ¥‡ Ù…Ù…ÙŠØ²Ø©</option>
                    <option value="vip">ğŸ’ VIP</option>
                </select>
            </div>
            <div class="form-group">
                <label>Ø¹Ø¯Ø¯ Ø§Ù„Ù…Ù‡Ø§Ù… Ø§Ù„ÙŠÙˆÙ…ÙŠØ©</label>
                <input type="number" class="form-control" id="packageTasks" value="5">
            </div>
            <div class="form-group">
                <label>Ù…Ø¯Ø© Ø§Ù„Ø¨Ø§Ù‚Ø© (Ø£ÙŠØ§Ù…)</label>
                <input type="number" class="form-control" id="packageDuration" value="30">
            </div>

            <div style="display: flex; gap: 15px; margin-top: 25px;">
                <button class="btn btn-danger" style="flex: 1;" onclick="closeModal('addPackageModal')">Ø¥Ù„ØºØ§Ø¡</button>
                <button class="btn btn-success" style="flex: 2;" onclick="addPackage()">Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø¨Ø§Ù‚Ø©</button>
            </div>
        </div>
    </div>

    <!-- Ù†Ø§ÙØ°Ø© Ù…Ø¹Ø§Ù„Ø¬Ø© Ø·Ù„Ø¨ Ø§Ø´ØªØ±Ø§Ùƒ -->
    <div class="modal" id="processPendingModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2><i class="fas fa-cog"></i> Ù…Ø¹Ø§Ù„Ø¬Ø© Ø§Ù„Ø·Ù„Ø¨</h2>
                <button class="close-btn" onclick="closeModal('processPendingModal')"><i class="fas fa-times"></i></button>
            </div>

            <div id="pendingRequestInfo" class="glass-effect" style="padding: 20px; border-radius: var(--radius-sm); margin-bottom: 20px;">
                <!-- Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø·Ù„Ø¨ -->
            </div>

            <div style="display: flex; gap: 15px;">
                <button class="btn btn-danger" style="flex: 1;" onclick="rejectPendingRequest()">
                    <i class="fas fa-times"></i> Ø±ÙØ¶
                </button>
                <button class="btn btn-success" style="flex: 2;" onclick="approvePendingRequest()">
                    <i class="fas fa-check"></i> Ù‚Ø¨ÙˆÙ„ ÙˆØªÙØ¹ÙŠÙ„
                </button>
            </div>
        </div>
    </div>

    <!-- Ù†Ø§ÙØ°Ø© Ù…Ø¹Ø§Ù„Ø¬Ø© Ø·Ù„Ø¨ Ø³Ø­Ø¨ -->
    <div class="modal" id="processWithdrawalModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2><i class="fas fa-money-bill-wave"></i> Ù…Ø¹Ø§Ù„Ø¬Ø© Ø§Ù„Ø³Ø­Ø¨</h2>
                <button class="close-btn" onclick="closeModal('processWithdrawalModal')"><i class="fas fa-times"></i></button>
            </div>

            <div id="withdrawalRequestInfo" class="glass-effect" style="padding: 20px; border-radius: var(--radius-sm); margin-bottom: 20px;">
                <!-- Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø·Ù„Ø¨ Ø§Ù„Ø³Ø­Ø¨ -->
            </div>

            <div class="form-group">
                <label>Ø±Ù‚Ù… Ø§Ù„Ù…Ø¹Ø§Ù…Ù„Ø© (Transaction Hash)</label>
                <input type="text" class="form-control" id="transactionHash" placeholder="Ø£Ø¯Ø®Ù„ Ø±Ù‚Ù… Ø§Ù„Ù…Ø¹Ø§Ù…Ù„Ø© Ù…Ù† Ø§Ù„Ø´Ø¨ÙƒØ©">
            </div>

            <div style="display: flex; gap: 15px;">
                <button class="btn btn-danger" style="flex: 1;" onclick="rejectWithdrawal()">
                    <i class="fas fa-times"></i> Ø±ÙØ¶
                </button>
                <button class="btn btn-success" style="flex: 2;" onclick="approveWithdrawal()">
                    <i class="fas fa-check"></i> ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø¥Ø±Ø³Ø§Ù„
                </button>
            </div>
        </div>
    </div>

    <!-- Ù†Ø§ÙØ°Ø© ØªØºÙŠÙŠØ± Ø­Ø§Ù„Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… -->
    <div class="modal" id="userStatusModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2><i class="fas fa-shield-alt"></i> ØªØºÙŠÙŠØ± Ø§Ù„Ø­Ø§Ù„Ø©</h2>
                <button class="close-btn" onclick="closeModal('userStatusModal')"><i class="fas fa-times"></i></button>
            </div>

            <div id="statusUserInfo" class="glass-effect" style="padding: 15px; border-radius: var(--radius-sm); margin-bottom: 20px;">
                <!-- Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… -->
            </div>

            <div class="form-group">
                <label>Ø§Ù„Ø­Ø§Ù„Ø© Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø©</label>
                <select class="form-control" id="newUserStatus">
                    <option value="active">ğŸŸ¢ Ù†Ø´Ø·</option>
                    <option value="suspended">ğŸŸ  Ù…Ø¹Ù„Ù‚</option>
                    <option value="banned">ğŸ”´ Ù…Ø­Ø¸ÙˆØ±</option>
                </select>
            </div>
            <div class="form-group">
                <label>Ø³Ø¨Ø¨ Ø§Ù„ØªØºÙŠÙŠØ±</label>
                <textarea class="form-control" id="statusReason" rows="3" placeholder="Ø£Ø¯Ø®Ù„ Ø³Ø¨Ø¨ ØªØºÙŠÙŠØ± Ø§Ù„Ø­Ø§Ù„Ø©..."></textarea>
            </div>

            <div style="display: flex; gap: 15px;">
                <button class="btn btn-danger" style="flex: 1;" onclick="closeModal('userStatusModal')">Ø¥Ù„ØºØ§Ø¡</button>
                <button class="btn btn-warning" style="flex: 2;" onclick="updateUserStatus()">ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø­Ø§Ù„Ø©</button>
            </div>
        </div>
    </div>

    <!-- Ø­Ø§Ù„Ø© Ø§Ù„Ø§ØªØµØ§Ù„ -->
    <div class="sync-status online" id="syncStatus">
        <i class="fas fa-wifi" id="syncIcon"></i>
        <span id="syncText">Ù…ØªØµÙ„ Ø¨Ù€ Supabase</span>
    </div>

    <!-- Ø§Ù„Ø¥Ø´Ø¹Ø§Ø± -->
    <div class="admin-notification" id="notification" style="display: none;"></div>

    <script>
        // ========== Ø§Ù„Ù…ØªØºÙŠØ±Ø§Øª Ø§Ù„Ø¹Ø§Ù…Ø© ==========
        let adminData = {
            users: [],
            packages: [],
            pending: [],
            withdrawals: [],
            subscriptions: []
        };
        let currentRequestId = null;
        let currentWithdrawalId = null;
        let currentUserId = null;
        let supabaseAvailable = false;

        // ========== Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø§ØªØµØ§Ù„ ==========
        function checkConnection() {
            supabaseAvailable = !!(window.supabaseClient && window.supabaseHelpers);
            const status = document.getElementById('syncStatus');
            status.className = supabaseAvailable ? 'sync-status online' : 'sync-status offline';
            document.getElementById('syncIcon').className = supabaseAvailable ? 'fas fa-wifi' : 'fas fa-exclamation-triangle';
            document.getElementById('syncText').textContent = supabaseAvailable ? 'Ù…ØªØµÙ„ Ø¨Ù€ Supabase' : 'ØªØ®Ø²ÙŠÙ† Ù…Ø­Ù„ÙŠ';
        }

        // ========== Ø§Ù„ØªÙ†Ù‚Ù„ Ø¨ÙŠÙ† Ø§Ù„Ø£Ù‚Ø³Ø§Ù… ==========
        function showSection(sectionId) {
            document.querySelectorAll('.section').forEach(s => s.classList.remove('active'));
            document.querySelectorAll('.sidebar-menu a').forEach(l => l.classList.remove('active'));
            
            const section = document.getElementById(sectionId + '-section');
            if (section) section.classList.add('active');
            
            const link = Array.from(document.querySelectorAll('.sidebar-menu a')).find(a => 
                a.getAttribute('onclick')?.includes(sectionId)
            );
            if (link) link.classList.add('active');
            
            // ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø­Ø³Ø¨ Ø§Ù„Ù‚Ø³Ù…
            if (sectionId === 'users') loadUsers();
            else if (sectionId === 'packages') loadPackages();
            else if (sectionId === 'pending') loadPending();
            else if (sectionId === 'withdrawals') loadWithdrawals();
            else if (sectionId === 'subscriptions') loadSubscriptions();
            else if (sectionId === 'referrals') loadReferrals();
            else if (sectionId === 'transactions') loadAllTransactions();
            else if (sectionId === 'dashboard') updateDashboardStats();
        }

        // ========== ØªØ­Ø¯ÙŠØ« Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ… ==========
        function updateDashboardStats() {
            const users = adminData.users || [];
            const activeUsers = users.filter(u => u.status === 'active' || !u.status).length;
            const subscribers = users.filter(u => u.package).length;
            
            document.getElementById('totalUsers').textContent = users.length;
            document.getElementById('activeUsers').textContent = activeUsers;
            document.getElementById('totalSubscribers').textContent = subscribers;
            document.getElementById('totalPending').textContent = adminData.pending.length;
            document.getElementById('totalDeposits').textContent = calculateTotalDeposits() + '$';
            document.getElementById('totalWithdrawals').textContent = calculateTotalWithdrawals() + '$';
            
            document.getElementById('usersCount').textContent = users.length;
            document.getElementById('packagesCount').textContent = adminData.packages.length;
            document.getElementById('pendingCount').textContent = adminData.pending.length;
            document.getElementById('withdrawalsCount').textContent = adminData.withdrawals.length;
            document.getElementById('subscriptionsCount').textContent = subscribers;
        }

        function calculateTotalDeposits() {
            let total = 0;
            adminData.users.forEach(u => {
                if (u.package) total += u.package.amount || 0;
            });
            return total.toFixed(2);
        }

        function calculateTotalWithdrawals() {
            let total = 0;
            adminData.withdrawals.forEach(w => {
                if (w.status === 'completed') total += w.amount || 0;
            });
            return total.toFixed(2);
        }

        // ========== ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ† ==========
        async function loadUsers() {
            const tbody = document.getElementById('usersTable');
            tbody.innerHTML = '<tr><td colspan="8" class="loading"><i class="fas fa-spinner fa-spin"></i><br>Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„...</td></tr>';
            
            let users = [];
            if (supabaseAvailable) {
                try {
                    const result = await window.supabaseHelpers.getAllUsers();
                    if (result.success) users = result.data;
                } catch (e) { console.log('âš ï¸ ÙØ´Ù„ Ø¬Ù„Ø¨ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†'); }
            }
            if (!users.length) users = JSON.parse(localStorage.getItem('elite_users')) || [];
            
            adminData.users = users;
            updateDashboardStats();
            
            if (!users.length) {
                tbody.innerHTML = '<tr><td colspan="8" class="loading"><i class="fas fa-users"></i><br>Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†</td></tr>';
                return;
            }
            
            let html = '';
            users.slice(0, 100).forEach((u, i) => {
                let statusClass = u.status === 'suspended' ? 'status-suspended' : u.status === 'banned' ? 'status-banned' : 'status-active';
                let statusIcon = u.status === 'suspended' ? 'ğŸŸ ' : u.status === 'banned' ? 'ğŸ”´' : 'ğŸŸ¢';
                
                html += `<tr>
                    <td>${i+1}</td>
                    <td><strong>${u.name || '?'}</strong><br><small>@${u.username || ''}</small></td>
                    <td>${u.email || ''}</td>
                    <td>${u.phone || ''}</td>
                    <td><strong>${(u.balance || 0).toFixed(2)}$</strong></td>
                    <td>${u.package ? `<span class="status-badge status-active">${u.package.name}</span>` : 'â€”'}</td>
                    <td><span class="status-badge ${statusClass}">${statusIcon} ${u.status || 'active'}</span></td>
                    <td>
                        <button class="btn btn-sm btn-warning" onclick="showUserStatusModal(${u.id})" title="ØªØºÙŠÙŠØ± Ø§Ù„Ø­Ø§Ù„Ø©"><i class="fas fa-shield-alt"></i></button>
                        <button class="btn btn-sm btn-danger" onclick="deleteUser(${u.id})" title="Ø­Ø°Ù"><i class="fas fa-trash"></i></button>
                    </td>
                </tr>`;
            });
            tbody.innerHTML = html;
        }

        // ========== ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨Ø§Ù‚Ø§Øª ==========
        async function loadPackages() {
            const tbody = document.getElementById('packagesTable');
            tbody.innerHTML = '<tr><td colspan="8" class="loading"><i class="fas fa-spinner fa-spin"></i><br>Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„...</td></tr>';
            
            let packages = [];
            if (supabaseAvailable) {
                try {
                    const result = await window.supabaseHelpers.getAllPackages();
                    if (result.success) packages = result.data;
                } catch (e) { console.log('âš ï¸ ÙØ´Ù„ Ø¬Ù„Ø¨ Ø§Ù„Ø¨Ø§Ù‚Ø§Øª'); }
            }
            if (!packages.length && window.sharedData) packages = await window.sharedData.getAllPackages();
            if (!packages.length) packages = JSON.parse(localStorage.getItem('website_packages')) || [];
            
            adminData.packages = packages;
            updateDashboardStats();
            
            if (!packages.length) {
                tbody.innerHTML = '<tr><td colspan="8" class="loading"><i class="fas fa-box-open"></i><br>Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¨Ø§Ù‚Ø§Øª</td></tr>';
                return;
            }
            
            let html = '';
            packages.forEach(p => {
                const usersCount = adminData.users.filter(u => u.package?.id === p.id).length;
                html += `<tr>
                    <td><strong>${p.name}</strong></td>
                    <td>${p.price}$</td>
                    <td>${p.profit_percentage || p.profit || 2.5}%</td>
                    <td><span class="badge">${p.category || 'standard'}</span></td>
                    <td>${p.tasks_count || p.tasks || 5}</td>
                    <td>${p.duration || 30}</td>
                    <td>${usersCount}</td>
                    <td>
                        <button class="btn btn-sm btn-danger" onclick="deletePackage(${p.id})"><i class="fas fa-trash"></i></button>
                    </td>
                </tr>`;
            });
            tbody.innerHTML = html;
        }

        // ========== ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø·Ù„Ø¨Ø§Øª Ø§Ù„Ù…Ø¹Ù„Ù‚Ø© ==========
        async function loadPending() {
            const tbody = document.getElementById('pendingTable');
            tbody.innerHTML = '<tr><td colspan="7" class="loading"><i class="fas fa-spinner fa-spin"></i><br>Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„...</td></tr>';
            
            let pending = JSON.parse(localStorage.getItem('pending_packages')) || [];
            adminData.pending = pending;
            updateDashboardStats();
            
            if (!pending.length) {
                tbody.innerHTML = '<tr><td colspan="7" class="loading"><i class="fas fa-check-circle" style="color:var(--success);"></i><br>Ù„Ø§ ØªÙˆØ¬Ø¯ Ø·Ù„Ø¨Ø§Øª Ù…Ø¹Ù„Ù‚Ø©</td></tr>';
                return;
            }
            
            let html = '';
            pending.forEach((req, i) => {
                html += `<tr>
                    <td><strong>${req.userName || req.user_name || '?'}</strong><br><small>${req.userEmail || ''}</small></td>
                    <td>${req.packageName || req.package_name}</td>
                    <td><strong>${(req.amount || 0).toFixed(2)}$</strong></td>
                    <td>${new Date(req.created_at || req.date || Date.now()).toLocaleString('ar-SA')}</td>
                    <td>${req.referredBy ? '<span class="referral-code">ğŸ ' + req.referredBy + '</span>' : 'â€”'}</td>
                    <td><span class="status-badge status-pending">â³ Ù…Ø¹Ù„Ù‚</span></td>
                    <td>
                        <button class="btn btn-sm btn-success" onclick="showPendingModal(${i})">
                            <i class="fas fa-cog"></i> Ù…Ø¹Ø§Ù„Ø¬Ø©
                        </button>
                    </td>
                </tr>`;
            });
            tbody.innerHTML = html;
        }

        // ========== ØªØ­Ù…ÙŠÙ„ Ø·Ù„Ø¨Ø§Øª Ø§Ù„Ø³Ø­Ø¨ ==========
        async function loadWithdrawals() {
            const tbody = document.getElementById('withdrawalsTable');
            tbody.innerHTML = '<tr><td colspan="8" class="loading"><i class="fas fa-spinner fa-spin"></i><br>Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„...</td></tr>';
            
            let withdrawals = [];
            
            // Ø¬Ù…Ø¹ Ø·Ù„Ø¨Ø§Øª Ø§Ù„Ø³Ø­Ø¨ Ù…Ù† Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†
            adminData.users.forEach(user => {
                const userWithdrawals = JSON.parse(localStorage.getItem(`user_withdrawals_${user.id}`)) || [];
                userWithdrawals.forEach(w => {
                    withdrawals.push({
                        ...w,
                        userName: user.name,
                        userEmail: user.email
                    });
                });
            });
            
            withdrawals.sort((a, b) => new Date(b.date || 0) - new Date(a.date || 0));
            adminData.withdrawals = withdrawals;
            updateDashboardStats();
            
            if (!withdrawals.length) {
                tbody.innerHTML = '<tr><td colspan="8" class="loading"><i class="fas fa-money-bill-wave"></i><br>Ù„Ø§ ØªÙˆØ¬Ø¯ Ø·Ù„Ø¨Ø§Øª Ø³Ø­Ø¨</td></tr>';
                return;
            }
            
            let html = '';
            withdrawals.forEach((w, i) => {
                const statusClass = w.status === 'completed' ? 'status-active' : w.status === 'rejected' ? 'status-rejected' : 'status-pending';
                const statusText = w.status === 'completed' ? 'âœ… Ù…ÙƒØªÙ…Ù„' : w.status === 'rejected' ? 'âŒ Ù…Ø±ÙÙˆØ¶' : 'â³ Ù…Ø¹Ù„Ù‚';
                
                html += `<tr>
                    <td>#WD${w.id}</td>
                    <td><strong>${w.userName}</strong><br><small>${w.userEmail}</small></td>
                    <td><strong>${(w.amount || 0).toFixed(2)}$</strong></td>
                    <td>${w.fee || 5}$</td>
                    <td><small style="font-family:monospace;">${w.wallet ? w.wallet.substring(0,15)+'...' : 'â€”'}</small></td>
                    <td>${new Date(w.date || w.created_at || Date.now()).toLocaleString('ar-SA')}</td>
                    <td><span class="status-badge ${statusClass}">${statusText}</span></td>
                    <td>
                        ${w.status === 'pending' ? 
                            `<button class="btn btn-sm btn-success" onclick="showWithdrawalModal(${i})">
                                <i class="fas fa-cog"></i> Ù…Ø¹Ø§Ù„Ø¬Ø©
                            </button>` : 
                            `<button class="btn btn-sm btn-info" onclick="viewWithdrawalDetails(${i})">
                                <i class="fas fa-eye"></i>
                            </button>`
                        }
                    </td>
                </tr>`;
            });
            tbody.innerHTML = html;
        }

        // ========== ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø§Ø´ØªØ±Ø§ÙƒØ§Øª ==========
        function loadSubscriptions() {
            const subs = adminData.users.filter(u => u.package).map(u => ({
                name: u.name,
                package: u.package.name,
                amount: u.package.amount,
                date: u.package.purchaseDate || u.package.purchase_date
            }));
            
            let html = '';
            subs.forEach(s => {
                html += `<tr>
                    <td>${s.name}</td>
                    <td>${s.package}</td>
                    <td>${s.amount}$</td>
                    <td>${s.date ? new Date(s.date).toLocaleDateString('ar-SA') : 'â€”'}</td>
                    <td><span class="status-badge status-active">âœ… Ù†Ø´Ø·</span></td>
                </tr>`;
            });
            document.getElementById('subscriptionsTable').innerHTML = html || '<tr><td colspan="5" class="loading">Ù„Ø§ ØªÙˆØ¬Ø¯ Ø§Ø´ØªØ±Ø§ÙƒØ§Øª</td></tr>';
        }

        // ========== ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¥Ø­Ø§Ù„Ø§Øª ==========
        function loadReferrals() {
            const users = adminData.users;
            const referrals = [];
            
            users.forEach(u => {
                if (u.referralCode) {
                    const referred = users.filter(r => r.referredBy === u.referralCode);
                    if (referred.length) {
                        const active = referred.filter(r => r.package).length;
                        const earnings = u.referralEarnings || 0;
                        const pending = referred.filter(r => r.package && !r.referralRewardPaid).length * 50;
                        
                        referrals.push({
                            name: u.name,
                            code: u.referralCode,
                            count: referred.length,
                            active: active,
                            earnings: earnings,
                            pending: pending
                        });
                    }
                }
            });
            
            let html = '';
            referrals.forEach(r => {
                html += `<tr>
                    <td><strong>${r.name}</strong></td>
                    <td><span class="referral-code">${r.code}</span></td>
                    <td>${r.count}</td>
                    <td>${r.active}</td>
                    <td>${r.earnings.toFixed(2)}$</td>
                    <td><span class="commission-badge">${r.pending}$</span></td>
                </tr>`;
            });
            document.getElementById('referralsTable').innerHTML = html || '<tr><td colspan="6" class="loading">Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¥Ø­Ø§Ù„Ø§Øª</td></tr>';
        }

        // ========== ØªØ­Ù…ÙŠÙ„ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…Ø¹Ø§Ù…Ù„Ø§Øª ==========
        function loadAllTransactions() {
            const tbody = document.getElementById('transactionsTable');
            let allTransactions = [];
            
            adminData.users.forEach(user => {
                const userTrans = JSON.parse(localStorage.getItem(`user_transactions_${user.id}`)) || [];
                userTrans.forEach(t => {
                    allTransactions.push({
                        ...t,
                        userName: user.name
                    });
                });
            });
            
            allTransactions.sort((a, b) => new Date(b.date || 0) - new Date(a.date || 0));
            
            let html = '';
            allTransactions.slice(0, 100).forEach(t => {
                html += `<tr>
                    <td>${t.userName || 'â€”'}</td>
                    <td>${t.type || 'â€”'}</td>
                    <td>${t.description || ''}</td>
                    <td style="color: ${t.type === 'Ø³Ø­Ø¨' ? 'var(--danger)' : 'var(--success)'};">${t.type === 'Ø³Ø­Ø¨' ? '-' : '+'}${(t.amount || 0).toFixed(2)}$</td>
                    <td>${t.date || ''}</td>
                    <td><span class="status-badge status-active">${t.status || 'Ù…ÙƒØªÙ…Ù„'}</span></td>
                </tr>`;
            });
            tbody.innerHTML = html || '<tr><td colspan="6" class="loading">Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…Ø¹Ø§Ù…Ù„Ø§Øª</td></tr>';
        }

        // ========== Ù…Ø¹Ø§Ù„Ø¬Ø© Ø·Ù„Ø¨Ø§Øª Ø§Ù„Ø§Ø´ØªØ±Ø§Ùƒ ==========
        function showPendingModal(index) {
            currentRequestId = index;
            const req = adminData.pending[index];
            
            document.getElementById('pendingRequestInfo').innerHTML = `
                <p><strong>ğŸ‘¤ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…:</strong> ${req.userName || req.user_name}</p>
                <p><strong>ğŸ“¦ Ø§Ù„Ø¨Ø§Ù‚Ø©:</strong> ${req.packageName || req.package_name}</p>
                <p><strong>ğŸ’° Ø§Ù„Ù…Ø¨Ù„Øº:</strong> ${(req.amount || 0).toFixed(2)}$</p>
                <p><strong>ğŸ“… Ø§Ù„ØªØ§Ø±ÙŠØ®:</strong> ${new Date(req.created_at || req.date || Date.now()).toLocaleString('ar-SA')}</p>
                ${req.referredBy ? '<p><span class="referral-code">ğŸ ÙƒÙˆØ¯ Ø¥Ø­Ø§Ù„Ø©: ' + req.referredBy + '</span></p>' : ''}
            `;
            document.getElementById('processPendingModal').classList.add('active');
        }

        function approvePendingRequest() {
            const req = adminData.pending[currentRequestId];
            if (!req) return;
            
            // 1. Ø­Ø°Ù Ø§Ù„Ø·Ù„Ø¨ Ù…Ù† Ø§Ù„Ù…Ø¹Ù„Ù‚Ø©
            const pending = JSON.parse(localStorage.getItem('pending_packages')) || [];
            const newPending = pending.filter((_, i) => i !== currentRequestId);
            localStorage.setItem('pending_packages', JSON.stringify(newPending));
            
            // 2. ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…
            const users = JSON.parse(localStorage.getItem('elite_users')) || [];
            const userIndex = users.findIndex(u => u.id === (req.userId || req.user_id));
            
            if (userIndex !== -1) {
                users[userIndex].package = {
                    id: req.packageId || Date.now(),
                    name: req.packageName || req.package_name,
                    amount: req.amount,
                    purchaseDate: new Date().toISOString(),
                    status: 'Ù†Ø´Ø·'
                };
                users[userIndex].pendingPackage = null;
                
                localStorage.setItem('elite_users', JSON.stringify(users));
                
                // ØªØ­Ø¯ÙŠØ« current_user Ø¥Ø°Ø§ ÙƒØ§Ù† Ù…ÙˆØ¬ÙˆØ¯Ø§Ù‹
                const currentUser = JSON.parse(localStorage.getItem('current_user'));
                if (currentUser && currentUser.id === (req.userId || req.user_id)) {
                    currentUser.package = users[userIndex].package;
                    currentUser.pendingPackage = null;
                    localStorage.setItem('current_user', JSON.stringify(currentUser));
                }
                
                // 3. Ù…Ø¹Ø§Ù„Ø¬Ø© Ø§Ù„Ø¥Ø­Ø§Ù„Ø©
                if (req.referredBy && window.sharedData) {
                    window.sharedData.processReferralRewardsOnApproval(req.userId || req.user_id, req.amount);
                }
                
                // 4. ØªØ³Ø¬ÙŠÙ„ Ù…Ø¹Ø§Ù…Ù„Ø©
                const transactions = JSON.parse(localStorage.getItem(`user_transactions_${req.userId || req.user_id}`)) || [];
                transactions.unshift({
                    id: Date.now(),
                    type: 'Ø§Ø´ØªØ±Ø§Ùƒ',
                    amount: req.amount,
                    description: `ØªÙØ¹ÙŠÙ„ Ø¨Ø§Ù‚Ø© ${req.packageName}`,
                    date: new Date().toLocaleString('ar-SA'),
                    status: 'Ù…ÙƒØªÙ…Ù„'
                });
                localStorage.setItem(`user_transactions_${req.userId || req.user_id}`, JSON.stringify(transactions));
            }
            
            closeModal('processPendingModal');
            loadPending();
            loadUsers();
            loadSubscriptions();
            loadReferrals();
            showNotification('âœ… ØªÙ… Ù‚Ø¨ÙˆÙ„ Ø§Ù„Ø·Ù„Ø¨ ÙˆØªÙØ¹ÙŠÙ„ Ø§Ù„Ø¨Ø§Ù‚Ø©');
        }

        function rejectPendingRequest() {
            const pending = JSON.parse(localStorage.getItem('pending_packages')) || [];
            const newPending = pending.filter((_, i) => i !== currentRequestId);
            localStorage.setItem('pending_packages', JSON.stringify(newPending));
            
            closeModal('processPendingModal');
            loadPending();
            showNotification('âŒ ØªÙ… Ø±ÙØ¶ Ø§Ù„Ø·Ù„Ø¨', 'error');
        }

        // ========== Ù…Ø¹Ø§Ù„Ø¬Ø© Ø·Ù„Ø¨Ø§Øª Ø§Ù„Ø³Ø­Ø¨ ==========
        function showWithdrawalModal(index) {
            currentWithdrawalId = index;
            const w = adminData.withdrawals[index];
            
            document.getElementById('withdrawalRequestInfo').innerHTML = `
                <p><strong>ğŸ‘¤ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…:</strong> ${w.userName}</p>
                <p><strong>ğŸ’° Ø§Ù„Ù…Ø¨Ù„Øº:</strong> ${(w.amount || 0).toFixed(2)}$</p>
                <p><strong>ğŸ’³ Ø§Ù„Ù…Ø­ÙØ¸Ø©:</strong> <span style="font-family:monospace;">${w.wallet}</span></p>
                <p><strong>ğŸŒ Ø§Ù„Ø´Ø¨ÙƒØ©:</strong> ${w.network}</p>
                <p><strong>ğŸ“… ØªØ§Ø±ÙŠØ® Ø§Ù„Ø·Ù„Ø¨:</strong> ${new Date(w.date || w.created_at).toLocaleString('ar-SA')}</p>
            `;
            document.getElementById('processWithdrawalModal').classList.add('active');
        }

        function approveWithdrawal() {
            const w = adminData.withdrawals[currentWithdrawalId];
            const txHash = document.getElementById('transactionHash').value.trim();
            
            if (!txHash) {
                showNotification('âŒ Ø£Ø¯Ø®Ù„ Ø±Ù‚Ù… Ø§Ù„Ù…Ø¹Ø§Ù…Ù„Ø©', 'error');
                return;
            }
            
            // ØªØ­Ø¯ÙŠØ« Ø­Ø§Ù„Ø© Ø·Ù„Ø¨ Ø§Ù„Ø³Ø­Ø¨
            const userWithdrawals = JSON.parse(localStorage.getItem(`user_withdrawals_${w.userId}`)) || [];
            const wIndex = userWithdrawals.findIndex(w2 => w2.id === w.id);
            if (wIndex !== -1) {
                userWithdrawals[wIndex].status = 'completed';
                userWithdrawals[wIndex].txHash = txHash;
                userWithdrawals[wIndex].processedDate = new Date().toISOString();
                localStorage.setItem(`user_withdrawals_${w.userId}`, JSON.stringify(userWithdrawals));
            }
            
            // ØªØ­Ø¯ÙŠØ« total_withdrawn Ù„Ù„Ù…Ø³ØªØ®Ø¯Ù…
            const users = JSON.parse(localStorage.getItem('elite_users')) || [];
            const userIndex = users.findIndex(u => u.id === w.userId);
            if (userIndex !== -1) {
                users[userIndex].totalWithdrawn = (users[userIndex].totalWithdrawn || 0) + (w.amount || 0);
                localStorage.setItem('elite_users', JSON.stringify(users));
            }
            
            closeModal('processWithdrawalModal');
            loadWithdrawals();
            showNotification('âœ… ØªÙ… ØªØ£ÙƒÙŠØ¯ Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ù…Ø¨Ù„Øº');
        }

        function rejectWithdrawal() {
            const w = adminData.withdrawals[currentWithdrawalId];
            
            // Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„Ù…Ø¨Ù„Øº Ù„Ù„Ù…Ø³ØªØ®Ø¯Ù…
            const users = JSON.parse(localStorage.getItem('elite_users')) || [];
            const userIndex = users.findIndex(u => u.id === w.userId);
            if (userIndex !== -1) {
                users[userIndex].balance += (w.amount || 0) + (w.fee || 5);
                localStorage.setItem('elite_users', JSON.stringify(users));
            }
            
            // ØªØ­Ø¯ÙŠØ« Ø­Ø§Ù„Ø© Ø§Ù„Ø·Ù„Ø¨
            const userWithdrawals = JSON.parse(localStorage.getItem(`user_withdrawals_${w.userId}`)) || [];
            const wIndex = userWithdrawals.findIndex(w2 => w2.id === w.id);
            if (wIndex !== -1) {
                userWithdrawals[wIndex].status = 'rejected';
                localStorage.setItem(`user_withdrawals_${w.userId}`, JSON.stringify(userWithdrawals));
            }
            
            closeModal('processWithdrawalModal');
            loadWithdrawals();
            loadUsers();
            showNotification('âŒ ØªÙ… Ø±ÙØ¶ Ø·Ù„Ø¨ Ø§Ù„Ø³Ø­Ø¨', 'error');
        }

        function viewWithdrawalDetails(index) {
            const w = adminData.withdrawals[index];
            alert(`ØªÙØ§ØµÙŠÙ„ Ø·Ù„Ø¨ Ø§Ù„Ø³Ø­Ø¨:\nØ§Ù„Ù…Ø¨Ù„Øº: ${w.amount}$\nØ§Ù„Ø­Ø§Ù„Ø©: ${w.status}\nØ§Ù„Ù…Ø­ÙØ¸Ø©: ${w.wallet}`);
        }

        // ========== Ø¥Ø¯Ø§Ø±Ø© Ø­Ø§Ù„Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… ==========
        function showUserStatusModal(userId) {
            currentUserId = userId;
            const user = adminData.users.find(u => u.id === userId);
            
            document.getElementById('statusUserInfo').innerHTML = `
                <p><strong>Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…:</strong> ${user.name}</p>
                <p><strong>Ø§Ù„Ø¨Ø±ÙŠØ¯:</strong> ${user.email}</p>
                <p><strong>Ø§Ù„Ø­Ø§Ù„Ø© Ø§Ù„Ø­Ø§Ù„ÙŠØ©:</strong> <span class="status-badge ${user.status === 'suspended' ? 'status-suspended' : user.status === 'banned' ? 'status-banned' : 'status-active'}">${user.status || 'active'}</span></p>
            `;
            document.getElementById('newUserStatus').value = user.status || 'active';
            document.getElementById('userStatusModal').classList.add('active');
        }

        function updateUserStatus() {
            const newStatus = document.getElementById('newUserStatus').value;
            const reason = document.getElementById('statusReason').value;
            
            const users = JSON.parse(localStorage.getItem('elite_users')) || [];
            const index = users.findIndex(u => u.id === currentUserId);
            if (index !== -1) {
                users[index].status = newStatus;
                users[index].statusReason = reason;
                users[index].statusUpdatedAt = new Date().toISOString();
                localStorage.setItem('elite_users', JSON.stringify(users));
                
                const currentUser = JSON.parse(localStorage.getItem('current_user'));
                if (currentUser && currentUser.id === currentUserId) {
                    currentUser.status = newStatus;
                    localStorage.setItem('current_user', JSON.stringify(currentUser));
                }
            }
            
            closeModal('userStatusModal');
            loadUsers();
            showNotification(`âœ… ØªÙ… ØªØºÙŠÙŠØ± Ø­Ø§Ù„Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø¥Ù„Ù‰ ${newStatus}`);
        }

        // ========== Ø¥Ø¶Ø§ÙØ© Ù…Ø³ØªØ®Ø¯Ù… ==========
        function addUser() {
            const newUser = {
                id: Date.now(),
                name: document.getElementById('userName').value,
                username: document.getElementById('userUsername').value,
                email: document.getElementById('userEmail').value,
                phone: document.getElementById('userPhone').value,
                password: document.getElementById('userPassword').value,
                balance: parseFloat(document.getElementById('userBalance').value) || 0,
                status: document.getElementById('userStatus').value,
                joinedDate: new Date().toISOString(),
                referralCode: 'REF' + Math.random().toString(36).substring(2, 8).toUpperCase()
            };
            
            const users = JSON.parse(localStorage.getItem('elite_users')) || [];
            users.push(newUser);
            localStorage.setItem('elite_users', JSON.stringify(users));
            
            closeModal('addUserModal');
            loadUsers();
            showNotification('âœ… ØªÙ…Øª Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…');
        }

        // ========== Ø¥Ø¶Ø§ÙØ© Ø¨Ø§Ù‚Ø© ==========
        function addPackage() {
            const newPackage = {
                id: Date.now(),
                name: document.getElementById('packageName').value,
                price: parseFloat(document.getElementById('packagePrice').value),
                profit: parseFloat(document.getElementById('packageProfit').value) || 2.5,
                category: document.getElementById('packageCategory').value,
                tasks: parseInt(document.getElementById('packageTasks').value) || 5,
                duration: parseInt(document.getElementById('packageDuration').value) || 30
            };
            
            if (window.sharedData) {
                window.sharedData.addPackage(newPackage);
            } else {
                const packages = JSON.parse(localStorage.getItem('website_packages')) || [];
                packages.push(newPackage);
                localStorage.setItem('website_packages', JSON.stringify(packages));
            }
            
            closeModal('addPackageModal');
            loadPackages();
            showNotification('âœ… ØªÙ…Øª Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø¨Ø§Ù‚Ø©');
        }

        // ========== Ø­Ø°Ù ==========
        function deleteUser(id) {
            if (!confirm('Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø­Ø°Ù Ù‡Ø°Ø§ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ØŸ')) return;
            
            const users = JSON.parse(localStorage.getItem('elite_users')) || [];
            const newUsers = users.filter(u => u.id !== id);
            localStorage.setItem('elite_users', JSON.stringify(newUsers));
            
            loadUsers();
            showNotification('âœ… ØªÙ… Ø­Ø°Ù Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…');
        }

        function deletePackage(id) {
            if (!confirm('Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø­Ø°Ù Ù‡Ø°Ù‡ Ø§Ù„Ø¨Ø§Ù‚Ø©ØŸ')) return;
            
            if (window.sharedData) {
                window.sharedData.deletePackage(id);
            } else {
                const packages = JSON.parse(localStorage.getItem('website_packages')) || [];
                const newPackages = packages.filter(p => p.id !== id);
                localStorage.setItem('website_packages', JSON.stringify(newPackages));
            }
            
            loadPackages();
            showNotification('âœ… ØªÙ… Ø­Ø°Ù Ø§Ù„Ø¨Ø§Ù‚Ø©');
        }

        // ========== Ø¨Ø­Ø« ÙˆØªØµÙÙŠØ© ==========
        function searchUsers() {
            const search = document.getElementById('userSearch').value.toLowerCase();
            document.querySelectorAll('#usersTable tr').forEach(row => {
                const text = row.textContent.toLowerCase();
                row.style.display = text.includes(search) ? '' : 'none';
            });
        }

        function filterUsers() {
            const filter = document.getElementById('userStatusFilter').value;
            document.querySelectorAll('#usersTable tr').forEach(row => {
                if (filter === 'all') {
                    row.style.display = '';
                    return;
                }
                const statusSpan = row.querySelector('td:nth-child(7) span');
                if (statusSpan) {
                    const status = statusSpan.textContent.includes('Ù†Ø´Ø·') ? 'active' : 
                                  statusSpan.textContent.includes('Ù…Ø¹Ù„Ù‚') ? 'suspended' : 'banned';
                    row.style.display = status === filter ? '' : 'none';
                }
            });
        }

        // ========== Ø¯ÙˆØ§Ù„ Ù…Ø³Ø§Ø¹Ø¯Ø© ==========
        function refreshDashboard() {
            loadUsers();
            loadPackages();
            loadPending();
            loadWithdrawals();
            showNotification('âœ… ØªÙ… ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª');
        }

        function showAddUserModal() { document.getElementById('addUserModal').classList.add('active'); }
        function showAddPackageModal() { document.getElementById('addPackageModal').classList.add('active'); }
        function closeModal(id) { document.getElementById(id).classList.remove('active'); }

        function showNotification(msg, type = 'success') {
            const n = document.getElementById('notification');
            n.innerHTML = `${type === 'success' ? 'âœ…' : 'âŒ'} ${msg}`;
            n.className = `admin-notification ${type}`;
            n.style.display = 'flex';
            setTimeout(() => n.style.display = 'none', 3000);
        }

        // ========== Ø§Ù„ØªÙ‡ÙŠØ¦Ø© ==========
        async function init() {
            checkConnection();
            await loadUsers();
            await loadPackages();
            await loadPending();
            await loadWithdrawals();
            loadSubscriptions();
            loadReferrals();
            loadAllTransactions();
            updateDashboardStats();
            console.log('âœ… Ù„ÙˆØ­Ø© Ø§Ù„Ø¥Ø¯Ø§Ø±Ø© Ø¬Ø§Ù‡Ø²Ø©');
        }

        document.addEventListener('DOMContentLoaded', init);
    </script>
</body>
</html>