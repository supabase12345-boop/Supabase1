<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=yes">
    <title>Elite Investors | Ù„ÙˆØ­Ø© Ø§Ù„Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…ØªÙ‚Ø¯Ù…Ø©</title>
    
    <!-- Fonts & Icons -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <!-- Supabase -->
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    
    <style>
        /* ===== Ø§Ù„Ù…ØªØºÙŠØ±Ø§Øª ÙˆØ§Ù„Ø£Ø³Ø§Ø³ÙŠØ§Øª ===== */
        :root {
            --primary: #8b5cf6;
            --primary-dark: #7c3aed;
            --primary-light: #a78bfa;
            --secondary: #06b6d4;
            --success: #10b981;
            --warning: #f59e0b;
            --danger: #ef4444;
            --dark: #0f172a;
            --dark-light: #1e293b;
            --dark-card: #1e293b;
            --text: #f8fafc;
            --text-muted: #94a3b8;
            --border: rgba(139, 92, 246, 0.2);
            --gradient: linear-gradient(135deg, var(--primary), var(--secondary));
            --shadow: 0 10px 40px rgba(0, 0, 0, 0.3);
            --shadow-lg: 0 20px 60px rgba(139, 92, 246, 0.3);
            --radius: 24px;
            --radius-sm: 16px;
            --transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Cairo', sans-serif;
            background: var(--dark);
            color: var(--text);
            line-height: 1.6;
            overflow-x: hidden;
            min-height: 100vh;
        }

        /* ===== Ø§Ù„Ø®Ù„ÙÙŠØ© ===== */
        .bg-gradient {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: radial-gradient(circle at 20% 30%, rgba(139, 92, 246, 0.15) 0%, transparent 50%),
                        radial-gradient(circle at 80% 70%, rgba(6, 182, 212, 0.15) 0%, transparent 50%);
            pointer-events: none;
            z-index: -1;
        }

        /* ===== Ø§Ù„Ø­Ø§ÙˆÙŠØ© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ© ===== */
        .admin-wrapper {
            display: flex;
            min-height: 100vh;
            position: relative;
        }

        /* ===== Ø§Ù„Ø´Ø±ÙŠØ· Ø§Ù„Ø¬Ø§Ù†Ø¨ÙŠ Ø§Ù„ÙØ§Ø®Ø± ===== */
        .sidebar {
            width: 280px;
            background: rgba(15, 23, 42, 0.95);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            border-left: 2px solid var(--border);
            padding: 25px;
            position: fixed;
            height: 100vh;
            overflow-y: auto;
            z-index: 100;
            box-shadow: var(--shadow);
        }

        .sidebar-header {
            text-align: center;
            padding: 20px 0;
            margin-bottom: 30px;
            border-bottom: 2px solid var(--border);
        }

        .logo {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 12px;
            margin-bottom: 10px;
        }

        .logo-icon {
            width: 50px;
            height: 50px;
            background: var(--gradient);
            border-radius: 15px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            color: white;
            transform: rotate(45deg);
            transition: var(--transition);
        }

        .logo-icon i {
            transform: rotate(-45deg);
        }

        .logo-text {
            font-size: 20px;
            font-weight: 800;
            background: var(--gradient);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .sidebar-header small {
            color: var(--text-muted);
            font-size: 12px;
        }

        .sidebar-menu {
            list-style: none;
        }

        .sidebar-menu li {
            margin-bottom: 8px;
        }

        .sidebar-menu a {
            display: flex;
            align-items: center;
            gap: 15px;
            padding: 15px 20px;
            color: var(--text-muted);
            text-decoration: none;
            border-radius: 15px;
            transition: var(--transition);
            border: 1px solid transparent;
            cursor: pointer;
            font-weight: 500;
        }

        .sidebar-menu a:hover {
            background: rgba(139, 92, 246, 0.1);
            color: var(--primary);
            border-color: var(--border);
            transform: translateX(-5px);
        }

        .sidebar-menu a.active {
            background: var(--gradient);
            color: white;
            box-shadow: var(--shadow-lg);
        }

        .sidebar-menu i {
            width: 24px;
            font-size: 18px;
        }

        .sidebar-menu .badge {
            background: var(--danger);
            color: white;
            padding: 4px 8px;
            border-radius: 20px;
            font-size: 11px;
            margin-right: auto;
        }

        /* ===== Ø§Ù„Ù…Ø­ØªÙˆÙ‰ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ ===== */
        .main-content {
            flex: 1;
            margin-right: 280px;
            padding: 25px;
        }

        /* ===== Ø±Ø£Ø³ Ø§Ù„ØµÙØ­Ø© ===== */
        .admin-header {
            background: rgba(30, 41, 59, 0.8);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            padding: 20px 30px;
            border-radius: var(--radius-sm);
            margin-bottom: 25px;
            border: 1px solid var(--border);
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: var(--shadow);
        }

        .admin-header h2 {
            font-size: 24px;
            background: var(--gradient);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        /* ===== Ø¨Ø·Ø§Ù‚Ø§Øª Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª ===== */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(240px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .stat-card {
            background: rgba(30, 41, 59, 0.8);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            padding: 25px;
            border-radius: var(--radius-sm);
            border: 1px solid var(--border);
            transition: var(--transition);
            position: relative;
            overflow: hidden;
        }

        .stat-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 4px;
            background: var(--gradient);
        }

        .stat-card:hover {
            transform: translateY(-5px);
            box-shadow: var(--shadow-lg);
        }

        .stat-icon {
            font-size: 32px;
            color: var(--primary);
            margin-bottom: 15px;
        }

        .stat-value {
            font-size: 32px;
            font-weight: 700;
            color: var(--success);
            margin-bottom: 5px;
        }

        .stat-label {
            color: var(--text-muted);
            font-size: 14px;
        }

        /* ===== Ø§Ù„Ø¬Ø¯Ø§ÙˆÙ„ Ø§Ù„ÙØ§Ø®Ø±Ø© ===== */
        .admin-table {
            background: rgba(30, 41, 59, 0.8);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            border-radius: var(--radius-sm);
            overflow: hidden;
            border: 1px solid var(--border);
            margin-top: 20px;
        }

        .admin-table table {
            width: 100%;
            border-collapse: collapse;
        }

        .admin-table th {
            background: rgba(139, 92, 246, 0.15);
            padding: 18px 15px;
            text-align: right;
            font-weight: 600;
            font-size: 14px;
            color: var(--text);
            border-bottom: 2px solid var(--border);
        }

        .admin-table td {
            padding: 15px;
            border-bottom: 1px solid var(--border);
            font-size: 14px;
        }

        .admin-table tr:hover {
            background: rgba(139, 92, 246, 0.05);
        }

        /* ===== Ø£Ø²Ø±Ø§Ø± ÙØ§Ø®Ø±Ø© ===== */
        .btn {
            padding: 12px 24px;
            border-radius: 50px;
            border: none;
            font-weight: 600;
            font-size: 14px;
            cursor: pointer;
            transition: var(--transition);
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            position: relative;
            overflow: hidden;
        }

        .btn::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 0;
            height: 0;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.2);
            transform: translate(-50%, -50%);
            transition: width 0.6s, height 0.6s;
        }

        .btn:hover::before {
            width: 300px;
            height: 300px;
        }

        .btn-primary {
            background: var(--gradient);
            color: white;
        }

        .btn-success {
            background: linear-gradient(135deg, var(--success), #059669);
            color: white;
        }

        .btn-warning {
            background: linear-gradient(135deg, var(--warning), #d97706);
            color: white;
        }

        .btn-danger {
            background: linear-gradient(135deg, var(--danger), #dc2626);
            color: white;
        }

        .btn-purple {
            background: linear-gradient(135deg, #8b5cf6, #7c3aed);
            color: white;
        }

        .btn-sm {
            padding: 8px 16px;
            font-size: 12px;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.3);
        }

        /* ===== Ø§Ù„Ù†Ù…Ø§Ø°Ø¬ ===== */
        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            color: var(--text-muted);
            font-size: 14px;
            font-weight: 500;
        }

        .form-control {
            width: 100%;
            padding: 14px 18px;
            background: rgba(255, 255, 255, 0.03);
            border: 2px solid var(--border);
            border-radius: 15px;
            color: white;
            font-size: 14px;
            transition: var(--transition);
            font-family: 'Cairo', sans-serif;
        }

        .form-control:focus {
            outline: none;
            border-color: var(--primary);
            background: rgba(139, 92, 246, 0.05);
        }

        select.form-control {
            cursor: pointer;
        }

        textarea.form-control {
            resize: vertical;
            min-height: 80px;
        }

        /* ===== Ø§Ù„Ø¨Ø­Ø« ÙˆØ§Ù„ØªØµÙÙŠØ© ===== */
        .search-box {
            background: rgba(30, 41, 59, 0.8);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            padding: 20px;
            border-radius: var(--radius-sm);
            margin-bottom: 20px;
            border: 1px solid var(--border);
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
        }

        .search-input {
            flex: 1;
            min-width: 250px;
            padding: 12px 18px;
            background: rgba(255, 255, 255, 0.03);
            border: 2px solid var(--border);
            border-radius: 15px;
            color: white;
            font-size: 14px;
        }

        .search-input:focus {
            outline: none;
            border-color: var(--primary);
        }

        /* ===== Ø§Ù„Ø£Ù‚Ø³Ø§Ù… ===== */
        .section {
            display: none;
        }

        .section.active {
            display: block;
            animation: fadeIn 0.3s ease;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* ===== Ø­Ø§Ù„Ø§Øª Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… ===== */
        .status-badge {
            padding: 6px 16px;
            border-radius: 50px;
            font-size: 12px;
            font-weight: 600;
            display: inline-block;
        }

        .status-active {
            background: rgba(16, 185, 129, 0.2);
            color: var(--success);
            border: 1px solid var(--success);
        }

        .status-pending {
            background: rgba(245, 158, 11, 0.2);
            color: var(--warning);
            border: 1px solid var(--warning);
        }

        .status-suspended {
            background: rgba(245, 158, 11, 0.2);
            color: #f59e0b;
            border: 1px solid #f59e0b;
        }

        .status-banned {
            background: rgba(239, 68, 68, 0.2);
            color: var(--danger);
            border: 1px solid var(--danger);
        }

        .status-approved {
            background: rgba(16, 185, 129, 0.2);
            color: var(--success);
            border: 1px solid var(--success);
        }

        .status-rejected {
            background: rgba(239, 68, 68, 0.2);
            color: var(--danger);
            border: 1px solid var(--danger);
        }

        /* ===== ÙƒÙˆØ¯ Ø§Ù„Ø¥Ø­Ø§Ù„Ø© ===== */
        .referral-code {
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            padding: 5px 12px;
            border-radius: 8px;
            font-family: monospace;
            font-size: 12px;
            color: white;
            display: inline-block;
        }

        .commission-badge {
            background: var(--success);
            color: white;
            padding: 4px 10px;
            border-radius: 6px;
            font-size: 11px;
            font-weight: 600;
        }

        /* ===== Ø§Ù„ØªØ¨ÙˆÙŠØ¶ ===== */
        .tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            background: rgba(255, 255, 255, 0.03);
            padding: 5px;
            border-radius: 50px;
        }

        .tab {
            flex: 1;
            padding: 12px;
            background: none;
            border: none;
            color: var(--text-muted);
            cursor: pointer;
            border-radius: 50px;
            font-weight: 600;
            transition: var(--transition);
        }

        .tab.active {
            background: var(--gradient);
            color: white;
        }

        /* ===== Ø§Ù„Ù†ÙˆØ§ÙØ° Ø§Ù„Ù…Ù†Ø¨Ø«Ù‚Ø© ===== */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            z-index: 2000;
            align-items: center;
            justify-content: center;
            padding: 20px;
        }

        .modal.active {
            display: flex;
            animation: fadeIn 0.3s ease;
        }

        .modal-content {
            background: var(--dark-card);
            border-radius: var(--radius);
            padding: 35px;
            width: 100%;
            max-width: 550px;
            border: 2px solid var(--primary);
            box-shadow: var(--shadow-lg);
            animation: slideUp 0.3s ease;
            max-height: 90vh;
            overflow-y: auto;
        }

        .modal-content.large {
            max-width: 750px;
        }

        @keyframes slideUp {
            from {
                opacity: 0;
                transform: translateY(50px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 25px;
        }

        .modal-header h2 {
            font-size: 24px;
            background: var(--gradient);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .close-btn {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.05);
            border: none;
            color: white;
            font-size: 18px;
            cursor: pointer;
            transition: var(--transition);
        }

        .close-btn:hover {
            background: var(--danger);
            transform: rotate(90deg);
        }

        /* ===== Ø§Ù„ØªØ­Ù…ÙŠÙ„ ===== */
        .loading {
            text-align: center;
            padding: 40px;
            color: var(--text-muted);
        }

        .loading i {
            font-size: 40px;
            margin-bottom: 15px;
            color: var(--primary);
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        /* ===== Ø­Ø§Ù„Ø© Ø§Ù„Ø§ØªØµØ§Ù„ ===== */
        .sync-status {
            position: fixed;
            bottom: 20px;
            left: 300px;
            background: rgba(30, 41, 59, 0.95);
            backdrop-filter: blur(10px);
            padding: 10px 20px;
            border-radius: 50px;
            border: 1px solid var(--border);
            font-size: 13px;
            display: flex;
            align-items: center;
            gap: 10px;
            z-index: 999;
            box-shadow: var(--shadow);
        }

        .sync-status.online {
            border-color: var(--success);
            color: var(--success);
        }

        .sync-status.offline {
            border-color: var(--danger);
            color: var(--danger);
        }

        /* ===== Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±Ø§Øª ===== */
        .admin-notification {
            position: fixed;
            top: 100px;
            left: 50%;
            transform: translateX(-50%);
            background: var(--success);
            color: white;
            padding: 15px 30px;
            border-radius: 15px;
            display: none;
            z-index: 3000;
            box-shadow: var(--shadow-lg);
            border-right: 6px solid white;
            min-width: 350px;
            text-align: center;
            font-weight: 500;
            animation: slideDown 0.3s ease;
        }

        .admin-notification.error {
            background: var(--danger);
        }

        @keyframes slideDown {
            from {
                opacity: 0;
                transform: translate(-50%, -30px);
            }
            to {
                opacity: 1;
                transform: translate(-50%, 0);
            }
        }

        /* ===== Ø§Ù„ØªØ±Ù‚ÙŠÙ… ===== */
        .pagination {
            display: flex;
            justify-content: center;
            gap: 10px;
            padding: 20px;
        }

        /* ===== Ø§Ù„ØªØ¬Ø§ÙˆØ¨ Ù…Ø¹ Ø§Ù„Ø´Ø§Ø´Ø§Øª ===== */
        @media (max-width: 1200px) {
            .stats-grid {
                grid-template-columns: repeat(3, 1fr);
            }
        }

        @media (max-width: 992px) {
            .sidebar {
                width: 240px;
            }
            .main-content {
                margin-right: 240px;
            }
            .stats-grid {
                grid-template-columns: repeat(2, 1fr);
            }
            .sync-status {
                left: 260px;
            }
        }

        @media (max-width: 768px) {
            .sidebar {
                position: relative;
                width: 100%;
                height: auto;
            }
            .main-content {
                margin-right: 0;
            }
            .stats-grid {
                grid-template-columns: 1fr;
            }
            .sync-status {
                left: 20px;
                bottom: 80px;
            }
            .admin-header {
                flex-direction: column;
                gap: 15px;
                text-align: center;
            }
            .admin-table {
                overflow-x: auto;
            }
            .admin-table table {
                min-width: 800px;
            }
            .search-box {
                flex-direction: column;
            }
            .search-input {
                width: 100%;
            }
        }

        @media (max-width: 480px) {
            .modal-content {
                padding: 25px;
            }
            .admin-notification {
                min-width: auto;
                right: 10px;
                left: 10px;
            }
        }

        .glass-effect {
            background: rgba(255, 255, 255, 0.03);
            backdrop-filter: blur(10px);
            border: 1px solid var(--border);
        }

        .gradient-text {
            background: var(--gradient);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }
    </style>
</head>
<body>
    <div class="bg-gradient"></div>

    <div class="admin-wrapper">
        <!-- Ø§Ù„Ø´Ø±ÙŠØ· Ø§Ù„Ø¬Ø§Ù†Ø¨ÙŠ -->
        <div class="sidebar">
            <div class="sidebar-header">
                <div class="logo">
                    <div class="logo-icon">
                        <i class="fas fa-shield-alt"></i>
                    </div>
                    <span class="logo-text">Elite Investors</span>
                </div>
                <small>Ù„ÙˆØ­Ø© Ø§Ù„Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…ØªÙ‚Ø¯Ù…Ø© v3.0</small>
            </div>

            <ul class="sidebar-menu">
                <li><a href="#" class="active" onclick="showSection('dashboard'); return false;">
                    <i class="fas fa-tachometer-alt"></i> Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…
                </a></li>
                <li><a href="#" onclick="showSection('users'); return false;">
                    <i class="fas fa-users"></i> Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†
                    <span id="usersCount" class="badge">0</span>
                </a></li>
                <li><a href="#" onclick="showSection('packages'); return false;">
                    <i class="fas fa-crown"></i> Ø§Ù„Ø¨Ø§Ù‚Ø§Øª
                    <span id="packagesCount" class="badge">0</span>
                </a></li>
                <li><a href="#" onclick="showSection('tasks'); return false;">
                    <i class="fas fa-tasks"></i> Ø§Ù„Ù…Ù‡Ø§Ù…
                    <span id="tasksCount" class="badge">0</span>
                </a></li>
                <li><a href="#" onclick="showSection('pending'); return false;">
                    <i class="fas fa-clock"></i> Ø§Ù„Ø·Ù„Ø¨Ø§Øª Ø§Ù„Ù…Ø¹Ù„Ù‚Ø©
                    <span id="pendingCount" class="badge">0</span>
                </a></li>
                <li><a href="#" onclick="showSection('withdrawals'); return false;">
                    <i class="fas fa-money-bill-wave"></i> Ø·Ù„Ø¨Ø§Øª Ø§Ù„Ø³Ø­Ø¨
                    <span id="withdrawalsCount" class="badge">0</span>
                </a></li>
                <li><a href="#" onclick="showSection('subscriptions'); return false;">
                    <i class="fas fa-shopping-cart"></i> Ø§Ù„Ø§Ø´ØªØ±Ø§ÙƒØ§Øª
                    <span id="subscriptionsCount" class="badge">0</span>
                </a></li>
                <li><a href="#" onclick="showSection('referrals'); return false;">
                    <i class="fas fa-user-friends"></i> Ø§Ù„Ø¥Ø­Ø§Ù„Ø§Øª
                </a></li>
                <li><a href="#" onclick="showSection('transactions'); return false;">
                    <i class="fas fa-exchange-alt"></i> Ø§Ù„Ù…Ø¹Ø§Ù…Ù„Ø§Øª
                </a></li>
                <li><a href="index.html">
                    <i class="fas fa-sign-out-alt" style="color: var(--danger);"></i> Ø§Ù„Ø¹ÙˆØ¯Ø© Ù„Ù„Ù…ÙˆÙ‚Ø¹
                </a></li>
            </ul>
        </div>

        <!-- Ø§Ù„Ù…Ø­ØªÙˆÙ‰ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ -->
        <div class="main-content">
            <!-- Ù‚Ø³Ù… Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ… -->
            <div id="dashboard-section" class="section active">
                <div class="admin-header">
                    <h2><i class="fas fa-chart-pie"></i> Ù†Ø¸Ø±Ø© Ø¹Ø§Ù…Ø© Ø¹Ù„Ù‰ Ø§Ù„Ù†Ø¸Ø§Ù…</h2>
                    <button class="btn btn-primary btn-sm" onclick="refreshDashboard()">
                        <i class="fas fa-sync-alt"></i> ØªØ­Ø¯ÙŠØ«
                    </button>
                </div>

                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-icon"><i class="fas fa-users"></i></div>
                        <div class="stat-value" id="totalUsers">0</div>
                        <div class="stat-label">Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon"><i class="fas fa-user-check"></i></div>
                        <div class="stat-value" id="activeUsers">0</div>
                        <div class="stat-label">Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ† Ø§Ù„Ù†Ø´Ø·ÙŠÙ†</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon"><i class="fas fa-crown"></i></div>
                        <div class="stat-value" id="totalSubscribers">0</div>
                        <div class="stat-label">Ø§Ù„Ù…Ø´ØªØ±ÙƒÙŠÙ†</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon"><i class="fas fa-tasks"></i></div>
                        <div class="stat-value" id="totalTasks">0</div>
                        <div class="stat-label">Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù…Ù‡Ø§Ù…</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon"><i class="fas fa-clock"></i></div>
                        <div class="stat-value" id="totalPending">0</div>
                        <div class="stat-label">Ø·Ù„Ø¨Ø§Øª Ù…Ø¹Ù„Ù‚Ø©</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon"><i class="fas fa-money-bill-wave"></i></div>
                        <div class="stat-value" id="totalWithdrawals">0</div>
                        <div class="stat-label">Ø·Ù„Ø¨Ø§Øª Ø³Ø­Ø¨ Ù…Ø¹Ù„Ù‚Ø©</div>
                    </div>
                </div>
            </div>

            <!-- Ù‚Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ† -->
            <div id="users-section" class="section">
                <div class="admin-header">
                    <h2><i class="fas fa-users-cog"></i> Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†</h2>
                    <div>
                        <button class="btn btn-success btn-sm" onclick="showAddUserModal()">
                            <i class="fas fa-plus"></i> Ø¥Ø¶Ø§ÙØ© Ù…Ø³ØªØ®Ø¯Ù…
                        </button>
                        <button class="btn btn-primary btn-sm" onclick="loadUsers()">
                            <i class="fas fa-sync-alt"></i>
                        </button>
                    </div>
                </div>

                <div class="search-box">
                    <input type="text" class="search-input" id="userSearch" placeholder="ğŸ” Ø¨Ø­Ø« Ø¹Ù† Ù…Ø³ØªØ®Ø¯Ù…..." onkeyup="searchUsers()">
                    <select class="search-input" id="userStatusFilter" onchange="filterUsers()">
                        <option value="all">Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ø§Ù„Ø§Øª</option>
                        <option value="active">ğŸŸ¢ Ù†Ø´Ø·</option>
                        <option value="suspended">ğŸŸ  Ù…Ø¹Ù„Ù‚</option>
                        <option value="banned">ğŸ”´ Ù…Ø­Ø¸ÙˆØ±</option>
                    </select>
                </div>

                <div class="admin-table">
                    <table>
                        <thead>
                            <tr>
                                <th>#</th>
                                <th>Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…</th>
                                <th>Ø§Ù„Ø¨Ø±ÙŠØ¯</th>
                                <th>Ø§Ù„Ù‡Ø§ØªÙ</th>
                                <th>Ø§Ù„Ø±ØµÙŠØ¯</th>
                                <th>Ø§Ù„Ø¨Ø§Ù‚Ø©</th>
                                <th>Ø§Ù„Ø­Ø§Ù„Ø©</th>
                                <th>Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª</th>
                            </tr>
                        </thead>
                        <tbody id="usersTable">
                            <tr><td colspan="8" class="loading"><i class="fas fa-spinner fa-spin"></i><br>Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„...</td></tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Ù‚Ø³Ù… Ø§Ù„Ø¨Ø§Ù‚Ø§Øª -->
            <div id="packages-section" class="section">
                <div class="admin-header">
                    <h2><i class="fas fa-crown"></i> Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø¨Ø§Ù‚Ø§Øª</h2>
                    <button class="btn btn-success btn-sm" onclick="showAddPackageModal()">
                        <i class="fas fa-plus"></i> Ø¥Ø¶Ø§ÙØ© Ø¨Ø§Ù‚Ø©
                    </button>
                </div>

                <div class="admin-table">
                    <table>
                        <thead>
                            <tr>
                                <th>Ø§Ù„Ø§Ø³Ù…</th>
                                <th>Ø§Ù„Ø³Ø¹Ø±</th>
                                <th>Ø§Ù„Ø±Ø¨Ø­</th>
                                <th>Ø§Ù„ÙØ¦Ø©</th>
                                <th>Ø§Ù„Ù…Ù‡Ø§Ù…</th>
                                <th>Ø§Ù„Ù…Ø¯Ø©</th>
                                <th>Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†</th>
                                <th>Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª</th>
                            </tr>
                        </thead>
                        <tbody id="packagesTable">
                            <tr><td colspan="8" class="loading"><i class="fas fa-spinner fa-spin"></i><br>Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„...</td></tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Ù‚Ø³Ù… Ø§Ù„Ù…Ù‡Ø§Ù… -->
            <div id="tasks-section" class="section">
                <div class="admin-header">
                    <h2><i class="fas fa-tasks"></i> Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ù‡Ø§Ù…</h2>
                    <button class="btn btn-success btn-sm" onclick="showAddTaskModal()">
                        <i class="fas fa-plus"></i> Ø¥Ø¶Ø§ÙØ© Ù…Ù‡Ù…Ø©
                    </button>
                </div>

                <div class="search-box">
                    <input type="text" class="search-input" id="taskSearch" placeholder="ğŸ” Ø¨Ø­Ø« Ø¹Ù† Ù…Ù‡Ù…Ø©..." onkeyup="searchTasks()">
                    <select class="search-input" id="taskCategoryFilter" onchange="filterTasks()">
                        <option value="all">Ø¬Ù…ÙŠØ¹ Ø§Ù„ÙØ¦Ø§Øª</option>
                        <option value="standard">ğŸ¥ˆ ÙØ¶ÙŠØ©</option>
                        <option value="premium">ğŸ¥‡ Ø°Ù‡Ø¨ÙŠØ©</option>
                        <option value="vip">ğŸ’ Ù…Ø§Ø³ÙŠØ©</option>
                    </select>
                </div>

                <div class="admin-table">
                    <table>
                        <thead>
                            <tr>
                                <th>#</th>
                                <th>Ø§Ù„Ø¹Ù†ÙˆØ§Ù†</th>
                                <th>Ø§Ù„ÙˆØµÙ</th>
                                <th>Ø§Ù„Ù…ÙƒØ§ÙØ£Ø©</th>
                                <th>Ø§Ù„ÙØ¦Ø©</th>
                                <th>Ø§Ù„ØµØ¹ÙˆØ¨Ø©</th>
                                <th>Ø§Ù„ÙˆÙ‚Øª</th>
                                <th>Ø§Ù„Ø¥Ù†Ø¬Ø§Ø²Ø§Øª</th>
                                <th>Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª</th>
                            </tr>
                        </thead>
                        <tbody id="tasksTable">
                            <tr><td colspan="9" class="loading"><i class="fas fa-spinner fa-spin"></i><br>Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„...</td></tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Ù‚Ø³Ù… Ø§Ù„Ø·Ù„Ø¨Ø§Øª Ø§Ù„Ù…Ø¹Ù„Ù‚Ø© -->
            <div id="pending-section" class="section">
                <div class="admin-header">
                    <h2><i class="fas fa-clock"></i> Ø·Ù„Ø¨Ø§Øª Ø§Ù„Ø§Ø´ØªØ±Ø§Ùƒ</h2>
                    <button class="btn btn-primary btn-sm" onclick="loadPending()">
                        <i class="fas fa-sync-alt"></i> ØªØ­Ø¯ÙŠØ«
                    </button>
                </div>

                <div class="admin-table">
                    <table>
                        <thead>
                            <tr>
                                <th>Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…</th>
                                <th>Ø§Ù„Ø¨Ø§Ù‚Ø©</th>
                                <th>Ø§Ù„Ù…Ø¨Ù„Øº</th>
                                <th>Ø§Ù„ØªØ§Ø±ÙŠØ®</th>
                                <th>Ø§Ù„Ø¥Ø­Ø§Ù„Ø©</th>
                                <th>Ø§Ù„Ø­Ø§Ù„Ø©</th>
                                <th>Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª</th>
                            </tr>
                        </thead>
                        <tbody id="pendingTable">
                            <tr><td colspan="7" class="loading"><i class="fas fa-spinner fa-spin"></i><br>Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„...</td></tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Ù‚Ø³Ù… Ø·Ù„Ø¨Ø§Øª Ø§Ù„Ø³Ø­Ø¨ -->
            <div id="withdrawals-section" class="section">
                <div class="admin-header">
                    <h2><i class="fas fa-money-bill-wave"></i> Ø·Ù„Ø¨Ø§Øª Ø§Ù„Ø³Ø­Ø¨</h2>
                    <button class="btn btn-primary btn-sm" onclick="loadWithdrawals()">
                        <i class="fas fa-sync-alt"></i> ØªØ­Ø¯ÙŠØ«
                    </button>
                </div>

                <div class="admin-table">
                    <table>
                        <thead>
                            <tr>
                                <th>Ø±Ù‚Ù… Ø§Ù„Ø·Ù„Ø¨</th>
                                <th>Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…</th>
                                <th>Ø§Ù„Ù…Ø¨Ù„Øº</th>
                                <th>Ø§Ù„Ø±Ø³ÙˆÙ…</th>
                                <th>Ø§Ù„Ù…Ø­ÙØ¸Ø©</th>
                                <th>Ø§Ù„ØªØ§Ø±ÙŠØ®</th>
                                <th>Ø§Ù„Ø­Ø§Ù„Ø©</th>
                                <th>Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª</th>
                            </tr>
                        </thead>
                        <tbody id="withdrawalsTable">
                            <tr><td colspan="8" class="loading"><i class="fas fa-spinner fa-spin"></i><br>Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„...</td></tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Ù‚Ø³Ù… Ø§Ù„Ø§Ø´ØªØ±Ø§ÙƒØ§Øª -->
            <div id="subscriptions-section" class="section">
                <div class="admin-header">
                    <h2><i class="fas fa-shopping-cart"></i> Ø§Ù„Ø§Ø´ØªØ±Ø§ÙƒØ§Øª Ø§Ù„Ù†Ø´Ø·Ø©</h2>
                </div>

                <div class="admin-table">
                    <table>
                        <thead>
                            <tr>
                                <th>Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…</th>
                                <th>Ø§Ù„Ø¨Ø§Ù‚Ø©</th>
                                <th>Ø§Ù„Ù…Ø¨Ù„Øº</th>
                                <th>ØªØ§Ø±ÙŠØ® Ø§Ù„Ø§Ø´ØªØ±Ø§Ùƒ</th>
                                <th>Ø§Ù„Ø­Ø§Ù„Ø©</th>
                            </tr>
                        </thead>
                        <tbody id="subscriptionsTable">
                            <tr><td colspan="5" class="loading"><i class="fas fa-spinner fa-spin"></i><br>Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„...</td></tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Ù‚Ø³Ù… Ø§Ù„Ø¥Ø­Ø§Ù„Ø§Øª -->
            <div id="referrals-section" class="section">
                <div class="admin-header">
                    <h2><i class="fas fa-user-friends"></i> Ù†Ø¸Ø§Ù… Ø§Ù„Ø¥Ø­Ø§Ù„Ø©</h2>
                </div>

                <div class="admin-table">
                    <table>
                        <thead>
                            <tr>
                                <th>Ø§Ù„Ù…Ø³ÙˆÙ‚</th>
                                <th>ÙƒÙˆØ¯ Ø§Ù„Ø¥Ø­Ø§Ù„Ø©</th>
                                <th>Ø¹Ø¯Ø¯ Ø§Ù„Ø¥Ø­Ø§Ù„Ø§Øª</th>
                                <th>Ø§Ù„Ù†Ø´Ø·Ø©</th>
                                <th>Ø§Ù„Ø£Ø±Ø¨Ø§Ø­</th>
                                <th>Ø§Ù„Ù…Ø³ØªØ­Ù‚</th>
                            </tr>
                        </thead>
                        <tbody id="referralsTable">
                            <tr><td colspan="6" class="loading"><i class="fas fa-spinner fa-spin"></i><br>Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„...</td></tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Ù‚Ø³Ù… Ø§Ù„Ù…Ø¹Ø§Ù…Ù„Ø§Øª -->
            <div id="transactions-section" class="section">
                <div class="admin-header">
                    <h2><i class="fas fa-exchange-alt"></i> Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…Ø¹Ø§Ù…Ù„Ø§Øª</h2>
                </div>

                <div class="admin-table">
                    <table>
                        <thead>
                            <tr>
                                <th>Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…</th>
                                <th>Ø§Ù„Ù†ÙˆØ¹</th>
                                <th>Ø§Ù„ÙˆØµÙ</th>
                                <th>Ø§Ù„Ù…Ø¨Ù„Øº</th>
                                <th>Ø§Ù„ØªØ§Ø±ÙŠØ®</th>
                                <th>Ø§Ù„Ø­Ø§Ù„Ø©</th>
                            </tr>
                        </thead>
                        <tbody id="transactionsTable">
                            <tr><td colspan="6" class="loading"><i class="fas fa-spinner fa-spin"></i><br>Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„...</td></tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>

    <!-- Ù†Ø§ÙØ°Ø© Ø¥Ø¶Ø§ÙØ© Ù…Ø³ØªØ®Ø¯Ù… -->
    <div class="modal" id="addUserModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2><i class="fas fa-user-plus"></i> Ø¥Ø¶Ø§ÙØ© Ù…Ø³ØªØ®Ø¯Ù…</h2>
                <button class="close-btn" onclick="closeModal('addUserModal')"><i class="fas fa-times"></i></button>
            </div>

            <div class="form-group">
                <label>Ø§Ù„Ø§Ø³Ù… Ø§Ù„ÙƒØ§Ù…Ù„</label>
                <input type="text" class="form-control" id="userName" placeholder="Ø£Ø¯Ø®Ù„ Ø§Ù„Ø§Ø³Ù… Ø§Ù„ÙƒØ§Ù…Ù„">
            </div>
            <div class="form-group">
                <label>Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…</label>
                <input type="text" class="form-control" id="userUsername" placeholder="Ø§Ø®ØªØ± Ø§Ø³Ù… Ù…Ø³ØªØ®Ø¯Ù…">
            </div>
            <div class="form-group">
                <label>Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ</label>
                <input type="email" class="form-control" id="userEmail" placeholder="Ø£Ø¯Ø®Ù„ Ø§Ù„Ø¨Ø±ÙŠØ¯">
            </div>
            <div class="form-group">
                <label>Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ</label>
                <input type="tel" class="form-control" id="userPhone" placeholder="Ø£Ø¯Ø®Ù„ Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ">
            </div>
            <div class="form-group">
                <label>ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±</label>
                <input type="password" class="form-control" id="userPassword" value="123456">
            </div>
            <div class="form-group">
                <label>Ø§Ù„Ø±ØµÙŠØ¯ ($)</label>
                <input type="number" class="form-control" id="userBalance" value="0">
            </div>
            <div class="form-group">
                <label>ÙƒÙˆØ¯ Ø§Ù„Ø¥Ø­Ø§Ù„Ø©</label>
                <input type="text" class="form-control" id="userReferralCode" placeholder="ÙƒÙˆØ¯ Ø§Ù„Ø¥Ø­Ø§Ù„Ø© (Ø³ÙŠØªÙ… Ø¥Ù†Ø´Ø§Ø¤Ù‡ ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹)">
            </div>
            <div class="form-group">
                <label>Ø§Ù„Ø­Ø§Ù„Ø©</label>
                <select class="form-control" id="userStatus">
                    <option value="active">ğŸŸ¢ Ù†Ø´Ø·</option>
                    <option value="suspended">ğŸŸ  Ù…Ø¹Ù„Ù‚</option>
                    <option value="banned">ğŸ”´ Ù…Ø­Ø¸ÙˆØ±</option>
                </select>
            </div>

            <div style="display: flex; gap: 15px; margin-top: 25px;">
                <button class="btn btn-danger" style="flex: 1;" onclick="closeModal('addUserModal')">Ø¥Ù„ØºØ§Ø¡</button>
                <button class="btn btn-success" style="flex: 2;" onclick="addUser()">Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…</button>
            </div>
        </div>
    </div>

    <!-- Ù†Ø§ÙØ°Ø© Ø¥Ø¶Ø§ÙØ© Ø¨Ø§Ù‚Ø© -->
    <div class="modal" id="addPackageModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2><i class="fas fa-crown"></i> Ø¥Ø¶Ø§ÙØ© Ø¨Ø§Ù‚Ø©</h2>
                <button class="close-btn" onclick="closeModal('addPackageModal')"><i class="fas fa-times"></i></button>
            </div>

            <div class="form-group">
                <label>Ø§Ø³Ù… Ø§Ù„Ø¨Ø§Ù‚Ø©</label>
                <input type="text" class="form-control" id="packageName" placeholder="Ù…Ø«Ø§Ù„: Ø§Ù„Ø¨Ø§Ù‚Ø© Ø§Ù„Ø°Ù‡Ø¨ÙŠØ©">
            </div>
            <div class="form-group">
                <label>Ø§Ù„Ø³Ø¹Ø± ($)</label>
                <input type="number" class="form-control" id="packagePrice" placeholder="1000">
            </div>
            <div class="form-group">
                <label>Ù†Ø³Ø¨Ø© Ø§Ù„Ø±Ø¨Ø­ Ø§Ù„ÙŠÙˆÙ…ÙŠ (%)</label>
                <input type="number" class="form-control" id="packageProfit" value="2.5" step="0.1">
            </div>
            <div class="form-group">
                <label>Ø§Ù„ÙØ¦Ø©</label>
                <select class="form-control" id="packageCategory">
                    <option value="standard">ğŸ¥ˆ Ø¹Ø§Ø¯ÙŠØ©</option>
                    <option value="premium">ğŸ¥‡ Ù…Ù…ÙŠØ²Ø©</option>
                    <option value="vip">ğŸ’ VIP</option>
                </select>
            </div>
            <div class="form-group">
                <label>Ø¹Ø¯Ø¯ Ø§Ù„Ù…Ù‡Ø§Ù… Ø§Ù„ÙŠÙˆÙ…ÙŠØ©</label>
                <input type="number" class="form-control" id="packageTasks" value="5">
            </div>
            <div class="form-group">
                <label>Ù…Ø¯Ø© Ø§Ù„Ø¨Ø§Ù‚Ø© (Ø£ÙŠØ§Ù…)</label>
                <input type="number" class="form-control" id="packageDuration" value="30">
            </div>

            <div style="display: flex; gap: 15px; margin-top: 25px;">
                <button class="btn btn-danger" style="flex: 1;" onclick="closeModal('addPackageModal')">Ø¥Ù„ØºØ§Ø¡</button>
                <button class="btn btn-success" style="flex: 2;" onclick="addPackage()">Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø¨Ø§Ù‚Ø©</button>
            </div>
        </div>
    </div>

    <!-- Ù†Ø§ÙØ°Ø© Ø¥Ø¶Ø§ÙØ© Ù…Ù‡Ù…Ø© -->
    <div class="modal" id="addTaskModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2><i class="fas fa-tasks"></i> Ø¥Ø¶Ø§ÙØ© Ù…Ù‡Ù…Ø© Ø¬Ø¯ÙŠØ¯Ø©</h2>
                <button class="close-btn" onclick="closeModal('addTaskModal')"><i class="fas fa-times"></i></button>
            </div>

            <div class="form-group">
                <label>Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ù…Ù‡Ù…Ø©</label>
                <input type="text" class="form-control" id="taskTitle" placeholder="Ù…Ø«Ø§Ù„: Ù…Ø´Ø§Ù‡Ø¯Ø© ÙÙŠØ¯ÙŠÙˆ ØªØ¹Ù„ÙŠÙ…ÙŠ">
            </div>
            <div class="form-group">
                <label>ÙˆØµÙ Ø§Ù„Ù…Ù‡Ù…Ø©</label>
                <textarea class="form-control" id="taskDescription" rows="3" placeholder="Ø£Ø¯Ø®Ù„ ÙˆØµÙØ§Ù‹ ØªÙØµÙŠÙ„ÙŠØ§Ù‹ Ù„Ù„Ù…Ù‡Ù…Ø©"></textarea>
            </div>
            <div class="form-group">
                <label>Ø§Ù„Ù…ÙƒØ§ÙØ£Ø© ($)</label>
                <input type="number" class="form-control" id="taskReward" value="2.5" step="0.1">
            </div>
            <div class="form-group">
                <label>Ø§Ù„ÙØ¦Ø§Øª Ø§Ù„Ù…Ø³Ù…ÙˆØ­ Ø¨Ù‡Ø§</label>
                <select class="form-control" id="taskPackageCategories" multiple size="3">
                    <option value="standard" selected>ğŸ¥ˆ ÙØ¶ÙŠØ©</option>
                    <option value="premium" selected>ğŸ¥‡ Ø°Ù‡Ø¨ÙŠØ©</option>
                    <option value="vip" selected>ğŸ’ Ù…Ø§Ø³ÙŠØ©</option>
                </select>
                <small style="color: var(--text-muted);">Ø§Ø¶ØºØ· Ctrl Ù„ØªØ­Ø¯ÙŠØ¯ Ø£ÙƒØ«Ø± Ù…Ù† ÙØ¦Ø©</small>
            </div>
            <div class="form-group">
                <label>Ù…Ø³ØªÙˆÙ‰ Ø§Ù„ØµØ¹ÙˆØ¨Ø©</label>
                <select class="form-control" id="taskDifficulty">
                    <option value="easy">Ø³Ù‡Ù„</option>
                    <option value="medium" selected>Ù…ØªÙˆØ³Ø·</option>
                    <option value="hard">ØµØ¹Ø¨</option>
                </select>
            </div>
            <div class="form-group">
                <label>Ø§Ù„ÙˆÙ‚Øª Ø§Ù„Ù…Ø·Ù„ÙˆØ¨ (Ø¨Ø§Ù„Ø¯Ù‚Ø§Ø¦Ù‚)</label>
                <input type="number" class="form-control" id="taskTimeRequired" value="5" min="1">
            </div>
            <div class="form-group">
                <label>Ù†ÙˆØ¹ Ø§Ù„Ù…Ù‡Ù…Ø©</label>
                <select class="form-control" id="taskType">
                    <option value="daily">ÙŠÙˆÙ…ÙŠØ©</option>
                    <option value="weekly">Ø£Ø³Ø¨ÙˆØ¹ÙŠØ©</option>
                    <option value="one-time">Ù…Ø±Ø© ÙˆØ§Ø­Ø¯Ø©</option>
                </select>
            </div>

            <div style="display: flex; gap: 15px; margin-top: 25px;">
                <button class="btn btn-danger" style="flex: 1;" onclick="closeModal('addTaskModal')">Ø¥Ù„ØºØ§Ø¡</button>
                <button class="btn btn-success" style="flex: 2;" onclick="addTask()">Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù…Ù‡Ù…Ø©</button>
            </div>
        </div>
    </div>

    <!-- Ù†Ø§ÙØ°Ø© ØªØ¹Ø¯ÙŠÙ„ Ù…Ù‡Ù…Ø© -->
    <div class="modal" id="editTaskModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2><i class="fas fa-edit"></i> ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ù…Ù‡Ù…Ø©</h2>
                <button class="close-btn" onclick="closeModal('editTaskModal')"><i class="fas fa-times"></i></button>
            </div>

            <input type="hidden" id="editTaskId">
            
            <div class="form-group">
                <label>Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ù…Ù‡Ù…Ø©</label>
                <input type="text" class="form-control" id="editTaskTitle">
            </div>
            <div class="form-group">
                <label>ÙˆØµÙ Ø§Ù„Ù…Ù‡Ù…Ø©</label>
                <textarea class="form-control" id="editTaskDescription" rows="3"></textarea>
            </div>
            <div class="form-group">
                <label>Ø§Ù„Ù…ÙƒØ§ÙØ£Ø© ($)</label>
                <input type="number" class="form-control" id="editTaskReward" step="0.1">
            </div>
            <div class="form-group">
                <label>Ø§Ù„ÙØ¦Ø§Øª Ø§Ù„Ù…Ø³Ù…ÙˆØ­ Ø¨Ù‡Ø§</label>
                <select class="form-control" id="editTaskPackageCategories" multiple size="3">
                    <option value="standard">ğŸ¥ˆ ÙØ¶ÙŠØ©</option>
                    <option value="premium">ğŸ¥‡ Ø°Ù‡Ø¨ÙŠØ©</option>
                    <option value="vip">ğŸ’ Ù…Ø§Ø³ÙŠØ©</option>
                </select>
            </div>
            <div class="form-group">
                <label>Ù…Ø³ØªÙˆÙ‰ Ø§Ù„ØµØ¹ÙˆØ¨Ø©</label>
                <select class="form-control" id="editTaskDifficulty">
                    <option value="easy">Ø³Ù‡Ù„</option>
                    <option value="medium">Ù…ØªÙˆØ³Ø·</option>
                    <option value="hard">ØµØ¹Ø¨</option>
                </select>
            </div>
            <div class="form-group">
                <label>Ø§Ù„ÙˆÙ‚Øª Ø§Ù„Ù…Ø·Ù„ÙˆØ¨ (Ø¨Ø§Ù„Ø¯Ù‚Ø§Ø¦Ù‚)</label>
                <input type="number" class="form-control" id="editTaskTimeRequired" min="1">
            </div>
            <div class="form-group">
                <label>Ù†ÙˆØ¹ Ø§Ù„Ù…Ù‡Ù…Ø©</label>
                <select class="form-control" id="editTaskType">
                    <option value="daily">ÙŠÙˆÙ…ÙŠØ©</option>
                    <option value="weekly">Ø£Ø³Ø¨ÙˆØ¹ÙŠØ©</option>
                    <option value="one-time">Ù…Ø±Ø© ÙˆØ§Ø­Ø¯Ø©</option>
                </select>
            </div>
            <div class="form-group">
                <label>Ø§Ù„Ø­Ø§Ù„Ø©</label>
                <select class="form-control" id="editTaskStatus">
                    <option value="active">Ù†Ø´Ø·</option>
                    <option value="inactive">ØºÙŠØ± Ù†Ø´Ø·</option>
                </select>
            </div>

            <div style="display: flex; gap: 15px; margin-top: 25px;">
                <button class="btn btn-danger" style="flex: 1;" onclick="closeModal('editTaskModal')">Ø¥Ù„ØºØ§Ø¡</button>
                <button class="btn btn-warning" style="flex: 2;" onclick="updateTask()">ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù…Ù‡Ù…Ø©</button>
            </div>
        </div>
    </div>

    <!-- Ù†Ø§ÙØ°Ø© Ù…Ø¹Ø§Ù„Ø¬Ø© Ø·Ù„Ø¨ Ø§Ø´ØªØ±Ø§Ùƒ -->
    <div class="modal" id="processPendingModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2><i class="fas fa-cog"></i> Ù…Ø¹Ø§Ù„Ø¬Ø© Ø§Ù„Ø·Ù„Ø¨</h2>
                <button class="close-btn" onclick="closeModal('processPendingModal')"><i class="fas fa-times"></i></button>
            </div>

            <div id="pendingRequestInfo" class="glass-effect" style="padding: 20px; border-radius: var(--radius-sm); margin-bottom: 20px;">
                <!-- Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø·Ù„Ø¨ -->
            </div>

            <div style="display: flex; gap: 15px;">
                <button class="btn btn-danger" style="flex: 1;" onclick="rejectPendingRequest()">
                    <i class="fas fa-times"></i> Ø±ÙØ¶
                </button>
                <button class="btn btn-success" style="flex: 2;" onclick="approvePendingRequest()">
                    <i class="fas fa-check"></i> Ù‚Ø¨ÙˆÙ„ ÙˆØªÙØ¹ÙŠÙ„
                </button>
            </div>
        </div>
    </div>

    <!-- Ù†Ø§ÙØ°Ø© Ù…Ø¹Ø§Ù„Ø¬Ø© Ø·Ù„Ø¨ Ø³Ø­Ø¨ -->
    <div class="modal" id="processWithdrawalModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2><i class="fas fa-money-bill-wave"></i> Ù…Ø¹Ø§Ù„Ø¬Ø© Ø§Ù„Ø³Ø­Ø¨</h2>
                <button class="close-btn" onclick="closeModal('processWithdrawalModal')"><i class="fas fa-times"></i></button>
            </div>

            <div id="withdrawalRequestInfo" class="glass-effect" style="padding: 20px; border-radius: var(--radius-sm); margin-bottom: 20px;">
                <!-- Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø·Ù„Ø¨ Ø§Ù„Ø³Ø­Ø¨ -->
            </div>

            <div class="form-group">
                <label>Ø±Ù‚Ù… Ø§Ù„Ù…Ø¹Ø§Ù…Ù„Ø© (Transaction Hash)</label>
                <input type="text" class="form-control" id="transactionHash" placeholder="Ø£Ø¯Ø®Ù„ Ø±Ù‚Ù… Ø§Ù„Ù…Ø¹Ø§Ù…Ù„Ø© Ù…Ù† Ø§Ù„Ø´Ø¨ÙƒØ©">
            </div>

            <div style="display: flex; gap: 15px;">
                <button class="btn btn-danger" style="flex: 1;" onclick="rejectWithdrawal()">
                    <i class="fas fa-times"></i> Ø±ÙØ¶
                </button>
                <button class="btn btn-success" style="flex: 2;" onclick="approveWithdrawal()">
                    <i class="fas fa-check"></i> ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø¥Ø±Ø³Ø§Ù„
                </button>
            </div>
        </div>
    </div>

    <!-- Ù†Ø§ÙØ°Ø© ØªØºÙŠÙŠØ± Ø­Ø§Ù„Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… -->
    <div class="modal" id="userStatusModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2><i class="fas fa-shield-alt"></i> ØªØºÙŠÙŠØ± Ø§Ù„Ø­Ø§Ù„Ø©</h2>
                <button class="close-btn" onclick="closeModal('userStatusModal')"><i class="fas fa-times"></i></button>
            </div>

            <div id="statusUserInfo" class="glass-effect" style="padding: 15px; border-radius: var(--radius-sm); margin-bottom: 20px;">
                <!-- Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… -->
            </div>

            <div class="form-group">
                <label>Ø§Ù„Ø­Ø§Ù„Ø© Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø©</label>
                <select class="form-control" id="newUserStatus">
                    <option value="active">ğŸŸ¢ Ù†Ø´Ø·</option>
                    <option value="suspended">ğŸŸ  Ù…Ø¹Ù„Ù‚</option>
                    <option value="banned">ğŸ”´ Ù…Ø­Ø¸ÙˆØ±</option>
                </select>
            </div>
            <div class="form-group">
                <label>Ø³Ø¨Ø¨ Ø§Ù„ØªØºÙŠÙŠØ±</label>
                <textarea class="form-control" id="statusReason" rows="3" placeholder="Ø£Ø¯Ø®Ù„ Ø³Ø¨Ø¨ ØªØºÙŠÙŠØ± Ø§Ù„Ø­Ø§Ù„Ø©..."></textarea>
            </div>

            <div style="display: flex; gap: 15px;">
                <button class="btn btn-danger" style="flex: 1;" onclick="closeModal('userStatusModal')">Ø¥Ù„ØºØ§Ø¡</button>
                <button class="btn btn-warning" style="flex: 2;" onclick="updateUserStatus()">ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø­Ø§Ù„Ø©</button>
            </div>
        </div>
    </div>

    <!-- Ù†Ø§ÙØ°Ø© Ø¹Ø±Ø¶ ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ù…Ù‡Ù…Ø© -->
    <div class="modal" id="viewTaskModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2><i class="fas fa-info-circle"></i> ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ù…Ù‡Ù…Ø©</h2>
                <button class="close-btn" onclick="closeModal('viewTaskModal')"><i class="fas fa-times"></i></button>
            </div>

            <div id="taskDetails" class="glass-effect" style="padding: 20px; border-radius: var(--radius-sm);">
                <!-- ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ù…Ù‡Ù…Ø© Ø³ØªØ¸Ù‡Ø± Ù‡Ù†Ø§ -->
            </div>
        </div>
    </div>

    <!-- Ø­Ø§Ù„Ø© Ø§Ù„Ø§ØªØµØ§Ù„ -->
    <div class="sync-status online" id="syncStatus">
        <i class="fas fa-wifi" id="syncIcon"></i>
        <span id="syncText">Ù…ØªØµÙ„ Ø¨Ù€ Supabase</span>
    </div>

    <!-- Ø§Ù„Ø¥Ø´Ø¹Ø§Ø± -->
    <div class="admin-notification" id="notification" style="display: none;"></div>

    <script>
        // ========== Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Supabase ==========
        const SUPABASE_URL = "https://tmksysprwgsbdmavlshm.supabase.co";
        const SUPABASE_ANON_KEY = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InRta3N5c3Byd2dzYmRtYXZsc2htIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NzEwMTI3NjgsImV4cCI6MjA4NjU4ODc2OH0.-qHz5jtEkTK8S1RseWB5cLmLFfv9vPyTcGkc_D6ru80";

        const supabase = window.supabase.createClient(SUPABASE_URL, SUPABASE_ANON_KEY);

        // ========== Ø§Ù„Ù…ØªØºÙŠØ±Ø§Øª Ø§Ù„Ø¹Ø§Ù…Ø© ==========
        let adminData = {
            users: [],
            packages: [],
            tasks: [],
            pending: [],
            withdrawals: [],
            subscriptions: []
        };
        let currentRequestId = null;
        let currentWithdrawalId = null;
        let currentUserId = null;
        let currentTaskId = null;

        // ========== Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø§ØªØµØ§Ù„ ==========
        async function checkConnection() {
            try {
                const { error } = await supabase.from('users').select('count', { count: 'exact', head: true });
                const isOnline = !error;
                
                const status = document.getElementById('syncStatus');
                status.className = isOnline ? 'sync-status online' : 'sync-status offline';
                document.getElementById('syncIcon').className = isOnline ? 'fas fa-wifi' : 'fas fa-exclamation-triangle';
                document.getElementById('syncText').textContent = isOnline ? 'Ù…ØªØµÙ„ Ø¨Ù€ Supabase' : 'ØºÙŠØ± Ù…ØªØµÙ„';
                
                return isOnline;
            } catch (e) {
                console.error('Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø§ØªØµØ§Ù„:', e);
                return false;
            }
        }

        // ========== Ø§Ù„ØªÙ†Ù‚Ù„ Ø¨ÙŠÙ† Ø§Ù„Ø£Ù‚Ø³Ø§Ù… ==========
        function showSection(sectionId) {
            document.querySelectorAll('.section').forEach(s => s.classList.remove('active'));
            document.querySelectorAll('.sidebar-menu a').forEach(l => l.classList.remove('active'));
            
            const section = document.getElementById(sectionId + '-section');
            if (section) section.classList.add('active');
            
            const link = Array.from(document.querySelectorAll('.sidebar-menu a')).find(a => 
                a.getAttribute('onclick')?.includes(sectionId)
            );
            if (link) link.classList.add('active');
            
            // ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø­Ø³Ø¨ Ø§Ù„Ù‚Ø³Ù…
            if (sectionId === 'users') loadUsers();
            else if (sectionId === 'packages') loadPackages();
            else if (sectionId === 'tasks') loadTasks();
            else if (sectionId === 'pending') loadPending();
            else if (sectionId === 'withdrawals') loadWithdrawals();
            else if (sectionId === 'subscriptions') loadSubscriptions();
            else if (sectionId === 'referrals') loadReferrals();
            else if (sectionId === 'transactions') loadAllTransactions();
            else if (sectionId === 'dashboard') updateDashboardStats();
        }

        // ========== Ø¯ÙˆØ§Ù„ Ù…Ø³Ø§Ø¹Ø¯Ø© Ù„Ù€ Supabase ==========
        const supabaseHelpers = {
            // Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†
            async getAllUsers() {
                const { data, error } = await supabase
                    .from('users')
                    .select('*')
                    .order('created_at', { ascending: false });
                return { success: !error, data, error };
            },

            async getUserById(id) {
                const { data, error } = await supabase
                    .from('users')
                    .select('*')
                    .eq('id', id)
                    .single();
                return { success: !error, data, error };
            },

            async createUser(user) {
                const { data, error } = await supabase
                    .from('users')
                    .insert([user])
                    .select();
                return { success: !error, data, error };
            },

            async updateUser(id, updates) {
                const { data, error } = await supabase
                    .from('users')
                    .update(updates)
                    .eq('id', id)
                    .select();
                return { success: !error, data, error };
            },

            // Ø§Ù„Ø¨Ø§Ù‚Ø§Øª
            async getAllPackages() {
                const { data, error } = await supabase
                    .from('packages')
                    .select('*')
                    .order('price', { ascending: true });
                return { success: !error, data, error };
            },

            async createPackage(pkg) {
                const { data, error } = await supabase
                    .from('packages')
                    .insert([pkg])
                    .select();
                return { success: !error, data, error };
            },

            async updatePackage(id, updates) {
                const { data, error } = await supabase
                    .from('packages')
                    .update(updates)
                    .eq('id', id)
                    .select();
                return { success: !error, data, error };
            },

            async deletePackage(id) {
                const { error } = await supabase
                    .from('packages')
                    .delete()
                    .eq('id', id);
                return { success: !error, error };
            },

            // Ø§Ù„Ù…Ù‡Ø§Ù…
            async getAllTasks() {
                const { data, error } = await supabase
                    .from('tasks')
                    .select('*')
                    .order('created_at', { ascending: false });
                return { success: !error, data, error };
            },

            async createTask(task) {
                const { data, error } = await supabase
                    .from('tasks')
                    .insert([task])
                    .select();
                return { success: !error, data, error };
            },

            async updateTask(id, updates) {
                const { data, error } = await supabase
                    .from('tasks')
                    .update(updates)
                    .eq('id', id)
                    .select();
                return { success: !error, data, error };
            },

            async deleteTask(id) {
                const { error } = await supabase
                    .from('tasks')
                    .delete()
                    .eq('id', id);
                return { success: !error, error };
            },

            async incrementTaskCompletion(taskId) {
                // Ø£ÙˆÙ„Ø§Ù‹ Ø¬Ù„Ø¨ Ø§Ù„Ù…Ù‡Ù…Ø©
                const { data: task, error: fetchError } = await supabase
                    .from('tasks')
                    .select('completions')
                    .eq('id', taskId)
                    .single();
                
                if (fetchError) return { success: false, error: fetchError };
                
                // Ø«Ù… ØªØ­Ø¯ÙŠØ«Ù‡Ø§
                const { data, error } = await supabase
                    .from('tasks')
                    .update({ completions: (task.completions || 0) + 1 })
                    .eq('id', taskId)
                    .select();
                
                return { success: !error, data, error };
            },

            // Ø§Ù„Ø·Ù„Ø¨Ø§Øª Ø§Ù„Ù…Ø¹Ù„Ù‚Ø©
            async getPendingPackages() {
                const { data, error } = await supabase
                    .from('pending_packages')
                    .select('*, users(name, email), packages(name)')
                    .eq('status', 'pending')
                    .order('created_at', { ascending: false });
                return { success: !error, data, error };
            },

            async createPendingPackage(pending) {
                const { data, error } = await supabase
                    .from('pending_packages')
                    .insert([pending])
                    .select();
                return { success: !error, data, error };
            },

            async updatePendingPackage(id, updates) {
                const { data, error } = await supabase
                    .from('pending_packages')
                    .update(updates)
                    .eq('id', id)
                    .select();
                return { success: !error, data, error };
            },

            async deletePendingPackage(id) {
                const { error } = await supabase
                    .from('pending_packages')
                    .delete()
                    .eq('id', id);
                return { success: !error, error };
            },

            // Ø·Ù„Ø¨Ø§Øª Ø§Ù„Ø³Ø­Ø¨
            async getWithdrawals() {
                const { data, error } = await supabase
                    .from('withdrawals')
                    .select('*, users(name, email)')
                    .order('created_at', { ascending: false });
                return { success: !error, data, error };
            },

            async createWithdrawal(withdrawal) {
                const { data, error } = await supabase
                    .from('withdrawals')
                    .insert([withdrawal])
                    .select();
                return { success: !error, data, error };
            },

            async updateWithdrawal(id, updates) {
                const { data, error } = await supabase
                    .from('withdrawals')
                    .update(updates)
                    .eq('id', id)
                    .select();
                return { success: !error, data, error };
            },

            // Ø§Ù„Ù…Ø¹Ø§Ù…Ù„Ø§Øª
            async getTransactions() {
                const { data, error } = await supabase
                    .from('transactions')
                    .select('*, users(name)')
                    .order('created_at', { ascending: false })
                    .limit(500);
                return { success: !error, data, error };
            },

            async createTransaction(transaction) {
                const { data, error } = await supabase
                    .from('transactions')
                    .insert([transaction])
                    .select();
                return { success: !error, data, error };
            },

            // Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…
            async getDashboardStats() {
                try {
                    const [users, activeUsers, subscribers, tasks, pending, withdrawals] = await Promise.all([
                        supabase.from('users').select('*', { count: 'exact', head: true }),
                        supabase.from('users').select('*', { count: 'exact', head: true }).eq('status', 'active'),
                        supabase.from('users').select('*', { count: 'exact', head: true }).not('package_id', 'is', null),
                        supabase.from('tasks').select('*', { count: 'exact', head: true }),
                        supabase.from('pending_packages').select('*', { count: 'exact', head: true }).eq('status', 'pending'),
                        supabase.from('withdrawals').select('*', { count: 'exact', head: true }).eq('status', 'pending')
                    ]);

                    return {
                        success: true,
                        data: {
                            users: users.count || 0,
                            activeUsers: activeUsers.count || 0,
                            subscribers: subscribers.count || 0,
                            tasks: tasks.count || 0,
                            pending: pending.count || 0,
                            withdrawals: withdrawals.count || 0
                        }
                    };
                } catch (error) {
                    console.error('Ø®Ø·Ø£ ÙÙŠ Ø¬Ù„Ø¨ Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª:', error);
                    return { success: false, error };
                }
            }
        };

        // ========== ØªØ­Ø¯ÙŠØ« Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ… ==========
        async function updateDashboardStats() {
            try {
                const result = await supabaseHelpers.getDashboardStats();
                
                if (result.success) {
                    const stats = result.data;
                    
                    document.getElementById('totalUsers').textContent = stats.users;
                    document.getElementById('activeUsers').textContent = stats.activeUsers;
                    document.getElementById('totalSubscribers').textContent = stats.subscribers;
                    document.getElementById('totalTasks').textContent = stats.tasks;
                    document.getElementById('totalPending').textContent = stats.pending;
                    document.getElementById('totalWithdrawals').textContent = stats.withdrawals;
                    
                    document.getElementById('usersCount').textContent = stats.users;
                    document.getElementById('tasksCount').textContent = stats.tasks;
                    document.getElementById('pendingCount').textContent = stats.pending;
                    document.getElementById('withdrawalsCount').textContent = stats.withdrawals;
                    document.getElementById('subscriptionsCount').textContent = stats.subscribers;
                    
                    // Ø¹Ø¯Ø¯ Ø§Ù„Ø¨Ø§Ù‚Ø§Øª
                    const packagesResult = await supabaseHelpers.getAllPackages();
                    if (packagesResult.success) {
                        document.getElementById('packagesCount').textContent = packagesResult.data.length;
                    }
                }
            } catch (e) {
                console.error('Ø®Ø·Ø£ ÙÙŠ ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª:', e);
            }
        }

        // ========== ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ† ==========
        async function loadUsers() {
            const tbody = document.getElementById('usersTable');
            tbody.innerHTML = '<tr><td colspan="8" class="loading"><i class="fas fa-spinner fa-spin"></i><br>Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„...</td></tr>';
            
            const result = await supabaseHelpers.getAllUsers();
            
            if (!result.success || !result.data) {
                tbody.innerHTML = '<tr><td colspan="8" class="loading"><i class="fas fa-exclamation-triangle" style="color: var(--danger);"></i><br>ÙØ´Ù„ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†</td></tr>';
                return;
            }
            
            adminData.users = result.data;
            updateDashboardStats();
            
            if (adminData.users.length === 0) {
                tbody.innerHTML = '<tr><td colspan="8" class="loading"><i class="fas fa-users"></i><br>Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†</td></tr>';
                return;
            }
            
            let html = '';
            adminData.users.slice(0, 100).forEach((u, i) => {
                const statusClass = u.status === 'suspended' ? 'status-suspended' : u.status === 'banned' ? 'status-banned' : 'status-active';
                const statusIcon = u.status === 'suspended' ? 'ğŸŸ ' : u.status === 'banned' ? 'ğŸ”´' : 'ğŸŸ¢';
                
                // Ø¬Ù„Ø¨ Ø§Ø³Ù… Ø§Ù„Ø¨Ø§Ù‚Ø© Ø¥Ø°Ø§ ÙƒØ§Ù†Øª Ù…ÙˆØ¬ÙˆØ¯Ø©
                let packageName = 'â€”';
                if (u.package_id) {
                    const pkg = adminData.packages.find(p => p.id === u.package_id);
                    packageName = pkg ? pkg.name : 'ØºÙŠØ± Ù…Ø¹Ø±ÙˆÙØ©';
                }
                
                html += `<tr>
                    <td>${i+1}</td>
                    <td><strong>${u.name || '?'}</strong><br><small>@${u.username || ''}</small></td>
                    <td>${u.email || ''}</td>
                    <td>${u.phone || ''}</td>
                    <td><strong>${(u.balance || 0).toFixed(2)}$</strong></td>
                    <td>${packageName !== 'â€”' ? `<span class="status-badge status-active">${packageName}</span>` : 'â€”'}</td>
                    <td><span class="status-badge ${statusClass}">${statusIcon} ${u.status || 'active'}</span></td>
                    <td>
                        <button class="btn btn-sm btn-warning" onclick="showUserStatusModal('${u.id}')" title="ØªØºÙŠÙŠØ± Ø§Ù„Ø­Ø§Ù„Ø©"><i class="fas fa-shield-alt"></i></button>
                        <button class="btn btn-sm btn-danger" onclick="deleteUser('${u.id}')" title="Ø­Ø°Ù"><i class="fas fa-trash"></i></button>
                    </td>
                </tr>`;
            });
            tbody.innerHTML = html;
        }

        // ========== ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨Ø§Ù‚Ø§Øª ==========
        async function loadPackages() {
            const tbody = document.getElementById('packagesTable');
            tbody.innerHTML = '<tr><td colspan="8" class="loading"><i class="fas fa-spinner fa-spin"></i><br>Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„...</td></tr>';
            
            const result = await supabaseHelpers.getAllPackages();
            
            if (!result.success || !result.data) {
                tbody.innerHTML = '<tr><td colspan="8" class="loading"><i class="fas fa-exclamation-triangle" style="color: var(--danger);"></i><br>ÙØ´Ù„ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨Ø§Ù‚Ø§Øª</td></tr>';
                return;
            }
            
            adminData.packages = result.data;
            updateDashboardStats();
            
            if (adminData.packages.length === 0) {
                tbody.innerHTML = '<tr><td colspan="8" class="loading"><i class="fas fa-box-open"></i><br>Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¨Ø§Ù‚Ø§Øª</td></tr>';
                return;
            }
            
            // Ø¬Ù„Ø¨ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ† Ù„Ø­Ø³Ø§Ø¨ Ø¹Ø¯Ø¯ Ø§Ù„Ù…Ø´ØªØ±ÙƒÙŠÙ† ÙÙŠ ÙƒÙ„ Ø¨Ø§Ù‚Ø©
            await loadUsers();
            
            let html = '';
            adminData.packages.forEach(p => {
                const usersCount = adminData.users.filter(u => u.package_id === p.id).length;
                html += `<tr>
                    <td><strong>${p.name}</strong></td>
                    <td>${p.price}$</td>
                    <td>${p.profit_percentage || 2.5}%</td>
                    <td><span class="badge">${p.category || 'standard'}</span></td>
                    <td>${p.tasks_count || 5}</td>
                    <td>${p.duration || 30}</td>
                    <td>${usersCount}</td>
                    <td>
                        <button class="btn btn-sm btn-danger" onclick="deletePackage(${p.id})"><i class="fas fa-trash"></i></button>
                    </td>
                </tr>`;
            });
            tbody.innerHTML = html;
        }

        // ========== ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ù‡Ø§Ù… ==========
        async function loadTasks() {
            const tbody = document.getElementById('tasksTable');
            tbody.innerHTML = '<tr><td colspan="9" class="loading"><i class="fas fa-spinner fa-spin"></i><br>Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„...</td></tr>';
            
            const result = await supabaseHelpers.getAllTasks();
            
            if (!result.success || !result.data) {
                tbody.innerHTML = '<tr><td colspan="9" class="loading"><i class="fas fa-exclamation-triangle" style="color: var(--danger);"></i><br>ÙØ´Ù„ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ù‡Ø§Ù…</td></tr>';
                return;
            }
            
            adminData.tasks = result.data;
            updateDashboardStats();
            
            if (adminData.tasks.length === 0) {
                tbody.innerHTML = '<tr><td colspan="9" class="loading"><i class="fas fa-tasks"></i><br>Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…Ù‡Ø§Ù…</td></tr>';
                return;
            }
            
            let html = '';
            adminData.tasks.forEach((task, i) => {
                const categories = task.package_categories || [];
                const categoriesText = categories.map(c => {
                    if (c === 'standard') return 'ğŸ¥ˆ';
                    if (c === 'premium') return 'ğŸ¥‡';
                    if (c === 'vip') return 'ğŸ’';
                    return c;
                }).join(' ');
                
                const difficultyText = task.difficulty === 'easy' ? 'Ø³Ù‡Ù„' : task.difficulty === 'medium' ? 'Ù…ØªÙˆØ³Ø·' : 'ØµØ¹Ø¨';
                const difficultyClass = task.difficulty === 'easy' ? 'status-active' : task.difficulty === 'medium' ? 'status-pending' : 'status-rejected';
                
                html += `<tr>
                    <td>${i+1}</td>
                    <td><strong>${task.title}</strong></td>
                    <td>${task.description || '-'}</td>
                    <td><strong>${task.reward}$</strong></td>
                    <td>${categoriesText}</td>
                    <td><span class="status-badge ${difficultyClass}">${difficultyText}</span></td>
                    <td>${task.time_required || 5} Ø¯</td>
                    <td>${task.completions || 0}</td>
                    <td>
                        <button class="btn btn-sm btn-info" onclick="viewTask(${task.id})" title="Ø¹Ø±Ø¶"><i class="fas fa-eye"></i></button>
                        <button class="btn btn-sm btn-warning" onclick="editTask(${task.id})" title="ØªØ¹Ø¯ÙŠÙ„"><i class="fas fa-edit"></i></button>
                        <button class="btn btn-sm btn-danger" onclick="deleteTask(${task.id})" title="Ø­Ø°Ù"><i class="fas fa-trash"></i></button>
                    </td>
                </tr>`;
            });
            tbody.innerHTML = html;
        }

        // ========== ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø·Ù„Ø¨Ø§Øª Ø§Ù„Ù…Ø¹Ù„Ù‚Ø© ==========
        async function loadPending() {
            const tbody = document.getElementById('pendingTable');
            tbody.innerHTML = '<tr><td colspan="7" class="loading"><i class="fas fa-spinner fa-spin"></i><br>Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„...</td></tr>';
            
            const result = await supabaseHelpers.getPendingPackages();
            
            if (!result.success || !result.data) {
                tbody.innerHTML = '<tr><td colspan="7" class="loading"><i class="fas fa-exclamation-triangle" style="color: var(--danger);"></i><br>ÙØ´Ù„ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø·Ù„Ø¨Ø§Øª</td></tr>';
                return;
            }
            
            adminData.pending = result.data;
            updateDashboardStats();
            
            if (adminData.pending.length === 0) {
                tbody.innerHTML = '<tr><td colspan="7" class="loading"><i class="fas fa-check-circle" style="color:var(--success);"></i><br>Ù„Ø§ ØªÙˆØ¬Ø¯ Ø·Ù„Ø¨Ø§Øª Ù…Ø¹Ù„Ù‚Ø©</td></tr>';
                return;
            }
            
            let html = '';
            adminData.pending.forEach((req, i) => {
                html += `<tr>
                    <td><strong>${req.users?.name || req.user_name || '?'}</strong><br><small>${req.users?.email || req.user_email || ''}</small></td>
                    <td>${req.packages?.name || req.package_name}</td>
                    <td><strong>${(req.amount || 0).toFixed(2)}$</strong></td>
                    <td>${new Date(req.created_at).toLocaleString('ar-SA')}</td>
                    <td>${req.referred_by ? '<span class="referral-code">ğŸ ' + req.referred_by + '</span>' : 'â€”'}</td>
                    <td><span class="status-badge status-pending">â³ Ù…Ø¹Ù„Ù‚</span></td>
                    <td>
                        <button class="btn btn-sm btn-success" onclick="showPendingModal('${req.id}')">
                            <i class="fas fa-cog"></i> Ù…Ø¹Ø§Ù„Ø¬Ø©
                        </button>
                    </td>
                </tr>`;
            });
            tbody.innerHTML = html;
        }

        // ========== ØªØ­Ù…ÙŠÙ„ Ø·Ù„Ø¨Ø§Øª Ø§Ù„Ø³Ø­Ø¨ ==========
        async function loadWithdrawals() {
            const tbody = document.getElementById('withdrawalsTable');
            tbody.innerHTML = '<tr><td colspan="8" class="loading"><i class="fas fa-spinner fa-spin"></i><br>Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„...</td></tr>';
            
            const result = await supabaseHelpers.getWithdrawals();
            
            if (!result.success || !result.data) {
                tbody.innerHTML = '<tr><td colspan="8" class="loading"><i class="fas fa-exclamation-triangle" style="color: var(--danger);"></i><br>ÙØ´Ù„ ØªØ­Ù…ÙŠÙ„ Ø·Ù„Ø¨Ø§Øª Ø§Ù„Ø³Ø­Ø¨</td></tr>';
                return;
            }
            
            adminData.withdrawals = result.data;
            updateDashboardStats();
            
            if (adminData.withdrawals.length === 0) {
                tbody.innerHTML = '<tr><td colspan="8" class="loading"><i class="fas fa-money-bill-wave"></i><br>Ù„Ø§ ØªÙˆØ¬Ø¯ Ø·Ù„Ø¨Ø§Øª Ø³Ø­Ø¨</td></tr>';
                return;
            }
            
            let html = '';
            adminData.withdrawals.forEach((w, i) => {
                const statusClass = w.status === 'completed' ? 'status-active' : 
                                   w.status === 'rejected' ? 'status-rejected' : 'status-pending';
                const statusText = w.status === 'completed' ? 'âœ… Ù…ÙƒØªÙ…Ù„' : 
                                  w.status === 'rejected' ? 'âŒ Ù…Ø±ÙÙˆØ¶' : 'â³ Ù…Ø¹Ù„Ù‚';
                
                html += `<tr>
                    <td>#WD${w.id}</td>
                    <td><strong>${w.users?.name || w.user_name || '?'}</strong><br><small>${w.users?.email || w.user_email || ''}</small></td>
                    <td><strong>${(w.amount || 0).toFixed(2)}$</strong></td>
                    <td>${w.fee || 5}$</td>
                    <td><small style="font-family:monospace;">${w.wallet ? w.wallet.substring(0,15)+'...' : 'â€”'}</small></td>
                    <td>${new Date(w.created_at).toLocaleString('ar-SA')}</td>
                    <td><span class="status-badge ${statusClass}">${statusText}</span></td>
                    <td>
                        ${w.status === 'pending' ? 
                            `<button class="btn btn-sm btn-success" onclick="showWithdrawalModal('${w.id}')">
                                <i class="fas fa-cog"></i> Ù…Ø¹Ø§Ù„Ø¬Ø©
                            </button>` : 
                            `<button class="btn btn-sm btn-info" onclick="viewWithdrawalDetails('${w.id}')">
                                <i class="fas fa-eye"></i>
                            </button>`
                        }
                    </td>
                </tr>`;
            });
            tbody.innerHTML = html;
        }

        // ========== ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø§Ø´ØªØ±Ø§ÙƒØ§Øª ==========
        async function loadSubscriptions() {
            const tbody = document.getElementById('subscriptionsTable');
            
            // Ø¬Ù„Ø¨ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ† Ø§Ù„Ø°ÙŠÙ† Ù„Ø¯ÙŠÙ‡Ù… package_id
            const { data, error } = await supabase
                .from('users')
                .select('*, packages(name, price)')
                .not('package_id', 'is', null);
            
            if (error || !data) {
                tbody.innerHTML = '<tr><td colspan="5" class="loading"><i class="fas fa-exclamation-triangle" style="color: var(--danger);"></i><br>ÙØ´Ù„ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø§Ø´ØªØ±Ø§ÙƒØ§Øª</td></tr>';
                return;
            }
            
            if (data.length === 0) {
                tbody.innerHTML = '<tr><td colspan="5" class="loading"><i class="fas fa-shopping-cart"></i><br>Ù„Ø§ ØªÙˆØ¬Ø¯ Ø§Ø´ØªØ±Ø§ÙƒØ§Øª</td></tr>';
                return;
            }
            
            let html = '';
            data.forEach(u => {
                html += `<tr>
                    <td>${u.name}</td>
                    <td>${u.packages?.name || 'ØºÙŠØ± Ù…Ø¹Ø±ÙˆÙØ©'}</td>
                    <td>${u.packages?.price || 0}$</td>
                    <td>${u.package_activated_at ? new Date(u.package_activated_at).toLocaleDateString('ar-SA') : 'â€”'}</td>
                    <td><span class="status-badge status-active">âœ… Ù†Ø´Ø·</span></td>
                </tr>`;
            });
            tbody.innerHTML = html;
        }

        // ========== ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¥Ø­Ø§Ù„Ø§Øª ==========
        async function loadReferrals() {
            const tbody = document.getElementById('referralsTable');
            
            // Ø¬Ù„Ø¨ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†
            const { data: users, error } = await supabase
                .from('users')
                .select('*');
            
            if (error || !users) {
                tbody.innerHTML = '<tr><td colspan="6" class="loading"><i class="fas fa-exclamation-triangle" style="color: var(--danger);"></i><br>ÙØ´Ù„ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¥Ø­Ø§Ù„Ø§Øª</td></tr>';
                return;
            }
            
            const referrals = [];
            
            users.forEach(u => {
                if (u.referral_code) {
                    const referred = users.filter(r => r.referred_by === u.referral_code);
                    if (referred.length) {
                        const active = referred.filter(r => r.package_id).length;
                        const earnings = u.referral_earnings || 0;
                        const pending = referred.filter(r => r.package_id && !r.referral_reward_paid).length * 50;
                        
                        referrals.push({
                            name: u.name,
                            code: u.referral_code,
                            count: referred.length,
                            active: active,
                            earnings: earnings,
                            pending: pending
                        });
                    }
                }
            });
            
            if (referrals.length === 0) {
                tbody.innerHTML = '<tr><td colspan="6" class="loading"><i class="fas fa-user-friends"></i><br>Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¥Ø­Ø§Ù„Ø§Øª</td></tr>';
                return;
            }
            
            let html = '';
            referrals.forEach(r => {
                html += `<tr>
                    <td><strong>${r.name}</strong></td>
                    <td><span class="referral-code">${r.code}</span></td>
                    <td>${r.count}</td>
                    <td>${r.active}</td>
                    <td>${r.earnings.toFixed(2)}$</td>
                    <td><span class="commission-badge">${r.pending}$</span></td>
                </tr>`;
            });
            tbody.innerHTML = html;
        }

        // ========== ØªØ­Ù…ÙŠÙ„ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…Ø¹Ø§Ù…Ù„Ø§Øª ==========
        async function loadAllTransactions() {
            const tbody = document.getElementById('transactionsTable');
            
            const result = await supabaseHelpers.getTransactions();
            
            if (!result.success || !result.data) {
                tbody.innerHTML = '<tr><td colspan="6" class="loading"><i class="fas fa-exclamation-triangle" style="color: var(--danger);"></i><br>ÙØ´Ù„ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ø¹Ø§Ù…Ù„Ø§Øª</td></tr>';
                return;
            }
            
            if (result.data.length === 0) {
                tbody.innerHTML = '<tr><td colspan="6" class="loading"><i class="fas fa-exchange-alt"></i><br>Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…Ø¹Ø§Ù…Ù„Ø§Øª</td></tr>';
                return;
            }
            
            let html = '';
            result.data.slice(0, 100).forEach(t => {
                html += `<tr>
                    <td>${t.users?.name || t.user_name || 'â€”'}</td>
                    <td>${t.type || 'â€”'}</td>
                    <td>${t.description || ''}</td>
                    <td style="color: ${t.type === 'withdrawal' ? 'var(--danger)' : 'var(--success)'};">${t.type === 'withdrawal' ? '-' : '+'}${(t.amount || 0).toFixed(2)}$</td>
                    <td>${new Date(t.created_at).toLocaleString('ar-SA')}</td>
                    <td><span class="status-badge status-active">${t.status || 'Ù…ÙƒØªÙ…Ù„'}</span></td>
                </tr>`;
            });
            tbody.innerHTML = html;
        }

        // ========== Ø¯ÙˆØ§Ù„ Ø§Ù„Ù…Ù‡Ø§Ù… ==========
        function showAddTaskModal() {
            document.getElementById('addTaskModal').classList.add('active');
        }

        async function addTask() {
            const title = document.getElementById('taskTitle').value.trim();
            const description = document.getElementById('taskDescription').value.trim();
            const reward = parseFloat(document.getElementById('taskReward').value);
            const packageCategories = Array.from(document.getElementById('taskPackageCategories').selectedOptions).map(opt => opt.value);
            const difficulty = document.getElementById('taskDifficulty').value;
            const timeRequired = parseInt(document.getElementById('taskTimeRequired').value);
            const type = document.getElementById('taskType').value;

            if (!title) {
                showNotification('âŒ Ø£Ø¯Ø®Ù„ Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ù…Ù‡Ù…Ø©', 'error');
                return;
            }

            if (packageCategories.length === 0) {
                showNotification('âŒ Ø§Ø®ØªØ± ÙØ¦Ø© ÙˆØ§Ø­Ø¯Ø© Ø¹Ù„Ù‰ Ø§Ù„Ø£Ù‚Ù„', 'error');
                return;
            }

            const taskData = {
                title,
                description,
                reward,
                package_categories: packageCategories,
                difficulty,
                time_required: timeRequired,
                type,
                completions: 0,
                status: 'active',
                created_at: new Date().toISOString()
            };

            const result = await supabaseHelpers.createTask(taskData);
            
            if (result.success) {
                showNotification('âœ… ØªÙ…Øª Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù…Ù‡Ù…Ø© Ø¨Ù†Ø¬Ø§Ø­');
                closeModal('addTaskModal');
                loadTasks();
            } else {
                showNotification('âŒ ÙØ´Ù„ Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù…Ù‡Ù…Ø©: ' + (result.error?.message || 'Ø®Ø·Ø£ ØºÙŠØ± Ù…Ø¹Ø±ÙˆÙ'), 'error');
            }
        }

        async function viewTask(id) {
            const task = adminData.tasks.find(t => t.id === id);
            if (!task) return;

            const categories = (task.package_categories || []).map(c => {
                if (c === 'standard') return 'ğŸ¥ˆ ÙØ¶ÙŠØ©';
                if (c === 'premium') return 'ğŸ¥‡ Ø°Ù‡Ø¨ÙŠØ©';
                if (c === 'vip') return 'ğŸ’ Ù…Ø§Ø³ÙŠØ©';
                return c;
            }).join(', ');

            const difficultyText = task.difficulty === 'easy' ? 'Ø³Ù‡Ù„' : task.difficulty === 'medium' ? 'Ù…ØªÙˆØ³Ø·' : 'ØµØ¹Ø¨';
            const typeText = task.type === 'daily' ? 'ÙŠÙˆÙ…ÙŠØ©' : task.type === 'weekly' ? 'Ø£Ø³Ø¨ÙˆØ¹ÙŠØ©' : 'Ù…Ø±Ø© ÙˆØ§Ø­Ø¯Ø©';

            document.getElementById('taskDetails').innerHTML = `
                <h3 style="margin-bottom: 20px; color: var(--primary);">${task.title}</h3>
                <p style="margin-bottom: 15px;">${task.description || 'Ù„Ø§ ÙŠÙˆØ¬Ø¯ ÙˆØµÙ'}</p>
                <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 15px;">
                    <div><strong>ğŸ’° Ø§Ù„Ù…ÙƒØ§ÙØ£Ø©:</strong> ${task.reward}$</div>
                    <div><strong>ğŸ¯ Ø§Ù„ÙØ¦Ø§Øª:</strong> ${categories}</div>
                    <div><strong>ğŸ“Š Ø§Ù„ØµØ¹ÙˆØ¨Ø©:</strong> ${difficultyText}</div>
                    <div><strong>â±ï¸ Ø§Ù„ÙˆÙ‚Øª:</strong> ${task.time_required || 5} Ø¯Ù‚Ø§Ø¦Ù‚</div>
                    <div><strong>ğŸ“‹ Ø§Ù„Ù†ÙˆØ¹:</strong> ${typeText}</div>
                    <div><strong>âœ… Ø§Ù„Ø¥Ù†Ø¬Ø§Ø²Ø§Øª:</strong> ${task.completions || 0}</div>
                    <div><strong>ğŸ“… Ø§Ù„Ø¥Ø¶Ø§ÙØ©:</strong> ${new Date(task.created_at).toLocaleDateString('ar-SA')}</div>
                    <div><strong>ğŸ”„ Ø§Ù„Ø­Ø§Ù„Ø©:</strong> <span class="status-badge ${task.status === 'active' ? 'status-active' : 'status-pending'}">${task.status === 'active' ? 'Ù†Ø´Ø·' : 'ØºÙŠØ± Ù†Ø´Ø·'}</span></div>
                </div>
            `;
            document.getElementById('viewTaskModal').classList.add('active');
        }

        async function editTask(id) {
            const task = adminData.tasks.find(t => t.id === id);
            if (!task) return;

            currentTaskId = id;

            document.getElementById('editTaskId').value = task.id;
            document.getElementById('editTaskTitle').value = task.title || '';
            document.getElementById('editTaskDescription').value = task.description || '';
            document.getElementById('editTaskReward').value = task.reward || 0;

            // ØªØ­Ø¯ÙŠØ¯ Ø§Ù„ÙØ¦Ø§Øª
            const categories = task.package_categories || [];
            const options = document.getElementById('editTaskPackageCategories').options;
            for (let opt of options) {
                opt.selected = categories.includes(opt.value);
            }

            document.getElementById('editTaskDifficulty').value = task.difficulty || 'medium';
            document.getElementById('editTaskTimeRequired').value = task.time_required || 5;
            document.getElementById('editTaskType').value = task.type || 'daily';
            document.getElementById('editTaskStatus').value = task.status || 'active';

            document.getElementById('editTaskModal').classList.add('active');
        }

        async function updateTask() {
            const id = parseInt(document.getElementById('editTaskId').value);
            const title = document.getElementById('editTaskTitle').value.trim();
            const description = document.getElementById('editTaskDescription').value.trim();
            const reward = parseFloat(document.getElementById('editTaskReward').value);
            const packageCategories = Array.from(document.getElementById('editTaskPackageCategories').selectedOptions).map(opt => opt.value);
            const difficulty = document.getElementById('editTaskDifficulty').value;
            const timeRequired = parseInt(document.getElementById('editTaskTimeRequired').value);
            const type = document.getElementById('editTaskType').value;
            const status = document.getElementById('editTaskStatus').value;

            if (!title) {
                showNotification('âŒ Ø£Ø¯Ø®Ù„ Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ù…Ù‡Ù…Ø©', 'error');
                return;
            }

            if (packageCategories.length === 0) {
                showNotification('âŒ Ø§Ø®ØªØ± ÙØ¦Ø© ÙˆØ§Ø­Ø¯Ø© Ø¹Ù„Ù‰ Ø§Ù„Ø£Ù‚Ù„', 'error');
                return;
            }

            const updates = {
                title,
                description,
                reward,
                package_categories: packageCategories,
                difficulty,
                time_required: timeRequired,
                type,
                status,
                updated_at: new Date().toISOString()
            };

            const result = await supabaseHelpers.updateTask(id, updates);
            
            if (result.success) {
                showNotification('âœ… ØªÙ… ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù…Ù‡Ù…Ø©');
                closeModal('editTaskModal');
                loadTasks();
            } else {
                showNotification('âŒ ÙØ´Ù„ ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù…Ù‡Ù…Ø©', 'error');
            }
        }

        async function deleteTask(id) {
            if (!confirm('Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø­Ø°Ù Ù‡Ø°Ù‡ Ø§Ù„Ù…Ù‡Ù…Ø©ØŸ')) return;

            const result = await supabaseHelpers.deleteTask(id);
            
            if (result.success) {
                showNotification('âœ… ØªÙ… Ø­Ø°Ù Ø§Ù„Ù…Ù‡Ù…Ø©');
                loadTasks();
            } else {
                showNotification('âŒ ÙØ´Ù„ Ø­Ø°Ù Ø§Ù„Ù…Ù‡Ù…Ø©', 'error');
            }
        }

        function searchTasks() {
            const search = document.getElementById('taskSearch').value.toLowerCase();
            document.querySelectorAll('#tasksTable tr').forEach(row => {
                const text = row.textContent.toLowerCase();
                row.style.display = text.includes(search) ? '' : 'none';
            });
        }

        function filterTasks() {
            const filter = document.getElementById('taskCategoryFilter').value;
            document.querySelectorAll('#tasksTable tr').forEach(row => {
                if (filter === 'all') {
                    row.style.display = '';
                    return;
                }
                const categoryCell = row.querySelector('td:nth-child(5)');
                if (categoryCell) {
                    const hasCategory = categoryCell.textContent.includes(
                        filter === 'standard' ? 'ğŸ¥ˆ' : filter === 'premium' ? 'ğŸ¥‡' : 'ğŸ’'
                    );
                    row.style.display = hasCategory ? '' : 'none';
                }
            });
        }

        // ========== Ù…Ø¹Ø§Ù„Ø¬Ø© Ø·Ù„Ø¨Ø§Øª Ø§Ù„Ø§Ø´ØªØ±Ø§Ùƒ ==========
        function showPendingModal(id) {
            currentRequestId = id;
            const req = adminData.pending.find(r => r.id === id);
            if (!req) return;
            
            document.getElementById('pendingRequestInfo').innerHTML = `
                <p><strong>ğŸ‘¤ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…:</strong> ${req.users?.name || req.user_name}</p>
                <p><strong>ğŸ“¦ Ø§Ù„Ø¨Ø§Ù‚Ø©:</strong> ${req.packages?.name || req.package_name}</p>
                <p><strong>ğŸ’° Ø§Ù„Ù…Ø¨Ù„Øº:</strong> ${(req.amount || 0).toFixed(2)}$</p>
                <p><strong>ğŸ“… Ø§Ù„ØªØ§Ø±ÙŠØ®:</strong> ${new Date(req.created_at).toLocaleString('ar-SA')}</p>
                ${req.referred_by ? '<p><span class="referral-code">ğŸ ÙƒÙˆØ¯ Ø¥Ø­Ø§Ù„Ø©: ' + req.referred_by + '</span></p>' : ''}
            `;
            document.getElementById('processPendingModal').classList.add('active');
        }

        async function approvePendingRequest() {
            const req = adminData.pending.find(r => r.id === currentRequestId);
            if (!req) return;

            try {
                // 1. ØªØ­Ø¯ÙŠØ« Ø­Ø§Ù„Ø© Ø§Ù„Ø·Ù„Ø¨
                await supabaseHelpers.updatePendingPackage(req.id, { 
                    status: 'approved',
                    processed_at: new Date().toISOString()
                });

                // 2. ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…
                if (req.user_id) {
                    await supabaseHelpers.updateUser(req.user_id, {
                        package_id: req.package_id,
                        package_activated_at: new Date().toISOString(),
                        balance: supabase.raw(`balance + ${req.amount}`) // Ø¥Ø¶Ø§ÙØ© Ù…ÙƒØ§ÙØ£Ø© Ø¥Ù† ÙˆØ¬Ø¯Øª
                    });

                    // 3. Ø¥Ø¶Ø§ÙØ© Ù…Ø¹Ø§Ù…Ù„Ø©
                    await supabaseHelpers.createTransaction({
                        user_id: req.user_id,
                        type: 'package_purchase',
                        amount: req.amount,
                        description: `ØªÙØ¹ÙŠÙ„ Ø¨Ø§Ù‚Ø© ${req.package_name}`,
                        status: 'completed',
                        created_at: new Date().toISOString()
                    });

                    // 4. Ù…Ø¹Ø§Ù„Ø¬Ø© Ù…ÙƒØ§ÙØ£Ø© Ø§Ù„Ø¥Ø­Ø§Ù„Ø©
                    if (req.referred_by) {
                        const { data: referrer } = await supabase
                            .from('users')
                            .select('id')
                            .eq('referral_code', req.referred_by)
                            .single();

                        if (referrer) {
                            const referralBonus = 50; // Ù…ÙƒØ§ÙØ£Ø© Ø§Ù„Ø¥Ø­Ø§Ù„Ø©
                            
                            await supabaseHelpers.updateUser(referrer.id, {
                                balance: supabase.raw(`balance + ${referralBonus}`),
                                referral_earnings: supabase.raw(`referral_earnings + ${referralBonus}`)
                            });

                            await supabaseHelpers.createTransaction({
                                user_id: referrer.id,
                                type: 'referral',
                                amount: referralBonus,
                                description: `Ù…ÙƒØ§ÙØ£Ø© Ø¥Ø­Ø§Ù„Ø© Ù„Ù„Ù…Ø³ØªØ®Ø¯Ù… ${req.user_name}`,
                                status: 'completed',
                                created_at: new Date().toISOString()
                            });
                        }
                    }
                }

                closeModal('processPendingModal');
                await loadPending();
                await loadUsers();
                await loadSubscriptions();
                await loadReferrals();
                showNotification('âœ… ØªÙ… Ù‚Ø¨ÙˆÙ„ Ø§Ù„Ø·Ù„Ø¨ ÙˆØªÙØ¹ÙŠÙ„ Ø§Ù„Ø¨Ø§Ù‚Ø©');
                
            } catch (error) {
                console.error('Ø®Ø·Ø£ ÙÙŠ Ù…Ø¹Ø§Ù„Ø¬Ø© Ø§Ù„Ø·Ù„Ø¨:', error);
                showNotification('âŒ ÙØ´Ù„ Ù…Ø¹Ø§Ù„Ø¬Ø© Ø§Ù„Ø·Ù„Ø¨', 'error');
            }
        }

        async function rejectPendingRequest() {
            const req = adminData.pending.find(r => r.id === currentRequestId);
            if (!req) return;

            await supabaseHelpers.updatePendingPackage(req.id, { 
                status: 'rejected',
                processed_at: new Date().toISOString()
            });

            closeModal('processPendingModal');
            await loadPending();
            showNotification('âŒ ØªÙ… Ø±ÙØ¶ Ø§Ù„Ø·Ù„Ø¨', 'error');
        }

        // ========== Ù…Ø¹Ø§Ù„Ø¬Ø© Ø·Ù„Ø¨Ø§Øª Ø§Ù„Ø³Ø­Ø¨ ==========
        function showWithdrawalModal(id) {
            currentWithdrawalId = id;
            const w = adminData.withdrawals.find(w => w.id === id);
            if (!w) return;

            document.getElementById('withdrawalRequestInfo').innerHTML = `
                <p><strong>ğŸ‘¤ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…:</strong> ${w.users?.name || w.user_name}</p>
                <p><strong>ğŸ’° Ø§Ù„Ù…Ø¨Ù„Øº:</strong> ${(w.amount || 0).toFixed(2)}$</p>
                <p><strong>ğŸ’³ Ø§Ù„Ù…Ø­ÙØ¸Ø©:</strong> <span style="font-family:monospace;">${w.wallet}</span></p>
                <p><strong>ğŸŒ Ø§Ù„Ø´Ø¨ÙƒØ©:</strong> ${w.network}</p>
                <p><strong>ğŸ“… ØªØ§Ø±ÙŠØ® Ø§Ù„Ø·Ù„Ø¨:</strong> ${new Date(w.created_at).toLocaleString('ar-SA')}</p>
            `;
            document.getElementById('processWithdrawalModal').classList.add('active');
        }

        async function approveWithdrawal() {
            const w = adminData.withdrawals.find(w => w.id === currentWithdrawalId);
            if (!w) return;
            
            const txHash = document.getElementById('transactionHash').value.trim();

            if (!txHash) {
                showNotification('âŒ Ø£Ø¯Ø®Ù„ Ø±Ù‚Ù… Ø§Ù„Ù…Ø¹Ø§Ù…Ù„Ø©', 'error');
                return;
            }

            try {
                // ØªØ­Ø¯ÙŠØ« Ø­Ø§Ù„Ø© Ø§Ù„Ø³Ø­Ø¨
                await supabaseHelpers.updateWithdrawal(w.id, {
                    status: 'completed',
                    tx_hash: txHash,
                    processed_at: new Date().toISOString()
                });

                // ØªØ­Ø¯ÙŠØ« Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù…Ø³Ø­ÙˆØ¨Ø§Øª Ù„Ù„Ù…Ø³ØªØ®Ø¯Ù…
                if (w.user_id) {
                    await supabaseHelpers.updateUser(w.user_id, {
                        total_withdrawn: supabase.raw(`total_withdrawn + ${w.amount}`)
                    });

                    // Ø¥Ø¶Ø§ÙØ© Ù…Ø¹Ø§Ù…Ù„Ø©
                    await supabaseHelpers.createTransaction({
                        user_id: w.user_id,
                        type: 'withdrawal',
                        amount: -w.amount,
                        description: `Ø³Ø­Ø¨ ${w.amount}$ - Ø±Ø³ÙˆÙ… ${w.fee}$`,
                        status: 'completed',
                        created_at: new Date().toISOString()
                    });
                }

                closeModal('processWithdrawalModal');
                await loadWithdrawals();
                await loadUsers();
                showNotification('âœ… ØªÙ… ØªØ£ÙƒÙŠØ¯ Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ù…Ø¨Ù„Øº');
                
            } catch (error) {
                console.error('Ø®Ø·Ø£ ÙÙŠ ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø³Ø­Ø¨:', error);
                showNotification('âŒ ÙØ´Ù„ ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø³Ø­Ø¨', 'error');
            }
        }

        async function rejectWithdrawal() {
            const w = adminData.withdrawals.find(w => w.id === currentWithdrawalId);
            if (!w) return;

            try {
                // ØªØ­Ø¯ÙŠØ« Ø­Ø§Ù„Ø© Ø§Ù„Ø³Ø­Ø¨
                await supabaseHelpers.updateWithdrawal(w.id, {
                    status: 'rejected',
                    processed_at: new Date().toISOString()
                });

                // Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„Ù…Ø¨Ù„Øº Ù„Ù„Ù…Ø³ØªØ®Ø¯Ù…
                if (w.user_id) {
                    await supabaseHelpers.updateUser(w.user_id, {
                        balance: supabase.raw(`balance + ${w.total || (w.amount + w.fee)}`)
                    });

                    // Ø¥Ø¶Ø§ÙØ© Ù…Ø¹Ø§Ù…Ù„Ø©
                    await supabaseHelpers.createTransaction({
                        user_id: w.user_id,
                        type: 'withdrawal_rejected',
                        amount: w.total || (w.amount + w.fee),
                        description: `Ø¥Ø¹Ø§Ø¯Ø© Ù…Ø¨Ù„Øº Ø§Ù„Ø³Ø­Ø¨ Ø§Ù„Ù…Ø±ÙÙˆØ¶`,
                        status: 'completed',
                        created_at: new Date().toISOString()
                    });
                }

                closeModal('processWithdrawalModal');
                await loadWithdrawals();
                await loadUsers();
                showNotification('âŒ ØªÙ… Ø±ÙØ¶ Ø·Ù„Ø¨ Ø§Ù„Ø³Ø­Ø¨', 'error');
                
            } catch (error) {
                console.error('Ø®Ø·Ø£ ÙÙŠ Ø±ÙØ¶ Ø§Ù„Ø³Ø­Ø¨:', error);
                showNotification('âŒ ÙØ´Ù„ Ø±ÙØ¶ Ø§Ù„Ø³Ø­Ø¨', 'error');
            }
        }

        function viewWithdrawalDetails(id) {
            const w = adminData.withdrawals.find(w => w.id === id);
            if (!w) return;
            alert(`ØªÙØ§ØµÙŠÙ„ Ø·Ù„Ø¨ Ø§Ù„Ø³Ø­Ø¨:\nØ§Ù„Ù…Ø¨Ù„Øº: ${w.amount}$\nØ§Ù„Ø­Ø§Ù„Ø©: ${w.status}\nØ§Ù„Ù…Ø­ÙØ¸Ø©: ${w.wallet}\nØ±Ù‚Ù… Ø§Ù„Ù…Ø¹Ø§Ù…Ù„Ø©: ${w.tx_hash || 'â€”'}`);
        }

        // ========== Ø¥Ø¯Ø§Ø±Ø© Ø­Ø§Ù„Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… ==========
        function showUserStatusModal(userId) {
            currentUserId = userId;
            const user = adminData.users.find(u => u.id === userId);
            if (!user) return;

            document.getElementById('statusUserInfo').innerHTML = `
                <p><strong>Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…:</strong> ${user.name}</p>
                <p><strong>Ø§Ù„Ø¨Ø±ÙŠØ¯:</strong> ${user.email}</p>
                <p><strong>Ø§Ù„Ø­Ø§Ù„Ø© Ø§Ù„Ø­Ø§Ù„ÙŠØ©:</strong> <span class="status-badge ${user.status === 'suspended' ? 'status-suspended' : user.status === 'banned' ? 'status-banned' : 'status-active'}">${user.status || 'active'}</span></p>
            `;
            document.getElementById('newUserStatus').value = user.status || 'active';
            document.getElementById('userStatusModal').classList.add('active');
        }

        async function updateUserStatus() {
            const newStatus = document.getElementById('newUserStatus').value;
            const reason = document.getElementById('statusReason').value;

            const result = await supabaseHelpers.updateUser(currentUserId, {
                status: newStatus,
                status_reason: reason,
                status_updated_at: new Date().toISOString()
            });

            if (result.success) {
                closeModal('userStatusModal');
                await loadUsers();
                showNotification(`âœ… ØªÙ… ØªØºÙŠÙŠØ± Ø­Ø§Ù„Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø¥Ù„Ù‰ ${newStatus}`);
            } else {
                showNotification('âŒ ÙØ´Ù„ ØªØºÙŠÙŠØ± Ø§Ù„Ø­Ø§Ù„Ø©', 'error');
            }
        }

        // ========== Ø¥Ø¶Ø§ÙØ© Ù…Ø³ØªØ®Ø¯Ù… ==========
        function showAddUserModal() { 
            document.getElementById('addUserModal').classList.add('active');
        }

        async function addUser() {
            const referralCode = document.getElementById('userReferralCode').value || 
                                'REF' + Math.random().toString(36).substring(2, 8).toUpperCase();

            const newUser = {
                name: document.getElementById('userName').value,
                username: document.getElementById('userUsername').value,
                email: document.getElementById('userEmail').value,
                phone: document.getElementById('userPhone').value,
                password: document.getElementById('userPassword').value,
                balance: parseFloat(document.getElementById('userBalance').value) || 0,
                referral_code: referralCode,
                status: document.getElementById('userStatus').value,
                joined_date: new Date().toISOString(),
                total_earned: 0,
                tasks_completed: 0,
                total_withdrawn: 0,
                referral_earnings: 0
            };

            if (!newUser.name || !newUser.username || !newUser.email) {
                showNotification('âŒ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ„ Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø© ÙŠØ¬Ø¨ ØªØ¹Ø¨Ø¦ØªÙ‡Ø§', 'error');
                return;
            }

            const result = await supabaseHelpers.createUser(newUser);
            
            if (result.success) {
                closeModal('addUserModal');
                await loadUsers();
                showNotification('âœ… ØªÙ…Øª Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…');
            } else {
                showNotification('âŒ ÙØ´Ù„ Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…: ' + (result.error?.message || 'Ø®Ø·Ø£ ØºÙŠØ± Ù…Ø¹Ø±ÙˆÙ'), 'error');
            }
        }

        // ========== Ø¥Ø¶Ø§ÙØ© Ø¨Ø§Ù‚Ø© ==========
        function showAddPackageModal() { 
            document.getElementById('addPackageModal').classList.add('active');
        }

        async function addPackage() {
            const newPackage = {
                name: document.getElementById('packageName').value,
                price: parseFloat(document.getElementById('packagePrice').value),
                profit_percentage: parseFloat(document.getElementById('packageProfit').value) || 2.5,
                category: document.getElementById('packageCategory').value,
                tasks_count: parseInt(document.getElementById('packageTasks').value) || 5,
                duration: parseInt(document.getElementById('packageDuration').value) || 30,
                status: 'active',
                created_at: new Date().toISOString()
            };

            if (!newPackage.name || !newPackage.price) {
                showNotification('âŒ Ø§Ø³Ù… Ø§Ù„Ø¨Ø§Ù‚Ø© ÙˆØ§Ù„Ø³Ø¹Ø± Ù…Ø·Ù„ÙˆØ¨Ø§Ù†', 'error');
                return;
            }

            const result = await supabaseHelpers.createPackage(newPackage);
            
            if (result.success) {
                closeModal('addPackageModal');
                await loadPackages();
                showNotification('âœ… ØªÙ…Øª Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø¨Ø§Ù‚Ø©');
            } else {
                showNotification('âŒ ÙØ´Ù„ Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø¨Ø§Ù‚Ø©', 'error');
            }
        }

        // ========== Ø­Ø°Ù ==========
        async function deleteUser(id) {
            if (!confirm('Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø­Ø°Ù Ù‡Ø°Ø§ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ØŸ')) return;

            const result = await supabaseHelpers.updateUser(id, { status: 'deleted' });
            
            if (result.success) {
                await loadUsers();
                showNotification('âœ… ØªÙ… Ø­Ø°Ù Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…');
            } else {
                showNotification('âŒ ÙØ´Ù„ Ø­Ø°Ù Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…', 'error');
            }
        }

        async function deletePackage(id) {
            if (!confirm('Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø­Ø°Ù Ù‡Ø°Ù‡ Ø§Ù„Ø¨Ø§Ù‚Ø©ØŸ')) return;

            const result = await supabaseHelpers.deletePackage(id);
            
            if (result.success) {
                await loadPackages();
                showNotification('âœ… ØªÙ… Ø­Ø°Ù Ø§Ù„Ø¨Ø§Ù‚Ø©');
            } else {
                showNotification('âŒ ÙØ´Ù„ Ø­Ø°Ù Ø§Ù„Ø¨Ø§Ù‚Ø©', 'error');
            }
        }

        // ========== Ø¨Ø­Ø« ÙˆØªØµÙÙŠØ© ==========
        function searchUsers() {
            const search = document.getElementById('userSearch').value.toLowerCase();
            document.querySelectorAll('#usersTable tr').forEach(row => {
                const text = row.textContent.toLowerCase();
                row.style.display = text.includes(search) ? '' : 'none';
            });
        }

        function filterUsers() {
            const filter = document.getElementById('userStatusFilter').value;
            document.querySelectorAll('#usersTable tr').forEach(row => {
                if (filter === 'all') {
                    row.style.display = '';
                    return;
                }
                const statusSpan = row.querySelector('td:nth-child(7) span');
                if (statusSpan) {
                    const status = statusSpan.textContent.includes('Ù†Ø´Ø·') ? 'active' : 
                                  statusSpan.textContent.includes('Ù…Ø¹Ù„Ù‚') ? 'suspended' : 'banned';
                    row.style.display = status === filter ? '' : 'none';
                }
            });
        }

        // ========== Ø¯ÙˆØ§Ù„ Ù…Ø³Ø§Ø¹Ø¯Ø© ==========
        function refreshDashboard() {
            loadUsers();
            loadPackages();
            loadTasks();
            loadPending();
            loadWithdrawals();
            loadSubscriptions();
            loadReferrals();
            loadAllTransactions();
            showNotification('âœ… ØªÙ… ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª');
        }

        function closeModal(id) { 
            document.getElementById(id).classList.remove('active'); 
        }

        function showNotification(msg, type = 'success') {
            const n = document.getElementById('notification');
            n.innerHTML = `${type === 'success' ? 'âœ…' : 'âŒ'} ${msg}`;
            n.className = `admin-notification ${type}`;
            n.style.display = 'flex';
            setTimeout(() => n.style.display = 'none', 3000);
        }

        // ========== Ø§Ù„ØªÙ‡ÙŠØ¦Ø© ==========
        async function init() {
            const connected = await checkConnection();
            
            if (!connected) {
                showNotification('âš ï¸ ÙØ´Ù„ Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª', 'error');
            }

            // ØªØ­Ù…ÙŠÙ„ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
            await loadPackages(); // ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨Ø§Ù‚Ø§Øª Ø£ÙˆÙ„Ø§Ù‹ Ù„Ø£Ù† Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ† ÙŠØ­ØªØ§Ø¬ÙˆÙ†Ù‡Ø§
            await loadUsers();
            await loadTasks();
            await loadPending();
            await loadWithdrawals();
            await loadSubscriptions();
            await loadReferrals();
            await loadAllTransactions();
            await updateDashboardStats();

            console.log('âœ… Ù„ÙˆØ­Ø© Ø§Ù„Ø¥Ø¯Ø§Ø±Ø© Ø¬Ø§Ù‡Ø²Ø©');
            console.log('ğŸ“Š Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª:', {
                users: adminData.users.length,
                packages: adminData.packages.length,
                tasks: adminData.tasks.length,
                pending: adminData.pending.length,
                withdrawals: adminData.withdrawals.length
            });
        }

        document.addEventListener('DOMContentLoaded', init);
    </script>
</body>
</html>