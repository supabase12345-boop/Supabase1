<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <!-- ØªØ­Ù…ÙŠÙ„ Ù…ÙƒØªØ¨Ø© Supabase Ø£ÙˆÙ„Ø§Ù‹ -->
<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
<!-- Ø«Ù… ØªØ­Ù…ÙŠÙ„ Ù…Ù„Ù Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ù€  -->
<script src="supabase.js"></script>
<!-- Ø«Ù… ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø´ØªØ±ÙƒØ© -->
<script src="shared-data.js"></script>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ù„ÙˆØ­Ø© Ø§Ù„Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…ØªÙ‚Ø¯Ù…Ø© - Elite Investors</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        /* ========== Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ§Øª ========== */
        :root {
            --admin-primary: #1e40af;
            --admin-secondary: #3b82f6;
            --admin-success: #059669;
            --admin-warning: #d97706;
            --admin-danger: #dc2626;
            --admin-dark: #111827;
            --admin-card: #1f2937;
            --admin-text: #f3f4f6;
            --admin-purple: #8b5cf6;
            --admin-info: #0891b2;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Arial', sans-serif;
            background: var(--admin-dark);
            color: var(--admin-text);
        }
        
        .admin-container {
            display: flex;
            min-height: 100vh;
        }
        
        .sidebar {
            width: 280px;
            background: var(--admin-dark);
            border-left: 4px solid var(--admin-primary);
            padding: 20px;
            position: fixed;
            height: 100vh;
            overflow-y: auto;
            box-shadow: 2px 0 10px rgba(0,0,0,0.3);
        }
        
        .sidebar-header {
            text-align: center;
            padding: 20px 0;
            margin-bottom: 30px;
            border-bottom: 2px solid rgba(59, 130, 246, 0.3);
        }
        
        .sidebar-header h2 {
            color: var(--admin-secondary);
            font-size: 1.5rem;
        }
        
        .sidebar-menu {
            list-style: none;
        }
        
        .sidebar-menu li {
            margin-bottom: 10px;
        }
        
        .sidebar-menu a {
            display: flex;
            align-items: center;
            gap: 15px;
            padding: 15px;
            color: #9ca3af;
            text-decoration: none;
            border-radius: 10px;
            transition: all 0.3s;
            border: 1px solid transparent;
        }
        
        .sidebar-menu a:hover,
        .sidebar-menu a.active {
            background: rgba(59, 130, 246, 0.15);
            color: var(--admin-secondary);
            border-color: var(--admin-secondary);
        }
        
        .sidebar-menu i {
            width: 20px;
            text-align: center;
        }
        
        .sidebar-menu .badge {
            background: var(--admin-danger);
            color: white;
            padding: 3px 8px;
            border-radius: 10px;
            font-size: 12px;
            margin-right: auto;
        }
        
        .main-content {
            flex: 1;
            margin-right: 280px;
            padding: 20px;
        }
        
        .admin-header {
            background: var(--admin-card);
            padding: 20px 25px;
            border-radius: 15px;
            margin-bottom: 30px;
            border: 1px solid rgba(59, 130, 246, 0.3);
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }
        
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .stat-card {
            background: var(--admin-card);
            padding: 25px;
            border-radius: 15px;
            border-left: 5px solid var(--admin-primary);
            transition: all 0.3s;
            position: relative;
            overflow: hidden;
        }
        
        .stat-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(0,0,0,0.2);
        }
        
        .stat-icon {
            font-size: 2.5rem;
            margin-bottom: 15px;
            color: var(--admin-secondary);
        }
        
        .stat-value {
            font-size: 2.2rem;
            font-weight: bold;
            margin: 10px 0;
        }
        
        .stat-trend {
            font-size: 0.9rem;
            display: flex;
            align-items: center;
            gap: 5px;
            margin-top: 10px;
        }
        
        .trend-up { color: var(--admin-success); }
        .trend-down { color: var(--admin-danger); }
        
        .admin-table {
            background: var(--admin-card);
            border-radius: 15px;
            overflow: hidden;
            margin-top: 20px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }
        
        .admin-table table {
            width: 100%;
            border-collapse: collapse;
        }
        
        .admin-table th {
            background: rgba(59, 130, 246, 0.2);
            padding: 15px;
            text-align: right;
            border-bottom: 2px solid var(--admin-secondary);
            font-weight: 600;
        }
        
        .admin-table td {
            padding: 15px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .admin-table tr:hover {
            background: rgba(59, 130, 246, 0.1);
        }
        
        .btn {
            padding: 8px 16px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s;
            margin: 0 5px;
            display: inline-flex;
            align-items: center;
            gap: 8px;
            font-size: 14px;
        }
        
        .btn-sm {
            padding: 6px 12px;
            font-size: 12px;
        }
        
        .btn-primary { background: var(--admin-primary); color: white; }
        .btn-success { background: var(--admin-success); color: white; }
        .btn-warning { background: var(--admin-warning); color: white; }
        .btn-danger { background: var(--admin-danger); color: white; }
        .btn-purple { background: var(--admin-purple); color: white; }
        .btn-info { background: var(--admin-info); color: white; }
        
        .btn:hover {
            transform: translateY(-2px);
            opacity: 0.9;
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
        }
        
        .btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }
        
        .form-group {
            margin-bottom: 20px;
        }
        
        .form-group label {
            display: block;
            margin-bottom: 8px;
            color: #9ca3af;
            font-weight: 500;
        }
        
        .form-control {
            width: 100%;
            padding: 12px 15px;
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(59, 130, 246, 0.3);
            border-radius: 10px;
            color: white;
            font-size: 15px;
            transition: all 0.3s;
        }
        
        .form-control:focus {
            outline: none;
            border-color: var(--admin-secondary);
            background: rgba(255, 255, 255, 0.1);
            box-shadow: 0 0 0 2px rgba(59, 130, 246, 0.2);
        }
        
        .section {
            display: none;
        }
        
        .section.active {
            display: block;
            animation: fadeIn 0.3s ease;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .status-badge {
            padding: 5px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: bold;
            display: inline-block;
        }
        
        .status-active {
            background: rgba(5, 150, 105, 0.2);
            color: var(--admin-success);
            border: 1px solid var(--admin-success);
        }
        
        .status-pending {
            background: rgba(217, 119, 6, 0.2);
            color: var(--admin-warning);
            border: 1px solid var(--admin-warning);
        }
        
        .status-rejected {
            background: rgba(220, 38, 38, 0.2);
            color: var(--admin-danger);
            border: 1px solid var(--admin-danger);
        }
        
        .status-suspended {
            background: rgba(245, 158, 11, 0.2);
            color: #f59e0b;
            border: 1px solid #f59e0b;
        }
        
        .status-banned {
            background: rgba(220, 38, 38, 0.2);
            color: #ef4444;
            border: 1px solid #ef4444;
        }
        
        .search-box {
            background: var(--admin-card);
            padding: 20px;
            border-radius: 15px;
            margin-bottom: 20px;
            display: flex;
            gap: 15px;
            align-items: center;
            flex-wrap: wrap;
        }
        
        .search-input {
            flex: 1;
            min-width: 250px;
            padding: 12px 18px;
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(59, 130, 246, 0.3);
            border-radius: 10px;
            color: white;
            font-size: 15px;
        }
        
        .search-input:focus {
            outline: none;
            border-color: var(--admin-secondary);
        }
        
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.9);
            z-index: 2000;
            align-items: center;
            justify-content: center;
            padding: 20px;
            backdrop-filter: blur(5px);
        }
        
        .modal.active {
            display: flex;
            animation: modalFadeIn 0.3s ease;
        }
        
        @keyframes modalFadeIn {
            from { opacity: 0; transform: scale(0.95); }
            to { opacity: 1; transform: scale(1); }
        }
        
        .modal-content {
            background: var(--admin-card);
            border-radius: 20px;
            padding: 30px;
            width: 100%;
            max-width: 600px;
            border: 2px solid var(--admin-primary);
            max-height: 90vh;
            overflow-y: auto;
            box-shadow: 0 20px 40px rgba(0,0,0,0.4);
        }
        
        .modal-content.large {
            max-width: 800px;
        }
        
        .loading {
            text-align: center;
            padding: 40px;
            color: #9ca3b8;
        }
        
        .loading i {
            font-size: 2.5rem;
            margin-bottom: 15px;
            color: var(--admin-secondary);
            animation: spin 1s linear infinite;
        }
        
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        
        .badge {
            background: var(--admin-primary);
            color: white;
            padding: 4px 10px;
            border-radius: 12px;
            font-size: 12px;
            margin-right: 8px;
            display: inline-block;
        }
        
        .badge.success { background: var(--admin-success); }
        .badge.warning { background: var(--admin-warning); }
        .badge.danger { background: var(--admin-danger); }
        .badge.purple { background: var(--admin-purple); }
        
        .referral-code {
            background: linear-gradient(45deg, var(--admin-purple), #7c3aed);
            padding: 8px 15px;
            border-radius: 8px;
            font-family: 'Courier New', monospace;
            font-size: 14px;
            letter-spacing: 1px;
            display: inline-block;
            margin: 5px 0;
            color: white;
            font-weight: bold;
        }
        
        .referral-stats {
            background: rgba(139, 92, 246, 0.1);
            padding: 15px;
            border-radius: 10px;
            margin: 10px 0;
            border: 1px solid rgba(139, 92, 246, 0.3);
        }
        
        .commission-badge {
            background: var(--admin-success);
            color: white;
            padding: 4px 10px;
            border-radius: 6px;
            font-size: 12px;
            margin-right: 5px;
            display: inline-block;
        }
        
        .network-tag {
            padding: 4px 10px;
            border-radius: 6px;
            font-size: 11px;
            font-weight: bold;
            margin-right: 5px;
            color: white;
        }
        
        .trc20-tag { background: #14b8a6; }
        .erc20-tag { background: #f59e0b; }
        .bep20-tag { background: #8b5cf6; }
        
        .user-detail-card {
            background: rgba(255,255,255,0.03);
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 20px;
            border: 1px solid rgba(59,130,246,0.2);
        }
        
        .user-detail-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }
        
        .user-avatar-large {
            width: 80px;
            height: 80px;
            background: linear-gradient(45deg, var(--admin-primary), var(--admin-secondary));
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 32px;
            font-weight: bold;
            color: white;
        }
        
        .info-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 20px;
            margin-bottom: 20px;
        }
        
        .info-item {
            background: rgba(0,0,0,0.2);
            padding: 15px;
            border-radius: 10px;
        }
        
        .info-label {
            color: #9ca3af;
            font-size: 13px;
            margin-bottom: 5px;
        }
        
        .info-value {
            font-size: 18px;
            font-weight: bold;
            color: white;
        }
        
        .info-value.success { color: var(--admin-success); }
        .info-value.warning { color: var(--admin-warning); }
        .info-value.danger { color: var(--admin-danger); }
        .info-value.info { color: var(--admin-info); }
        
        .action-buttons {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }
        
        .chart-container {
            background: var(--admin-card);
            border-radius: 15px;
            padding: 20px;
            margin: 20px 0;
            border: 1px solid rgba(59, 130, 246, 0.3);
        }
        
        .chart-title {
            margin-bottom: 20px;
            color: var(--admin-secondary);
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .admin-notification {
            position: fixed;
            top: 100px;
            left: 50%;
            transform: translateX(-50%);
            background: var(--admin-card);
            color: white;
            padding: 18px 30px;
            border-radius: 12px;
            border-right: 6px solid var(--admin-success);
            z-index: 10000;
            box-shadow: 0 10px 30px rgba(0,0,0,0.5);
            animation: slideInDown 0.3s ease;
            min-width: 350px;
            text-align: center;
            font-weight: 500;
            display: flex;
            align-items: center;
            gap: 15px;
            justify-content: center;
        }
        
        .admin-notification.error {
            border-right-color: var(--admin-danger);
        }
        
        .admin-notification.warning {
            border-right-color: var(--admin-warning);
        }
        
        @keyframes slideInDown {
            from { transform: translate(-50%, -30px); opacity: 0; }
            to { transform: translate(-50%, 0); opacity: 1; }
        }
        
        @media (max-width: 1024px) {
            .stats-grid {
                grid-template-columns: repeat(2, 1fr);
            }
        }
        
        @media (max-width: 768px) {
            .admin-container {
                flex-direction: column;
            }
            
            .sidebar {
                position: relative;
                width: 100%;
                height: auto;
            }
            
            .main-content {
                margin-right: 0;
            }
            
            .stats-grid {
                grid-template-columns: 1fr;
            }
            
            .admin-table {
                overflow-x: auto;
            }
            
            .search-box {
                flex-direction: column;
            }
            
            .search-input {
                width: 100%;
            }
            
            .info-grid {
                grid-template-columns: 1fr;
            }
            
            .user-detail-header {
                flex-direction: column;
                gap: 15px;
            }
        }
        
        .text-success { color: var(--admin-success); }
        .text-warning { color: var(--admin-warning); }
        .text-danger { color: var(--admin-danger); }
        .text-info { color: var(--admin-info); }
        .text-muted { color: #9ca3af; }
        
        .mt-2 { margin-top: 10px; }
        .mt-3 { margin-top: 15px; }
        .mt-4 { margin-top: 20px; }
        .mb-2 { margin-bottom: 10px; }
        .mb-3 { margin-bottom: 15px; }
        .mb-4 { margin-bottom: 20px; }
        
        .text-center { text-align: center; }
        .text-left { text-align: left; }
        .text-right { text-align: right; }
        
        .w-100 { width: 100%; }
        
        .d-flex { display: flex; }
        .align-center { align-items: center; }
        .justify-between { justify-content: space-between; }
        .gap-2 { gap: 10px; }
        .gap-3 { gap: 15px; }
        .gap-4 { gap: 20px; }
        
        .flex-wrap { flex-wrap: wrap; }
    </style>
</head>
<body>
    <div class="admin-container">
        <!-- ========== Ø§Ù„Ø´Ø±ÙŠØ· Ø§Ù„Ø¬Ø§Ù†Ø¨ÙŠ ========== -->
        <div class="sidebar">
            <div class="sidebar-header">
                <h2><i class="fas fa-shield-alt"></i> Ù„ÙˆØ­Ø© Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©</h2>
                <small style="color: #9ca3af;">Elite Investors v2.0</small>
            </div>
            
            <ul class="sidebar-menu">
                <li><a href="#" class="active" onclick="showSection('dashboard'); event.preventDefault();">
                    <i class="fas fa-tachometer-alt"></i> Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…
                    <span id="dashboardBadge" class="badge" style="display: none;">Ø¬Ø¯ÙŠØ¯</span>
                </a></li>
                <li><a href="#" onclick="showSection('users'); event.preventDefault();">
                    <i class="fas fa-users-cog"></i> Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†
                    <span id="usersCount" class="badge">0</span>
                </a></li>
                <li><a href="#" onclick="showSection('packages'); event.preventDefault();">
                    <i class="fas fa-crown"></i> Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø¨Ø§Ù‚Ø§Øª
                    <span id="packagesCount" class="badge">0</span>
                </a></li>
                <li><a href="#" onclick="showSection('tasks'); event.preventDefault();">
                    <i class="fas fa-tasks"></i> Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ù‡Ø§Ù…
                    <span id="tasksCount" class="badge">0</span>
                </a></li>
                <li><a href="#" onclick="showSection('referrals'); event.preventDefault();">
                    <i class="fas fa-user-friends"></i> Ù†Ø¸Ø§Ù… Ø§Ù„Ø¥Ø­Ø§Ù„Ø©
                    <span id="referralsCount" class="badge">0</span>
                </a></li>
                <li><a href="#" onclick="showSection('pending'); event.preventDefault();">
                    <i class="fas fa-clock"></i> Ø§Ù„Ø·Ù„Ø¨Ø§Øª Ø§Ù„Ù…Ø¹Ù„Ù‚Ø©
                    <span id="pendingCount" class="badge">0</span>
                </a></li>
                <li><a href="#" onclick="showSection('subscriptions'); event.preventDefault();">
                    <i class="fas fa-shopping-cart"></i> Ø§Ù„Ø§Ø´ØªØ±Ø§ÙƒØ§Øª
                    <span id="subscriptionsCount" class="badge">0</span>
                </a></li>
                <li><a href="#" onclick="showSection('withdrawals'); event.preventDefault();">
                    <i class="fas fa-money-bill-wave"></i> Ø·Ù„Ø¨Ø§Øª Ø§Ù„Ø³Ø­Ø¨
                    <span id="withdrawalsCount" class="badge">0</span>
                </a></li>
                <li><a href="#" onclick="showSection('transactions'); event.preventDefault();">
                    <i class="fas fa-exchange-alt"></i> Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…Ø¹Ø§Ù…Ù„Ø§Øª
                </a></li>
                <li><a href="#" onclick="showSection('reports'); event.preventDefault();">
                    <i class="fas fa-chart-bar"></i> Ø§Ù„ØªÙ‚Ø§Ø±ÙŠØ±
                </a></li>
                <li><a href="#" onclick="showSection('settings'); event.preventDefault();">
                    <i class="fas fa-cog"></i> Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª
                </a></li>
                <li><a href="index.html" style="color: var(--admin-danger);">
                    <i class="fas fa-sign-out-alt"></i> Ø§Ù„Ø¹ÙˆØ¯Ø© Ù„Ù„Ù…ÙˆÙ‚Ø¹
                </a></li>
            </ul>
        </div>
        
        <!-- ========== Ø§Ù„Ù…Ø­ØªÙˆÙ‰ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ ========== -->
        <div class="main-content">
            <!-- ========== Ù‚Ø³Ù… Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ… ========== -->
            <div id="dashboard-section" class="section active">
                <div class="admin-header">
                    <h2><i class="fas fa-tachometer-alt"></i> Ù†Ø¸Ø±Ø© Ø¹Ø§Ù…Ø© Ø¹Ù„Ù‰ Ø§Ù„Ù†Ø¸Ø§Ù…</h2>
                    <div>
                        <span id="currentTime" style="margin-left: 15px; color: #9ca3af;"></span>
                        <button class="btn btn-sm btn-primary" onclick="refreshDashboard()">
                            <i class="fas fa-sync-alt"></i> ØªØ­Ø¯ÙŠØ«
                        </button>
                    </div>
                </div>
                
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-icon">
                            <i class="fas fa-users"></i>
                        </div>
                        <div class="stat-value" id="totalUsers">0</div>
                        <p>Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†</p>
                        <div class="stat-trend" id="usersTrend">
                            <i class="fas fa-arrow-up trend-up"></i>
                            <span id="newUsersToday">+0 Ø§Ù„ÙŠÙˆÙ…</span>
                        </div>
                    </div>
                    
                    <div class="stat-card">
                        <div class="stat-icon">
                            <i class="fas fa-money-bill-wave"></i>
                        </div>
                        <div class="stat-value" id="totalDeposits">0$</div>
                        <p>Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø¥ÙŠØ¯Ø§Ø¹Ø§Øª</p>
                        <div class="stat-trend" id="depositsTrend">
                            <i class="fas fa-arrow-up trend-up"></i>
                            <span id="todayDeposits">+0$</span>
                        </div>
                    </div>
                    
                    <div class="stat-card">
                        <div class="stat-icon">
                            <i class="fas fa-user-friends"></i>
                        </div>
                        <div class="stat-value" id="totalReferrals">0</div>
                        <p>Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø¥Ø­Ø§Ù„Ø§Øª</p>
                        <div class="stat-trend" id="referralsTrend">
                            <i class="fas fa-arrow-up trend-up"></i>
                            <span id="referralsThisWeek">+0 Ù‡Ø°Ø§ Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹</span>
                        </div>
                    </div>
                    
                    <div class="stat-card">
                        <div class="stat-icon">
                            <i class="fas fa-clock"></i>
                        </div>
                        <div class="stat-value" id="pendingRequests">0</div>
                        <p>Ø·Ù„Ø¨Ø§Øª Ø¨Ø§Ù†ØªØ¸Ø§Ø± Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹Ø©</p>
                        <div class="stat-trend" id="pendingTrend">
                            <i class="fas fa-clock"></i>
                            <span id="pendingBreakdown">0 Ø§Ø´ØªØ±Ø§Ùƒ / 0 Ø³Ø­Ø¨</span>
                        </div>
                    </div>
                </div>
                
                <div class="stats-grid" style="grid-template-columns: repeat(5, 1fr);">
                    <div class="stat-card" style="padding: 15px;">
                        <div class="stat-value success" id="activeUsers">0</div>
                        <p>Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ† Ù†Ø´Ø·ÙŠÙ†</p>
                    </div>
                    <div class="stat-card" style="padding: 15px;">
                        <div class="stat-value warning" id="suspendedUsers">0</div>
                        <p>Ù…Ø¹Ù„Ù‚ÙŠÙ†</p>
                    </div>
                    <div class="stat-card" style="padding: 15px;">
                        <div class="stat-value danger" id="bannedUsers">0</div>
                        <p>Ù…Ø­Ø¸ÙˆØ±ÙŠÙ†</p>
                    </div>
                    <div class="stat-card" style="padding: 15px;">
                        <div class="stat-value info" id="activeSubscriptions">0</div>
                        <p>Ø¨Ø§Ù‚Ø§Øª Ù†Ø´Ø·Ø©</p>
                    </div>
                    <div class="stat-card" style="padding: 15px;">
                        <div class="stat-value" id="totalWithdrawn">0$</div>
                        <p>Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù…Ø³Ø­ÙˆØ¨Ø§Øª</p>
                    </div>
                </div>
                
                <div class="chart-container">
                    <h4 class="chart-title"><i class="fas fa-chart-pie"></i> ØªÙˆØ²ÙŠØ¹ Ø§Ù„Ø¨Ø§Ù‚Ø§Øª</h4>
                    <div id="packagesChart" style="height: 300px; position: relative;">
                        <canvas id="packagesChartCanvas"></canvas>
                    </div>
                </div>
                
                <div class="admin-table">
                    <div style="padding: 20px; display: flex; justify-content: space-between; align-items: center;">
                        <h4><i class="fas fa-history"></i> Ø£Ø­Ø¯Ø« Ø§Ù„Ù†Ø´Ø§Ø·Ø§Øª</h4>
                        <button class="btn btn-sm btn-info" onclick="exportActivities()">
                            <i class="fas fa-download"></i> ØªØµØ¯ÙŠØ±
                        </button>
                    </div>
                    <table>
                        <thead>
                            <tr>
                                <th>Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…</th>
                                <th>Ø§Ù„Ù†Ø´Ø§Ø·</th>
                                <th>Ø§Ù„Ù…Ø¨Ù„Øº</th>
                                <th>Ø§Ù„ØªØ§Ø±ÙŠØ®</th>
                                <th>Ø§Ù„Ø­Ø§Ù„Ø©</th>
                            </tr>
                        </thead>
                        <tbody id="recentActivities">
                            <tr>
                                <td colspan="5" class="loading">
                                    <i class="fas fa-spinner fa-spin"></i>
                                    <p>Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª...</p>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
            
            <!-- ========== Ù‚Ø³Ù… Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ† ========== -->
            <div id="users-section" class="section">
                <div class="admin-header">
                    <h2><i class="fas fa-users-cog"></i> Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ† Ø§Ù„Ù…ØªÙ‚Ø¯Ù…Ø©</h2>
                    <div class="action-buttons">
                        <button class="btn btn-sm btn-primary" onclick="refreshUsers()">
                            <i class="fas fa-sync-alt"></i> ØªØ­Ø¯ÙŠØ«
                        </button>
                        <button class="btn btn-success" onclick="showAddUserModal()">
                            <i class="fas fa-user-plus"></i> Ø¥Ø¶Ø§ÙØ© Ù…Ø³ØªØ®Ø¯Ù…
                        </button>
                        <button class="btn btn-info" onclick="exportUsers()">
                            <i class="fas fa-file-export"></i> ØªØµØ¯ÙŠØ±
                        </button>
                    </div>
                </div>
                
                <div class="stats-grid" style="grid-template-columns: repeat(6, 1fr); margin-bottom: 20px;">
                    <div class="stat-card" style="padding: 15px; background: rgba(30, 64, 175, 0.2);">
                        <div class="stat-value" id="userStatsTotal">0</div>
                        <p style="font-size: 13px;">Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†</p>
                    </div>
                    <div class="stat-card" style="padding: 15px; background: rgba(5, 150, 105, 0.2);">
                        <div class="stat-value success" id="userStatsActive">0</div>
                        <p style="font-size: 13px;">Ù†Ø´Ø·ÙŠÙ†</p>
                    </div>
                    <div class="stat-card" style="padding: 15px; background: rgba(139, 92, 246, 0.2);">
                        <div class="stat-value info" id="userStatsWithPackage">0</div>
                        <p style="font-size: 13px;">Ù„Ø¯ÙŠÙ‡Ù… Ø¨Ø§Ù‚Ø©</p>
                    </div>
                    <div class="stat-card" style="padding: 15px; background: rgba(245, 158, 11, 0.2);">
                        <div class="stat-value warning" id="userStatsSuspended">0</div>
                        <p style="font-size: 13px;">Ù…Ø¹Ù„Ù‚ÙŠÙ†</p>
                    </div>
                    <div class="stat-card" style="padding: 15px; background: rgba(220, 38, 38, 0.2);">
                        <div class="stat-value danger" id="userStatsBanned">0</div>
                        <p style="font-size: 13px;">Ù…Ø­Ø¸ÙˆØ±ÙŠÙ†</p>
                    </div>
                    <div class="stat-card" style="padding: 15px; background: rgba(6, 182, 212, 0.2);">
                        <div class="stat-value" id="userStatsBalance">0$</div>
                        <p style="font-size: 13px;">Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø£Ø±ØµØ¯Ø©</p>
                    </div>
                </div>
                
                <div class="search-box">
                    <div style="display: flex; gap: 10px; flex: 1; flex-wrap: wrap;">
                        <input type="text" class="search-input" id="userSearchInput" placeholder="ğŸ” Ø§Ø¨Ø­Ø« Ø¨Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ØŒ Ø§Ù„Ø¨Ø±ÙŠØ¯ØŒ Ø§Ù„Ù‡Ø§ØªÙØŒ ÙƒÙˆØ¯ Ø§Ù„Ø¥Ø­Ø§Ù„Ø©..." style="flex: 2;" onkeyup="searchUsers()">
                        <select class="search-input" id="userStatusFilter" style="flex: 1;" onchange="filterUsers()">
                            <option value="all">ğŸ”µ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†</option>
                            <option value="active">ğŸŸ¢ Ù†Ø´Ø·ÙŠÙ†</option>
                            <option value="suspended">ğŸŸ  Ù…Ø¹Ù„Ù‚ÙŠÙ†</option>
                            <option value="banned">ğŸ”´ Ù…Ø­Ø¸ÙˆØ±ÙŠÙ†</option>
                            <option value="with-package">ğŸ’ Ù„Ø¯ÙŠÙ‡Ù… Ø¨Ø§Ù‚Ø©</option>
                            <option value="without-package">ğŸ“¦ Ø¨Ø¯ÙˆÙ† Ø¨Ø§Ù‚Ø©</option>
                            <option value="with-referrals">ğŸ‘¥ Ù„Ø¯ÙŠÙ‡Ù… Ø¥Ø­Ø§Ù„Ø§Øª</option>
                            <option value="with-referral-code">ğŸ« Ù…Ø³Ø¬Ù„ÙŠÙ† Ø¨Ø¥Ø­Ø§Ù„Ø©</option>
                        </select>
                        <select class="search-input" id="userPackageFilter" style="flex: 1;" onchange="filterUsers()">
                            <option value="all">ğŸ“Š Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¨Ø§Ù‚Ø§Øª</option>
                            <option value="standard">ğŸ¥ˆ ÙØ¶ÙŠØ©</option>
                            <option value="premium">ğŸ¥‡ Ø°Ù‡Ø¨ÙŠØ©</option>
                            <option value="vip">ğŸ’ Ù…Ø§Ø³ÙŠØ©</option>
                        </select>
                    </div>
                    <button class="btn btn-primary" onclick="resetUserFilters()">
                        <i class="fas fa-redo-alt"></i> Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ†
                    </button>
                </div>
                
                <div class="admin-table">
                    <table>
                        <thead>
                            <tr>
                                <th>#</th>
                                <th>Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…</th>
                                <th>Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø­Ø³Ø§Ø¨</th>
                                <th>Ø§Ù„Ø¨Ø§Ù‚Ø© / Ø§Ù„Ø£Ø±Ø¨Ø§Ø­</th>
                                <th>Ø§Ù„Ø¥Ø­Ø§Ù„Ø§Øª</th>
                                <th>Ø§Ù„Ø±ØµÙŠØ¯</th>
                                <th>Ø§Ù„Ù…Ø³Ø­ÙˆØ¨Ø§Øª</th>
                                <th>Ø§Ù„Ø­Ø§Ù„Ø©</th>
                                <th>Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª</th>
                            </tr>
                        </thead>
                        <tbody id="usersTable">
                            <tr>
                                <td colspan="9" class="loading">
                                    <i class="fas fa-spinner fa-spin"></i>
                                    <p>Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†...</p>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                    <div id="usersPagination" style="padding: 20px; display: flex; justify-content: center; gap: 10px;"></div>
                </div>
            </div>
            
            <!-- ========== Ù‚Ø³Ù… Ø§Ù„Ø¨Ø§Ù‚Ø§Øª ========== -->
            <div id="packages-section" class="section">
                <div class="admin-header">
                    <h2><i class="fas fa-crown"></i> Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø¨Ø§Ù‚Ø§Øª</h2>
                    <button class="btn btn-success" onclick="showAddPackageModal()">
                        <i class="fas fa-plus-circle"></i> Ø¥Ø¶Ø§ÙØ© Ø¨Ø§Ù‚Ø© Ø¬Ø¯ÙŠØ¯Ø©
                    </button>
                </div>
                
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-value" id="activePackages">0</div>
                        <p>Ø§Ù„Ø¨Ø§Ù‚Ø§Øª Ø§Ù„Ù†Ø´Ø·Ø©</p>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value" id="activeSubscriptionsCount">0</div>
                        <p>Ø§Ù„Ø§Ø´ØªØ±Ø§ÙƒØ§Øª Ø§Ù„Ù†Ø´Ø·Ø©</p>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value" id="totalInvestments">0$</div>
                        <p>Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø§Ø³ØªØ«Ù…Ø§Ø±Ø§Øª</p>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value" id="dailyRevenue">0$</div>
                        <p>Ø§Ù„Ø¥ÙŠØ±Ø§Ø¯Ø§Øª Ø§Ù„ÙŠÙˆÙ…ÙŠØ©</p>
                    </div>
                </div>
                
                <div class="admin-table">
                    <table>
                        <thead>
                            <tr>
                                <th>Ø§Ø³Ù… Ø§Ù„Ø¨Ø§Ù‚Ø©</th>
                                <th>Ø§Ù„Ø³Ø¹Ø±</th>
                                <th>Ø§Ù„Ø±Ø¨Ø­ Ø§Ù„ÙŠÙˆÙ…ÙŠ</th>
                                <th>Ø§Ù„ÙØ¦Ø©</th>
                                <th>Ø§Ù„Ù…Ù‡Ø§Ù…/ÙŠÙˆÙ…</th>
                                <th>Ø§Ù„Ù…Ø¯Ø©</th>
                                <th>Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†</th>
                                <th>Ø§Ù„Ø­Ø§Ù„Ø©</th>
                                <th>Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª</th>
                            </tr>
                        </thead>
                        <tbody id="packagesTable">
                            <tr>
                                <td colspan="9" class="loading">
                                    <i class="fas fa-spinner fa-spin"></i>
                                    <p>Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨Ø§Ù‚Ø§Øª...</p>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
            
            <!-- ========== Ù‚Ø³Ù… Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ù‡Ø§Ù… ========== -->
            <div id="tasks-section" class="section">
                <div class="admin-header">
                    <h2><i class="fas fa-tasks"></i> Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ù‡Ø§Ù…</h2>
                    <button class="btn btn-success" onclick="showAddTaskModal()">
                        <i class="fas fa-plus"></i> Ø¥Ø¶Ø§ÙØ© Ù…Ù‡Ù…Ø© Ø¬Ø¯ÙŠØ¯Ø©
                    </button>
                </div>
                
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-value" id="totalTasks">0</div>
                        <p>Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù…Ù‡Ø§Ù…</p>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value" id="activeTasks">0</div>
                        <p>Ø§Ù„Ù…Ù‡Ø§Ù… Ø§Ù„Ù†Ø´Ø·Ø©</p>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value" id="totalCompletions">0</div>
                        <p>Ù…Ø±Ø§Øª Ø§Ù„Ø¥ÙƒÙ…Ø§Ù„</p>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value" id="totalRewards">0$</div>
                        <p>Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù…ÙƒØ§ÙØ¢Øª</p>
                    </div>
                </div>
                
                <div class="admin-table">
                    <table>
                        <thead>
                            <tr>
                                <th>Ø§Ø³Ù… Ø§Ù„Ù…Ù‡Ù…Ø©</th>
                                <th>Ø§Ù„ÙˆØµÙ</th>
                                <th>Ø§Ù„Ù…ÙƒØ§ÙØ£Ø©</th>
                                <th>Ø§Ù„Ù†ÙˆØ¹</th>
                                <th>Ø§Ù„Ù…Ø³ØªÙˆÙ‰</th>
                                <th>Ø§Ù„ÙØ¦Ø§Øª Ø§Ù„Ù…Ø³Ù…ÙˆØ­Ø©</th>
                                <th>Ù…Ø±Ø§Øª Ø§Ù„Ø¥ÙƒÙ…Ø§Ù„</th>
                                <th>Ø§Ù„Ø­Ø§Ù„Ø©</th>
                                <th>Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª</th>
                            </tr>
                        </thead>
                        <tbody id="tasksTable">
                            <tr>
                                <td colspan="9" class="loading">
                                    <i class="fas fa-spinner fa-spin"></i>
                                    <p>Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ù‡Ø§Ù…...</p>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
            
            <!-- ========== Ù‚Ø³Ù… Ù†Ø¸Ø§Ù… Ø§Ù„Ø¥Ø­Ø§Ù„Ø© ========== -->
            <div id="referrals-section" class="section">
                <div class="admin-header">
                    <h2><i class="fas fa-user-friends"></i> Ù†Ø¸Ø§Ù… Ø§Ù„Ø¥Ø­Ø§Ù„Ø© Ø§Ù„Ù…ØªÙ‚Ø¯Ù…</h2>
                    <div>
                        <span class="badge success" style="font-size: 14px;">ğŸ’° Ø§Ù„Ù…Ø­ÙŠÙ„: 50$</span>
                        <span class="badge warning" style="font-size: 14px;">ğŸ Ø§Ù„Ù…Ø­Ø§Ù„: 20$</span>
                        <button class="btn btn-purple" onclick="showReferralSettings()" style="margin-right: 15px;">
                            <i class="fas fa-cog"></i> Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª
                        </button>
                    </div>
                </div>
                
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-icon">
                            <i class="fas fa-user-plus"></i>
                        </div>
                        <div class="stat-value" id="totalReferralsCount">0</div>
                        <p>Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø¥Ø­Ø§Ù„Ø§Øª</p>
                    </div>
                    
                    <div class="stat-card">
                        <div class="stat-icon">
                            <i class="fas fa-money-bill-wave"></i>
                        </div>
                        <div class="stat-value" id="totalReferralEarnings">0$</div>
                        <p>Ø£Ø±Ø¨Ø§Ø­ Ø§Ù„Ø¥Ø­Ø§Ù„Ø© Ø§Ù„Ù…Ø¯ÙÙˆØ¹Ø©</p>
                    </div>
                    
                    <div class="stat-card">
                        <div class="stat-icon">
                            <i class="fas fa-clock"></i>
                        </div>
                        <div class="stat-value warning" id="pendingReferralRewards">0$</div>
                        <p>Ù…ÙƒØ§ÙØ¢Øª Ø¨Ø§Ù†ØªØ¸Ø§Ø± Ø§Ù„ØµØ±Ù</p>
                    </div>
                    
                    <div class="stat-card">
                        <div class="stat-icon">
                            <i class="fas fa-percentage"></i>
                        </div>
                        <div class="stat-value" id="referralConversion">0%</div>
                        <p>Ù…Ø¹Ø¯Ù„ Ø§Ù„ØªØ­ÙˆÙŠÙ„</p>
                    </div>
                </div>
                
                <div class="admin-table">
                    <div style="padding: 20px; display: flex; justify-content: space-between;">
                        <h4><i class="fas fa-trophy" style="color: gold;"></i> Ø£ÙØ¶Ù„ Ø§Ù„Ù…Ø³ÙˆÙ‚ÙŠÙ† (Ø­Ø³Ø¨ Ø§Ù„Ø¥Ø­Ø§Ù„Ø§Øª)</h4>
                        <button class="btn btn-sm btn-success" onclick="payAllCommissions()">
                            <i class="fas fa-money-bill-wave"></i> ØµØ±Ù Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¹Ù…ÙˆÙ„Ø§Øª
                        </button>
                    </div>
                    <table>
                        <thead>
                            <tr>
                                <th>Ø§Ù„ØªØ±ØªÙŠØ¨</th>
                                <th>Ø§Ù„Ù…Ø³ÙˆÙ‚</th>
                                <th>ÙƒÙˆØ¯ Ø§Ù„Ø¥Ø­Ø§Ù„Ø©</th>
                                <th>Ø¹Ø¯Ø¯ Ø§Ù„Ø¥Ø­Ø§Ù„Ø§Øª</th>
                                <th>Ø§Ù„Ø¥Ø­Ø§Ù„Ø§Øª Ø§Ù„Ù†Ø´Ø·Ø©</th>
                                <th>Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù…Ø¨Ø§Ù„Øº</th>
                                <th>Ø§Ù„Ø¹Ù…ÙˆÙ„Ø© Ø§Ù„Ù…Ø³ØªØ­Ù‚Ø©</th>
                                <th>Ø§Ù„Ù…Ø¯ÙÙˆØ¹Ø©</th>
                                <th>Ø§Ù„Ù…ØªØ¨Ù‚ÙŠ</th>
                                <th>Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª</th>
                            </tr>
                        </thead>
                        <tbody id="topMarketersTable">
                            <tr>
                                <td colspan="10" class="loading">
                                    <i class="fas fa-spinner fa-spin"></i>
                                    <p>Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª...</p>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                
                <div class="admin-table" style="margin-top: 30px;">
                    <div style="padding: 20px;">
                        <h4><i class="fas fa-list"></i> ØªÙØ§ØµÙŠÙ„ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¥Ø­Ø§Ù„Ø§Øª</h4>
                    </div>
                    <table>
                        <thead>
                            <tr>
                                <th>Ø§Ù„Ù…Ø­Ø§Ù„</th>
                                <th>Ø§Ù„Ù…Ø³ÙˆÙ‚</th>
                                <th>ÙƒÙˆØ¯ Ø§Ù„Ø¥Ø­Ø§Ù„Ø©</th>
                                <th>Ø§Ù„Ø¨Ø§Ù‚Ø©</th>
                                <th>Ø§Ù„Ù…Ø¨Ù„Øº</th>
                                <th>Ù…ÙƒØ§ÙØ£Ø© Ø§Ù„Ù…Ø­Ø§Ù„</th>
                                <th>Ø¹Ù…ÙˆÙ„Ø© Ø§Ù„Ù…Ø³ÙˆÙ‚</th>
                                <th>Ø§Ù„ØªØ§Ø±ÙŠØ®</th>
                                <th>Ø§Ù„Ø­Ø§Ù„Ø©</th>
                                <th>Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª</th>
                            </tr>
                        </thead>
                        <tbody id="referralsDetailsTable">
                            <tr>
                                <td colspan="10" class="loading">
                                    <i class="fas fa-spinner fa-spin"></i>
                                    <p>Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¥Ø­Ø§Ù„Ø§Øª...</p>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
            
            <!-- ========== Ù‚Ø³Ù… Ø§Ù„Ø·Ù„Ø¨Ø§Øª Ø§Ù„Ù…Ø¹Ù„Ù‚Ø© ========== -->
            <div id="pending-section" class="section">
                <div class="admin-header">
                    <h2><i class="fas fa-clock"></i> Ø§Ù„Ø·Ù„Ø¨Ø§Øª Ø§Ù„Ù…Ø¹Ù„Ù‚Ø©</h2>
                    <div>
                        <button class="btn btn-sm btn-primary" onclick="refreshPending()">
                            <i class="fas fa-sync-alt"></i> ØªØ­Ø¯ÙŠØ«
                        </button>
                    </div>
                </div>
                
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-value" id="pendingPackagesCount">0</div>
                        <p>Ø·Ù„Ø¨Ø§Øª Ø§Ø´ØªØ±Ø§Ùƒ Ù…Ø¹Ù„Ù‚Ø©</p>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value" id="pendingWithdrawalsCount">0</div>
                        <p>Ø·Ù„Ø¨Ø§Øª Ø³Ø­Ø¨ Ù…Ø¹Ù„Ù‚Ø©</p>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value" id="totalPendingAmount">0$</div>
                        <p>Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù…Ø¨Ø§Ù„Øº Ø§Ù„Ù…Ø¹Ù„Ù‚Ø©</p>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value" id="avgPendingTime">0h</div>
                        <p>Ù…ØªÙˆØ³Ø· ÙˆÙ‚Øª Ø§Ù„Ø§Ù†ØªØ¸Ø§Ø±</p>
                    </div>
                </div>
                
                <div class="admin-table">
                    <div style="padding: 20px;">
                        <h4><i class="fas fa-shopping-cart"></i> Ø·Ù„Ø¨Ø§Øª Ø§Ø´ØªØ±Ø§Ùƒ Ù…Ø¹Ù„Ù‚Ø©</h4>
                    </div>
                    <table>
                        <thead>
                            <tr>
                                <th>Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…</th>
                                <th>Ø§Ù„Ø¨Ø§Ù‚Ø©</th>
                                <th>Ø§Ù„Ù…Ø¨Ù„Øº</th>
                                <th>Ø±Ù‚Ù… Ø§Ù„Ù…Ø¹Ø§Ù…Ù„Ø©</th>
                                <th>Ø§Ù„Ø´Ø¨ÙƒØ©</th>
                                <th>Ø§Ù„Ø³Ø±Ø¹Ø©</th>
                                <th>Ø§Ù„ØªØ§Ø±ÙŠØ®</th>
                                <th>Ù…ÙƒØ§ÙØ£Ø© Ø§Ù„Ø¥Ø­Ø§Ù„Ø©</th>
                                <th>Ø§Ù„Ø­Ø§Ù„Ø©</th>
                                <th>Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª</th>
                            </tr>
                        </thead>
                        <tbody id="pendingPackagesTable">
                            <tr>
                                <td colspan="10" class="loading">
                                    <i class="fas fa-spinner fa-spin"></i>
                                    <p>Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø·Ù„Ø¨Ø§Øª...</p>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                
                <div class="admin-table" style="margin-top: 30px;">
                    <div style="padding: 20px;">
                        <h4><i class="fas fa-money-bill-wave"></i> Ø·Ù„Ø¨Ø§Øª Ø³Ø­Ø¨ Ù…Ø¹Ù„Ù‚Ø©</h4>
                    </div>
                    <table>
                        <thead>
                            <tr>
                                <th>Ø±Ù‚Ù… Ø§Ù„Ø·Ù„Ø¨</th>
                                <th>Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…</th>
                                <th>Ø§Ù„Ù…Ø¨Ù„Øº</th>
                                <th>Ø§Ù„Ø±Ø³ÙˆÙ…</th>
                                <th>Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ù…Ø­ÙØ¸Ø©</th>
                                <th>Ø§Ù„Ø´Ø¨ÙƒØ©</th>
                                <th>ØªØ§Ø±ÙŠØ® Ø§Ù„Ø·Ù„Ø¨</th>
                                <th>Ø§Ù„Ø­Ø§Ù„Ø©</th>
                                <th>Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª</th>
                            </tr>
                        </thead>
                        <tbody id="pendingWithdrawalsTable">
                            <tr>
                                <td colspan="9" class="loading">
                                    <i class="fas fa-spinner fa-spin"></i>
                                    <p>Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„ Ø·Ù„Ø¨Ø§Øª Ø§Ù„Ø³Ø­Ø¨...</p>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
            
            <!-- ========== Ù‚Ø³Ù… Ø§Ù„Ø§Ø´ØªØ±Ø§ÙƒØ§Øª ========== -->
            <div id="subscriptions-section" class="section">
                <div class="admin-header">
                    <h2><i class="fas fa-shopping-cart"></i> Ø§Ù„Ø§Ø´ØªØ±Ø§ÙƒØ§Øª Ø§Ù„Ù†Ø´Ø·Ø©</h2>
                    <div>
                        <button class="btn btn-sm btn-primary" onclick="refreshSubscriptions()">
                            <i class="fas fa-sync-alt"></i> ØªØ­Ø¯ÙŠØ«
                        </button>
                    </div>
                </div>
                
                <div class="admin-table">
                    <table>
                        <thead>
                            <tr>
                                <th>Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…</th>
                                <th>Ø§Ù„Ø¨Ø§Ù‚Ø©</th>
                                <th>Ø§Ù„Ø§Ø³ØªØ«Ù…Ø§Ø±</th>
                                <th>Ø§Ù„Ø±Ø¨Ø­ Ø§Ù„ÙŠÙˆÙ…ÙŠ</th>
                                <th>ØªØ§Ø±ÙŠØ® Ø§Ù„Ø¨Ø¯Ø¡</th>
                                <th>ØªØ§Ø±ÙŠØ® Ø§Ù„Ø§Ù†ØªÙ‡Ø§Ø¡</th>
                                <th>Ø§Ù„Ø£ÙŠØ§Ù… Ø§Ù„Ù…ØªØ¨Ù‚ÙŠØ©</th>
                                <th>Ø§Ù„Ø­Ø§Ù„Ø©</th>
                                <th>Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª</th>
                            </tr>
                        </thead>
                        <tbody id="subscriptionsTable">
                            <tr>
                                <td colspan="9" class="loading">
                                    <i class="fas fa-spinner fa-spin"></i>
                                    <p>Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø§Ø´ØªØ±Ø§ÙƒØ§Øª...</p>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
            
            <!-- ========== Ù‚Ø³Ù… Ø·Ù„Ø¨Ø§Øª Ø§Ù„Ø³Ø­Ø¨ ========== -->
            <div id="withdrawals-section" class="section">
                <div class="admin-header">
                    <h2><i class="fas fa-money-bill-wave"></i> Ø·Ù„Ø¨Ø§Øª Ø§Ù„Ø³Ø­Ø¨</h2>
                    <div>
                        <button class="btn btn-sm btn-primary" onclick="exportWithdrawals()">
                            <i class="fas fa-download"></i> ØªØµØ¯ÙŠØ±
                        </button>
                    </div>
                </div>
                
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-value" id="totalWithdrawalsCount">0</div>
                        <p>Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø·Ù„Ø¨Ø§Øª Ø§Ù„Ø³Ø­Ø¨</p>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value" id="totalWithdrawnAmount">0$</div>
                        <p>Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù…Ø³Ø­ÙˆØ¨Ø§Øª</p>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value" id="avgWithdrawal">0$</div>
                        <p>Ù…ØªÙˆØ³Ø· Ù‚ÙŠÙ…Ø© Ø§Ù„Ø³Ø­Ø¨</p>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value" id="rejectedWithdrawals">0</div>
                        <p>Ø·Ù„Ø¨Ø§Øª Ù…Ø±ÙÙˆØ¶Ø©</p>
                    </div>
                </div>
                
                <div class="search-box">
                    <select class="search-input" id="withdrawalStatusFilter" onchange="filterWithdrawals()">
                        <option value="all">Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø·Ù„Ø¨Ø§Øª</option>
                        <option value="pending">Ù…Ø¹Ù„Ù‚Ø© ÙÙ‚Ø·</option>
                        <option value="approved">Ù…Ù‚Ø¨ÙˆÙ„Ø© ÙÙ‚Ø·</option>
                        <option value="rejected">Ù…Ø±ÙÙˆØ¶Ø© ÙÙ‚Ø·</option>
                    </select>
                    <input type="date" class="search-input" id="withdrawalDateFilter" onchange="filterWithdrawals()">
                    <button class="btn btn-primary" onclick="filterWithdrawals()">
                        <i class="fas fa-filter"></i> ØªØµÙÙŠØ©
                    </button>
                </div>
                
                <div class="admin-table">
                    <table>
                        <thead>
                            <tr>
                                <th>Ø±Ù‚Ù… Ø§Ù„Ø·Ù„Ø¨</th>
                                <th>Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…</th>
                                <th>Ø§Ù„Ù…Ø¨Ù„Øº</th>
                                <th>Ø§Ù„Ø±Ø³ÙˆÙ…</th>
                                <th>Ø§Ù„Ø´Ø¨ÙƒØ©</th>
                                <th>Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ù…Ø­ÙØ¸Ø©</th>
                                <th>ØªØ§Ø±ÙŠØ® Ø§Ù„Ø·Ù„Ø¨</th>
                                <th>Ø§Ù„Ø­Ø§Ù„Ø©</th>
                                <th>Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª</th>
                            </tr>
                        </thead>
                        <tbody id="withdrawalsTable">
                            <tr>
                                <td colspan="9" class="loading">
                                    <i class="fas fa-spinner fa-spin"></i>
                                    <p>Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„ Ø·Ù„Ø¨Ø§Øª Ø§Ù„Ø³Ø­Ø¨...</p>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
            
            <!-- ========== Ù‚Ø³Ù… Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…Ø¹Ø§Ù…Ù„Ø§Øª ========== -->
            <div id="transactions-section" class="section">
                <div class="admin-header">
                    <h2><i class="fas fa-exchange-alt"></i> Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…Ø¹Ø§Ù…Ù„Ø§Øª</h2>
                    <div>
                        <button class="btn btn-sm btn-primary" onclick="exportAllTransactions()">
                            <i class="fas fa-download"></i> ØªØµØ¯ÙŠØ±
                        </button>
                    </div>
                </div>
                
                <div class="search-box">
                    <input type="text" class="search-input" id="transactionSearch" placeholder="Ø§Ø¨Ø­Ø« Ø¹Ù† Ù…Ø¹Ø§Ù…Ù„Ø©..." onkeyup="searchTransactions()">
                    <select class="search-input" id="transactionTypeFilter" onchange="filterTransactions()">
                        <option value="all">Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…Ø¹Ø§Ù…Ù„Ø§Øª</option>
                        <option value="Ø§Ø´ØªØ±Ø§Ùƒ">Ø§Ø´ØªØ±Ø§ÙƒØ§Øª</option>
                        <option value="Ø³Ø­Ø¨">Ø³Ø­ÙˆØ¨Ø§Øª</option>
                        <option value="Ø±Ø¨Ø­">Ø£Ø±Ø¨Ø§Ø­</option>
                        <option value="Ù…ÙƒØ§ÙØ£Ø©">Ù…ÙƒØ§ÙØ¢Øª</option>
                        <option value="Ù…ÙƒØ§ÙØ£Ø© Ø¥Ø­Ø§Ù„Ø©">Ù…ÙƒØ§ÙØ¢Øª Ø¥Ø­Ø§Ù„Ø©</option>
                    </select>
                    <input type="date" class="search-input" id="transactionDateFilter" onchange="filterTransactions()">
                </div>
                
                <div class="admin-table">
                    <table>
                        <thead>
                            <tr>
                                <th>Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…</th>
                                <th>Ù†ÙˆØ¹ Ø§Ù„Ù…Ø¹Ø§Ù…Ù„Ø©</th>
                                <th>Ø§Ù„ÙˆØµÙ</th>
                                <th>Ø§Ù„Ù…Ø¨Ù„Øº</th>
                                <th>Ø§Ù„ØªØ§Ø±ÙŠØ®</th>
                                <th>Ø§Ù„Ø­Ø§Ù„Ø©</th>
                                <th>Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª</th>
                            </tr>
                        </thead>
                        <tbody id="transactionsTable">
                            <tr>
                                <td colspan="7" class="loading">
                                    <i class="fas fa-spinner fa-spin"></i>
                                    <p>Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ø¹Ø§Ù…Ù„Ø§Øª...</p>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
            
            <!-- ========== Ù‚Ø³Ù… Ø§Ù„ØªÙ‚Ø§Ø±ÙŠØ± ========== -->
            <div id="reports-section" class="section">
                <div class="admin-header">
                    <h2><i class="fas fa-chart-bar"></i> Ø§Ù„ØªÙ‚Ø§Ø±ÙŠØ± ÙˆØ§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª</h2>
                    <div>
                        <button class="btn btn-primary" onclick="generateReport('daily')">
                            <i class="fas fa-file-pdf"></i> ØªÙ‚Ø±ÙŠØ± ÙŠÙˆÙ…ÙŠ
                        </button>
                        <button class="btn btn-success" onclick="generateReport('monthly')" style="margin-right: 10px;">
                            <i class="fas fa-file-excel"></i> ØªÙ‚Ø±ÙŠØ± Ø´Ù‡Ø±ÙŠ
                        </button>
                    </div>
                </div>
                
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-value" id="todayRevenue">0$</div>
                        <p>Ø¥ÙŠØ±Ø§Ø¯Ø§Øª Ø§Ù„ÙŠÙˆÙ…</p>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value" id="weekRevenue">0$</div>
                        <p>Ø¥ÙŠØ±Ø§Ø¯Ø§Øª Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹</p>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value" id="monthRevenue">0$</div>
                        <p>Ø¥ÙŠØ±Ø§Ø¯Ø§Øª Ø§Ù„Ø´Ù‡Ø±</p>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value" id="growthRate">0%</div>
                        <p>Ù…Ø¹Ø¯Ù„ Ø§Ù„Ù†Ù…Ùˆ</p>
                    </div>
                </div>
                
                <div class="chart-container">
                    <h4 class="chart-title"><i class="fas fa-chart-line"></i> Ø¥ÙŠØ±Ø§Ø¯Ø§Øª Ø¢Ø®Ø± 7 Ø£ÙŠØ§Ù…</h4>
                    <div id="revenueChart" style="height: 300px;">
                        <canvas id="revenueChartCanvas"></canvas>
                    </div>
                </div>
            </div>
            
            <!-- ========== Ù‚Ø³Ù… Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª ========== -->
            <div id="settings-section" class="section">
                <div class="admin-header">
                    <h2><i class="fas fa-cog"></i> Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ù†Ø¸Ø§Ù…</h2>
                </div>
                
                <div class="admin-table">
                    <div style="padding: 20px;">
                        <h4><i class="fas fa-user-friends"></i> Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ù†Ø¸Ø§Ù… Ø§Ù„Ø¥Ø­Ø§Ù„Ø©</h4>
                    </div>
                    <div style="padding: 20px;">
                        <div class="form-group">
                            <label>Ù…ÙƒØ§ÙØ£Ø© ØµØ§Ø­Ø¨ Ø§Ù„ÙƒÙˆØ¯ (Ø§Ù„Ù…Ø­ÙŠÙ„) - $</label>
                            <input type="number" class="form-control" id="referrerReward" value="50" min="10" max="500" step="5">
                            <small style="color: #9ca3af;">Ø§Ù„Ù…Ø¨Ù„Øº Ø§Ù„Ø°ÙŠ ÙŠØ­ØµÙ„ Ø¹Ù„ÙŠÙ‡ Ø§Ù„Ù…Ø³ÙˆÙ‚ Ø¹Ù†Ø¯ ØªÙØ¹ÙŠÙ„ Ø§Ù„Ù…Ø­Ø§Ù„ Ø¨Ø§Ù‚Ø©</small>
                        </div>
                        
                        <div class="form-group">
                            <label>Ù…ÙƒØ§ÙØ£Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø§Ù„Ø¬Ø¯ÙŠØ¯ (Ø§Ù„Ù…Ø­Ø§Ù„) - $</label>
                            <input type="number" class="form-control" id="refereeReward" value="20" min="5" max="200" step="5">
                            <small style="color: #9ca3af;">Ø§Ù„Ù…Ø¨Ù„Øº Ø§Ù„Ø°ÙŠ ÙŠØ­ØµÙ„ Ø¹Ù„ÙŠÙ‡ Ø§Ù„Ù…Ø­Ø§Ù„ Ø¹Ù†Ø¯ ØªÙØ¹ÙŠÙ„ Ø£ÙˆÙ„ Ø¨Ø§Ù‚Ø©</small>
                        </div>
                        
                        <div class="form-group">
                            <label>Ø§Ù„Ø­Ø¯ Ø§Ù„Ø£Ø¯Ù†Ù‰ Ù„Ù„Ø³Ø­Ø¨ ($)</label>
                            <input type="number" class="form-control" id="minWithdrawal" value="50" min="10" step="10">
                        </div>
                        
                        <div class="form-group">
                            <label>Ø±Ø³ÙˆÙ… Ø´Ø¨ÙƒØ© TRC20 ($)</label>
                            <input type="number" class="form-control" id="trc20Fee" value="5" min="0" step="1">
                        </div>
                        
                        <div class="form-group">
                            <label>Ø±Ø³ÙˆÙ… Ø´Ø¨ÙƒØ© ERC20 ($)</label>
                            <input type="number" class="form-control" id="erc20Fee" value="15" min="0" step="1">
                        </div>
                        
                        <div class="form-group">
                            <label>Ø±Ø³ÙˆÙ… Ø´Ø¨ÙƒØ© BEP20 ($)</label>
                            <input type="number" class="form-control" id="bep20Fee" value="3" min="0" step="1">
                        </div>
                        
                        <button class="btn btn-success" onclick="saveSystemSettings()">
                            <i class="fas fa-save"></i> Ø­ÙØ¸ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>
<!-- ========== Ù†Ø§ÙØ°Ø© Ø¥Ø¶Ø§ÙØ© Ù…Ø³ØªØ®Ø¯Ù… ========== -->
    <div class="modal" id="addUserModal">
        <div class="modal-content">
            <h3 style="text-align: center; margin-bottom: 25px;">
                <i class="fas fa-user-plus" style="color: var(--admin-success);"></i>
                Ø¥Ø¶Ø§ÙØ© Ù…Ø³ØªØ®Ø¯Ù… Ø¬Ø¯ÙŠØ¯
            </h3>
            
            <div class="form-group">
                <label>Ø§Ù„Ø§Ø³Ù… Ø§Ù„ÙƒØ§Ù…Ù„ *</label>
                <input type="text" class="form-control" id="userFullName" placeholder="Ø£Ø¯Ø®Ù„ Ø§Ù„Ø§Ø³Ù… Ø§Ù„ÙƒØ§Ù…Ù„" required>
            </div>
            
            <div class="form-group">
                <label>Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… *</label>
                <input type="text" class="form-control" id="userUsername" placeholder="Ø§Ø®ØªØ± Ø§Ø³Ù… Ù…Ø³ØªØ®Ø¯Ù… ÙØ±ÙŠØ¯" required>
            </div>
            
            <div class="form-group">
                <label>Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ *</label>
                <input type="email" class="form-control" id="userEmail" placeholder="Ø£Ø¯Ø®Ù„ Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ" required>
            </div>
            
            <div class="form-group">
                <label>Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ *</label>
                <input type="tel" class="form-control" id="userPhone" placeholder="Ø£Ø¯Ø®Ù„ Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ" required>
            </div>
            
            <div class="form-group">
                <label>ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± *</label>
                <input type="password" class="form-control" id="userPassword" placeholder="Ø§Ø®ØªØ± ÙƒÙ„Ù…Ø© Ù…Ø±ÙˆØ±" required>
            </div>
            
            <div class="form-group">
                <label>ÙƒÙˆØ¯ Ø§Ù„Ø¥Ø­Ø§Ù„Ø© (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)</label>
                <input type="text" class="form-control" id="userReferralCode" placeholder="Ø£Ø¯Ø®Ù„ ÙƒÙˆØ¯ Ø§Ù„Ø¥Ø­Ø§Ù„Ø©">
                <small style="color: #9ca3af;">Ø³ÙŠØ­ØµÙ„ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø¹Ù„Ù‰ 20$ Ø¹Ù†Ø¯ ØªÙØ¹ÙŠÙ„ Ø§Ù„Ø¨Ø§Ù‚Ø©</small>
            </div>
            
            <div class="form-group">
                <label>Ø§Ù„Ø±ØµÙŠØ¯ Ø§Ù„Ø§Ø¨ØªØ¯Ø§Ø¦ÙŠ ($)</label>
                <input type="number" class="form-control" id="userBalance" placeholder="0" value="0" min="0" step="10">
            </div>
            
            <div class="form-group">
                <label>Ù†ÙˆØ¹ Ø§Ù„Ø­Ø³Ø§Ø¨</label>
                <select class="form-control" id="userType">
                    <option value="user">ğŸ‘¤ Ù…Ø³ØªØ®Ø¯Ù… Ø¹Ø§Ø¯ÙŠ</option>
                    <option value="admin">ğŸ‘‘ Ù…Ø´Ø±Ù</option>
                </select>
            </div>
            
            <div class="form-group">
                <label>Ø§Ù„Ø­Ø§Ù„Ø©</label>
                <select class="form-control" id="userStatus">
                    <option value="active">ğŸŸ¢ Ù†Ø´Ø·</option>
                    <option value="suspended">ğŸŸ  Ù…Ø¹Ù„Ù‚</option>
                    <option value="banned">ğŸ”´ Ù…Ø­Ø¸ÙˆØ±</option>
                </select>
            </div>
            
            <div style="display: flex; gap: 15px; margin-top: 25px;">
                <button class="btn" style="flex: 1; background: var(--admin-danger);" onclick="closeModal('addUserModal')">
                    <i class="fas fa-times"></i> Ø¥Ù„ØºØ§Ø¡
                </button>
                <button class="btn" style="flex: 2; background: var(--admin-success);" onclick="addUser()">
                    <i class="fas fa-save"></i> Ø­ÙØ¸ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…
                </button>
            </div>
        </div>
    </div>
    
    <!-- ========== Ù†Ø§ÙØ°Ø© ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… ========== -->
    <div class="modal" id="userDetailsModal">
        <div class="modal-content large">
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 25px;">
                <h3 style="display: flex; align-items: center; gap: 10px;">
                    <i class="fas fa-user-circle" style="color: var(--admin-primary);"></i>
                    ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…
                </h3>
                <button class="btn btn-sm" style="background: var(--admin-danger);" onclick="closeModal('userDetailsModal')">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            
            <div id="userDetailsContent">
                <!-- Ø³ÙŠØªÙ… Ù…Ù„Ø¤Ù‡Ø§ Ø¨Ø§Ù„Ø¬Ø§ÙØ§Ø³ÙƒØ±ÙŠØ¨Øª -->
            </div>
        </div>
    </div>
    
    <!-- ========== Ù†Ø§ÙØ°Ø© ØªØ¹Ø¯ÙŠÙ„ Ø­Ø§Ù„Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… ========== -->
    <div class="modal" id="userStatusModal">
        <div class="modal-content">
            <h3 style="text-align: center; margin-bottom: 25px;">
                <i class="fas fa-shield-alt" style="color: var(--admin-warning);"></i>
                ØªØºÙŠÙŠØ± Ø­Ø§Ù„Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…
            </h3>
            
            <div id="statusUserInfo" style="background: rgba(59,130,246,0.1); padding: 15px; border-radius: 10px; margin-bottom: 20px;">
                <!-- Ø³ÙŠØªÙ… Ù…Ù„Ø¤Ù‡Ø§ -->
            </div>
            
            <div class="form-group">
                <label>Ø§Ù„Ø­Ø§Ù„Ø© Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø©</label>
                <select class="form-control" id="newUserStatus">
                    <option value="active">ğŸŸ¢ Ù†Ø´Ø· - ÙŠÙ…ÙƒÙ†Ù‡ Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ù†Ø¸Ø§Ù… ÙƒØ§Ù…Ù„Ø§Ù‹</option>
                    <option value="suspended">ğŸŸ  Ù…Ø¹Ù„Ù‚ - Ù„Ø§ ÙŠÙ…ÙƒÙ†Ù‡ Ø§Ù„Ø³Ø­Ø¨ Ø£Ùˆ Ø´Ø±Ø§Ø¡ Ø¨Ø§Ù‚Ø§Øª Ø¬Ø¯ÙŠØ¯Ø©</option>
                    <option value="banned">ğŸ”´ Ù…Ø­Ø¸ÙˆØ± - Ù„Ø§ ÙŠÙ…ÙƒÙ†Ù‡ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø¥Ù„Ù‰ Ø§Ù„Ù†Ø¸Ø§Ù…</option>
                </select>
            </div>
            
            <div class="form-group">
                <label>Ø³Ø¨Ø¨ Ø§Ù„ØªØºÙŠÙŠØ±</label>
                <textarea class="form-control" id="statusReason" rows="3" placeholder="Ø£Ø¯Ø®Ù„ Ø³Ø¨Ø¨ ØªØºÙŠÙŠØ± Ø§Ù„Ø­Ø§Ù„Ø©..."></textarea>
            </div>
            
            <div style="display: flex; gap: 15px; margin-top: 25px;">
                <button class="btn" style="flex: 1; background: var(--admin-danger);" onclick="closeModal('userStatusModal')">
                    Ø¥Ù„ØºØ§Ø¡
                </button>
                <button class="btn" style="flex: 2; background: var(--admin-warning);" onclick="confirmUpdateUserStatus()">
                    <i class="fas fa-save"></i> ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø­Ø§Ù„Ø©
                </button>
            </div>
        </div>
    </div>
    
    <!-- ========== Ù†Ø§ÙØ°Ø© Ø¥Ø¶Ø§ÙØ© Ø¨Ø§Ù‚Ø© ========== -->
    <div class="modal" id="addPackageModal">
        <div class="modal-content">
            <h3 style="text-align: center; margin-bottom: 25px;">
                <i class="fas fa-crown" style="color: var(--admin-success);"></i>
                Ø¥Ø¶Ø§ÙØ© Ø¨Ø§Ù‚Ø© Ø¬Ø¯ÙŠØ¯Ø©
            </h3>
            
            <div class="form-group">
                <label>Ø§Ø³Ù… Ø§Ù„Ø¨Ø§Ù‚Ø© *</label>
                <input type="text" class="form-control" id="packageName" placeholder="Ù…Ø«Ø§Ù„: Ø§Ù„Ø¨Ø§Ù‚Ø© Ø§Ù„Ø°Ù‡Ø¨ÙŠØ©" required>
            </div>
            
            <div class="form-group">
                <label>Ø³Ø¹Ø± Ø§Ù„Ø¨Ø§Ù‚Ø© ($) *</label>
                <input type="number" class="form-control" id="packagePrice" placeholder="Ù…Ø«Ø§Ù„: 1000" required>
            </div>
            
            <div class="form-group">
                <label>Ù†Ø³Ø¨Ø© Ø§Ù„Ø±Ø¨Ø­ Ø§Ù„ÙŠÙˆÙ…ÙŠ (%) *</label>
                <input type="number" class="form-control" id="packageProfit" placeholder="Ù…Ø«Ø§Ù„: 2.5" step="0.1" min="0.5" max="10" required>
            </div>
            
            <div class="form-group">
                <label>ÙØ¦Ø© Ø§Ù„Ø¨Ø§Ù‚Ø© *</label>
                <select class="form-control" id="packageCategory" required>
                    <option value="standard">ğŸ¥ˆ Ø¹Ø§Ø¯ÙŠØ© (Standard)</option>
                    <option value="premium">ğŸ¥‡ Ù…Ù…ÙŠØ²Ø© (Premium)</option>
                    <option value="vip">ğŸ’ VIP</option>
                </select>
            </div>
            
            <div class="form-group">
                <label>Ø¹Ø¯Ø¯ Ø§Ù„Ù…Ù‡Ø§Ù… Ø§Ù„ÙŠÙˆÙ…ÙŠØ© *</label>
                <input type="number" class="form-control" id="packageTasks" placeholder="Ù…Ø«Ø§Ù„: 5" min="1" max="20" required>
            </div>
            
            <div class="form-group">
                <label>Ù…Ø¯Ø© Ø§Ù„Ø¨Ø§Ù‚Ø© (Ø¨Ø§Ù„Ø£ÙŠØ§Ù…) *</label>
                <input type="number" class="form-control" id="packageDuration" placeholder="Ù…Ø«Ø§Ù„: 30" min="1" max="365" required>
            </div>
            
            <div class="form-group">
                <label>ÙˆØµÙ Ø§Ù„Ø¨Ø§Ù‚Ø©</label>
                <textarea class="form-control" id="packageDescription" rows="3" placeholder="Ø£Ø¯Ø®Ù„ ÙˆØµÙØ§Ù‹ Ù„Ù„Ø¨Ø§Ù‚Ø©..."></textarea>
            </div>
            
            <div style="display: flex; gap: 15px; margin-top: 25px;">
                <button class="btn" style="flex: 1; background: var(--admin-danger);" onclick="closeModal('addPackageModal')">
                    Ø¥Ù„ØºØ§Ø¡
                </button>
                <button class="btn" style="flex: 2; background: var(--admin-success);" onclick="addPackage()">
                    <i class="fas fa-save"></i> Ø­ÙØ¸ Ø§Ù„Ø¨Ø§Ù‚Ø©
                </button>
            </div>
        </div>
    </div>
    
    <!-- ========== Ù†Ø§ÙØ°Ø© Ø¥Ø¶Ø§ÙØ© Ù…Ù‡Ù…Ø© ========== -->
    <div class="modal" id="addTaskModal">
        <div class="modal-content">
            <h3 style="text-align: center; margin-bottom: 25px;">
                <i class="fas fa-tasks" style="color: var(--admin-success);"></i>
                Ø¥Ø¶Ø§ÙØ© Ù…Ù‡Ù…Ø© Ø¬Ø¯ÙŠØ¯Ø©
            </h3>
            
            <div class="form-group">
                <label>Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ù…Ù‡Ù…Ø© *</label>
                <input type="text" class="form-control" id="taskTitle" placeholder="Ù…Ø«Ø§Ù„: Ù…Ø´Ø§Ù‡Ø¯Ø© ÙÙŠØ¯ÙŠÙˆ" required>
            </div>
            
            <div class="form-group">
                <label>ÙˆØµÙ Ø§Ù„Ù…Ù‡Ù…Ø© *</label>
                <textarea class="form-control" id="taskDesc" rows="3" placeholder="Ø£Ø¯Ø®Ù„ ÙˆØµÙØ§Ù‹ Ù„Ù„Ù…Ù‡Ù…Ø©..." required></textarea>
            </div>
            
            <div class="form-group">
                <label>Ø§Ù„Ù…ÙƒØ§ÙØ£Ø© ($) *</label>
                <input type="number" class="form-control" id="taskReward" placeholder="Ù…Ø«Ø§Ù„: 2.5" step="0.1" min="0.1" required>
            </div>
            
            <div class="form-group">
                <label>Ù†ÙˆØ¹ Ø§Ù„Ù…Ù‡Ù…Ø©</label>
                <select class="form-control" id="taskType">
                    <option value="daily">ÙŠÙˆÙ…ÙŠØ©</option>
                    <option value="weekly">Ø£Ø³Ø¨ÙˆØ¹ÙŠØ©</option>
                </select>
            </div>
            
            <div class="form-group">
                <label>Ø§Ù„Ù…Ø³ØªÙˆÙ‰ Ø§Ù„Ù…Ø·Ù„ÙˆØ¨</label>
                <select class="form-control" id="taskLevel">
                    <option value="all">Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†</option>
                    <option value="premium">Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ† Ø§Ù„Ù…Ù…ÙŠØ²ÙŠÙ†</option>
                    <option value="vip">VIP ÙÙ‚Ø·</option>
                </select>
            </div>
            
            <div class="form-group">
                <label>Ø§Ù„ÙØ¦Ø§Øª Ø§Ù„Ù…Ø³Ù…ÙˆØ­Ø© *</label>
                <div style="background: rgba(255,255,255,0.05); padding: 15px; border-radius: 10px;">
                    <label style="display: block; margin-bottom: 10px;">
                        <input type="checkbox" id="catStandard" value="standard" checked>
                        <span style="margin-right: 10px;">ğŸ¥ˆ Ø¹Ø§Ø¯ÙŠØ© (Standard)</span>
                    </label>
                    <label style="display: block; margin-bottom: 10px;">
                        <input type="checkbox" id="catPremium" value="premium" checked>
                        <span style="margin-right: 10px;">ğŸ¥‡ Ù…Ù…ÙŠØ²Ø© (Premium)</span>
                    </label>
                    <label style="display: block;">
                        <input type="checkbox" id="catVip" value="vip">
                        <span style="margin-right: 10px;">ğŸ’ VIP</span>
                    </label>
                </div>
                <small style="color: #9ca3af;">ÙŠØ¬Ø¨ Ø§Ø®ØªÙŠØ§Ø± ÙØ¦Ø© ÙˆØ§Ø­Ø¯Ø© Ø¹Ù„Ù‰ Ø§Ù„Ø£Ù‚Ù„</small>
            </div>
            
            <div class="form-group">
                <label>Ø§Ù„ØµØ¹ÙˆØ¨Ø©</label>
                <select class="form-control" id="taskDifficulty">
                    <option value="easy">Ø³Ù‡Ù„Ø©</option>
                    <option value="medium">Ù…ØªÙˆØ³Ø·Ø©</option>
                    <option value="hard">ØµØ¹Ø¨Ø©</option>
                </select>
            </div>
            
            <div class="form-group">
                <label>Ø§Ù„ÙˆÙ‚Øª Ø§Ù„Ù…Ø·Ù„ÙˆØ¨ (Ø¯Ù‚Ø§Ø¦Ù‚)</label>
                <input type="number" class="form-control" id="taskTime" placeholder="Ù…Ø«Ø§Ù„: 2" min="1" value="2">
            </div>
            
            <div style="display: flex; gap: 15px; margin-top: 25px;">
                <button class="btn" style="flex: 1; background: var(--admin-danger);" onclick="closeModal('addTaskModal')">
                    Ø¥Ù„ØºØ§Ø¡
                </button>
                <button class="btn" style="flex: 2; background: var(--admin-success);" onclick="addTask()">
                    <i class="fas fa-save"></i> Ø­ÙØ¸ Ø§Ù„Ù…Ù‡Ù…Ø©
                </button>
            </div>
        </div>
    </div>
    
    <!-- ========== Ù†Ø§ÙØ°Ø© Ù…Ø¹Ø§Ù„Ø¬Ø© Ø·Ù„Ø¨ Ø§Ø´ØªØ±Ø§Ùƒ ========== -->
    <div class="modal" id="processRequestModal">
        <div class="modal-content">
            <h3 style="text-align: center; margin-bottom: 25px;">
                <i class="fas fa-cog" style="color: var(--admin-warning);"></i>
                Ù…Ø¹Ø§Ù„Ø¬Ø© Ø·Ù„Ø¨ Ø§Ù„Ø§Ø´ØªØ±Ø§Ùƒ
            </h3>
            
            <div id="requestDetails" class="referral-stats" style="background: rgba(245,158,11,0.1);">
                <!-- Ø³ÙŠØªÙ… Ù…Ù„Ø¤Ù‡Ø§ -->
            </div>
            
            <!-- Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ù…ÙƒØ§ÙØ£Ø© Ø§Ù„Ø¥Ø­Ø§Ù„Ø© -->
            <div id="referralRewardInfo" style="background: rgba(139,92,246,0.1); padding: 15px; border-radius: 10px; margin: 20px 0; border: 1px solid rgba(139,92,246,0.3);">
                <h5 style="color: var(--admin-purple); margin-bottom: 10px; display: flex; align-items: center; gap: 8px;">
                    <i class="fas fa-gift"></i>
                    Ù…ÙƒØ§ÙØ£Ø© Ù†Ø¸Ø§Ù… Ø§Ù„Ø¥Ø­Ø§Ù„Ø©
                </h5>
                <p id="referralRewardText">Ø³ÙŠØªÙ… Ù…Ù†Ø­ 20$ Ù„Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø§Ù„Ø¬Ø¯ÙŠØ¯ Ùˆ 50$ Ù„Ù„Ù…Ø³ÙˆÙ‚ Ø¹Ù†Ø¯ Ù‚Ø¨ÙˆÙ„ Ø§Ù„Ø·Ù„Ø¨</p>
            </div>
            
            <div class="form-group">
                <label>Ù…Ù„Ø§Ø­Ø¸Ø§Øª Ø§Ù„Ù…Ø¹Ø§Ù„Ø¬Ø© (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)</label>
                <textarea class="form-control" id="processNotes" rows="3" placeholder="Ø£Ø¯Ø®Ù„ Ù…Ù„Ø§Ø­Ø¸Ø§Øª..."></textarea>
            </div>
            
            <div style="display: flex; gap: 10px; margin-top: 25px;">
                <button class="btn" style="flex: 1; background: var(--admin-danger);" onclick="rejectRequest()">
                    <i class="fas fa-times"></i> Ø±ÙØ¶
                </button>
                <button class="btn" style="flex: 1; background: var(--admin-warning);" onclick="requestMoreInfo()">
                    <i class="fas fa-info-circle"></i> Ø·Ù„Ø¨ Ù…Ø¹Ù„ÙˆÙ…Ø§Øª
                </button>
                <button class="btn" style="flex: 2; background: var(--admin-success);" onclick="approveRequest()">
                    <i class="fas fa-check"></i> Ù‚Ø¨ÙˆÙ„ ÙˆØªÙØ¹ÙŠÙ„
                </button>
            </div>
        </div>
    </div>
    
    <!-- ========== Ù†Ø§ÙØ°Ø© Ù…Ø¹Ø§Ù„Ø¬Ø© Ø³Ø­Ø¨ ========== -->
    <div class="modal" id="processWithdrawalModal">
        <div class="modal-content">
            <h3 style="text-align: center; margin-bottom: 25px;">
                <i class="fas fa-money-bill-wave" style="color: var(--admin-warning);"></i>
                Ù…Ø¹Ø§Ù„Ø¬Ø© Ø·Ù„Ø¨ Ø§Ù„Ø³Ø­Ø¨
            </h3>
            
            <div id="withdrawalDetails">
                <!-- Ø³ÙŠØªÙ… Ù…Ù„Ø¤Ù‡Ø§ -->
            </div>
            
            <div class="form-group" style="margin-top: 20px;">
                <label>Ø±Ù‚Ù… Ø§Ù„Ù…Ø¹Ø§Ù…Ù„Ø© (Transaction Hash)</label>
                <input type="text" class="form-control" id="withdrawalTxHash" placeholder="Ø£Ø¯Ø®Ù„ Ø±Ù‚Ù… Ø§Ù„Ù…Ø¹Ø§Ù…Ù„Ø© Ù…Ù† Ø§Ù„Ø´Ø¨ÙƒØ©">
            </div>
            
            <div class="form-group">
                <label>Ù…Ù„Ø§Ø­Ø¸Ø§Øª Ø§Ù„Ù…Ø¹Ø§Ù„Ø¬Ø© (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)</label>
                <textarea class="form-control" id="withdrawalNotes" rows="2" placeholder="Ø£Ø¯Ø®Ù„ Ù…Ù„Ø§Ø­Ø¸Ø§Øª..."></textarea>
            </div>
            
            <div style="display: flex; gap: 15px; margin-top: 25px;">
                <button class="btn" style="flex: 1; background: var(--admin-danger);" onclick="rejectWithdrawal()">
                    <i class="fas fa-times"></i> Ø±ÙØ¶
                </button>
                <button class="btn" style="flex: 2; background: var(--admin-success);" onclick="completeWithdrawal()">
                    <i class="fas fa-check"></i> ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø¥Ø±Ø³Ø§Ù„
                </button>
            </div>
        </div>
    </div>
    
    <!-- ========== Ù†Ø§ÙØ°Ø© Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ø¥Ø­Ø§Ù„Ø© ========== -->
    <div class="modal" id="referralSettingsModal">
        <div class="modal-content">
            <h3 style="text-align: center; margin-bottom: 25px;">
                <i class="fas fa-user-friends" style="color: var(--admin-purple);"></i>
                Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ù†Ø¸Ø§Ù… Ø§Ù„Ø¥Ø­Ø§Ù„Ø©
            </h3>
            
            <div class="form-group">
                <label>Ù…ÙƒØ§ÙØ£Ø© ØµØ§Ø­Ø¨ Ø§Ù„ÙƒÙˆØ¯ (Ø§Ù„Ù…Ø­ÙŠÙ„) - $</label>
                <input type="number" class="form-control" id="modalReferrerReward" value="50" min="10" max="500" step="5">
            </div>
            
            <div class="form-group">
                <label>Ù…ÙƒØ§ÙØ£Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø§Ù„Ø¬Ø¯ÙŠØ¯ (Ø§Ù„Ù…Ø­Ø§Ù„) - $</label>
                <input type="number" class="form-control" id="modalRefereeReward" value="20" min="5" max="200" step="5">
            </div>
            
            <div class="form-group">
                <label>ØªÙØ¹ÙŠÙ„ Ù†Ø¸Ø§Ù… Ø§Ù„Ø¥Ø­Ø§Ù„Ø©</label>
                <select class="form-control" id="referralActive">
                    <option value="true">âœ… Ù…ÙØ¹Ù„</option>
                    <option value="false">âŒ Ù…Ø¹Ø·Ù„</option>
                </select>
            </div>
            
            <div style="background: rgba(139,92,246,0.1); padding: 15px; border-radius: 10px; margin: 20px 0;">
                <p style="color: #cbd5e1; font-size: 14px;">
                    <i class="fas fa-info-circle" style="color: var(--admin-purple);"></i>
                    Ù…ÙƒØ§ÙØ¢Øª Ø§Ù„Ø¥Ø­Ø§Ù„Ø© ØªÙØµØ±Ù ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹ Ø¹Ù†Ø¯ Ù‚Ø¨ÙˆÙ„ Ø·Ù„Ø¨ Ø§Ø´ØªØ±Ø§Ùƒ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø§Ù„Ù…Ø­Ø§Ù„.
                </p>
            </div>
            
            <div style="display: flex; gap: 15px; margin-top: 25px;">
                <button class="btn" style="flex: 1; background: var(--admin-danger);" onclick="closeModal('referralSettingsModal')">
                    Ø¥Ù„ØºØ§Ø¡
                </button>
                <button class="btn" style="flex: 2; background: var(--admin-success);" onclick="saveReferralSettings()">
                    <i class="fas fa-save"></i> Ø­ÙØ¸ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª
                </button>
            </div>
        </div>
    </div>
    
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script>
        // ==================== Ù†Ø¸Ø§Ù… Ø§Ù„Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…ØªÙ‚Ø¯Ù… - Ø§Ù„Ù†Ø³Ø®Ø© Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠØ© Ø§Ù„Ù…ØµØ­Ø­Ø© ====================
        
        // ---------- Ø§Ù„Ù…ØªØºÙŠØ±Ø§Øª Ø§Ù„Ø¹Ø§Ù…Ø© ----------
        let adminData = {
            users: [],
            packages: [],
            tasks: [],
            subscriptions: [],
            withdrawals: [],
            transactions: [],
            pendingPackages: [],
            pendingWithdrawals: [],
            referrals: [],
            topMarketers: []
        };

        let currentRequestId = null;
        let currentRequestType = null;
        let currentWithdrawalId = null;
        let currentUserId = null;
        
        let packagesChart = null;
        let revenueChart = null;
        
        let currentPage = 1;
        const usersPerPage = 20;

        // ---------- ØªÙ‡ÙŠØ¦Ø© Ø§Ù„ØµÙØ­Ø© ----------
        function initAdminPanel() {
            console.log('ğŸš€ Ø¨Ø¯Ø¡ ØªØ´ØºÙŠÙ„ Ù„ÙˆØ­Ø© Ø§Ù„Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…ØªÙ‚Ø¯Ù…Ø©...');
            loadAllData();
            updateTime();
            setInterval(updateTime, 1000);
            setInterval(loadAllData, 15000);
            showSection('dashboard');
            
            window.addEventListener('data-updated', function(event) {
                console.log('ğŸ“¡ ØªØ­Ø¯ÙŠØ«:', event.detail.type);
                if (event.detail.type === 'packages') loadPackages();
                if (event.detail.type === 'tasks') loadTasks();
                if (event.detail.type === 'users') loadUsers();
                if (event.detail.type === 'referrals') loadReferrals();
            });
            
            setTimeout(() => {
                loadUsers();
                loadReferrals();
            }, 500);
        }

        // ---------- ØªØ­Ù…ÙŠÙ„ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ----------
        function loadAllData() {
            loadUsers();
            loadPackages();
            loadTasks();
            loadReferrals();
            loadPendingRequests();
            loadSubscriptions();
            loadWithdrawals();
            loadAllTransactions();
            updateDashboardStats();
            updateCharts();
        }

        // ---------- ØªØ­Ø¯ÙŠØ« Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„Ø¯Ø§Ø´Ø¨ÙˆØ±Ø¯ ----------
        function updateDashboardStats() {
            const stats = window.sharedData.getDashboardStats();
            const users = adminData.users;
            const pendingPackages = adminData.pendingPackages;
            const pendingWithdrawals = adminData.pendingWithdrawals;
            
            document.getElementById('totalUsers').textContent = stats.totalUsers;
            document.getElementById('totalDeposits').textContent = (stats.totalDeposits || 0).toFixed(2) + '$';
            document.getElementById('totalReferrals').textContent = stats.totalReferrals || 0;
            document.getElementById('pendingRequests').textContent = (pendingPackages?.length || 0) + (pendingWithdrawals?.length || 0);
            document.getElementById('pendingBreakdown').textContent = `${pendingPackages?.length || 0} Ø§Ø´ØªØ±Ø§Ùƒ / ${pendingWithdrawals?.length || 0} Ø³Ø­Ø¨`;
            
            document.getElementById('activeUsers').textContent = stats.activeUsers || 0;
            document.getElementById('suspendedUsers').textContent = stats.suspendedUsers || 0;
            document.getElementById('bannedUsers').textContent = stats.bannedUsers || 0;
            document.getElementById('activeSubscriptions').textContent = stats.activeSubscriptions || 0;
            document.getElementById('totalWithdrawn').textContent = (stats.totalWithdrawals || 0).toFixed(2) + '$';
            
            const referralStats = calculateReferralStats();
            document.getElementById('totalReferralsCount').textContent = referralStats.totalReferrals;
            document.getElementById('totalReferralEarnings').textContent = (referralStats.totalEarnings || 0).toFixed(2) + '$';
            document.getElementById('pendingReferralRewards').textContent = (referralStats.pendingCommission || 0).toFixed(2) + '$';
            document.getElementById('referralConversion').textContent = (referralStats.conversionRate || 0) + '%';
            
            document.getElementById('usersCount').textContent = stats.totalUsers;
            document.getElementById('pendingCount').textContent = (pendingPackages?.length || 0) + (pendingWithdrawals?.length || 0);
            document.getElementById('referralsCount').textContent = referralStats.totalReferrals;
            document.getElementById('withdrawalsCount').textContent = adminData.withdrawals?.length || 0;
            document.getElementById('subscriptionsCount').textContent = adminData.subscriptions?.length || 0;
            
            updateUserManagementStats();
            updateRecentActivities();
        }

        // ---------- ØªØ­Ø¯ÙŠØ« Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ† ----------
        function updateUserManagementStats() {
            const userStats = window.sharedData.getUserManagementStats();
            
            document.getElementById('userStatsTotal').textContent = userStats.total || 0;
            document.getElementById('userStatsActive').textContent = userStats.active || 0;
            document.getElementById('userStatsWithPackage').textContent = userStats.withPackage || 0;
            document.getElementById('userStatsSuspended').textContent = userStats.suspended || 0;
            document.getElementById('userStatsBanned').textContent = userStats.banned || 0;
            document.getElementById('userStatsBalance').textContent = (userStats.totalBalance || 0).toFixed(2) + '$';
        }

        // ---------- Ø­Ø³Ø§Ø¨ Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„Ø¥Ø­Ø§Ù„Ø© ----------
        function calculateReferralStats() {
            const users = adminData.users || [];
            let totalReferrals = 0;
            let totalEarnings = 0;
            let totalWithReferralCode = 0;
            let pendingCommission = 0;
            let activeReferrals = 0;
            
            users.forEach(user => {
                const userReferrals = users.filter(u => u.referredBy === user.referralCode).length;
                totalReferrals += userReferrals;
                totalEarnings += user.referralEarnings || 0;
                
                const referredUsers = users.filter(u => u.referredBy === user.referralCode);
                referredUsers.forEach(ref => {
                    if (ref.package && ref.package.status === 'Ù†Ø´Ø·' && !ref.referralRewardPaid) {
                        pendingCommission += 50;
                    }
                    if (ref.package && ref.package.status === 'Ù†Ø´Ø·') {
                        activeReferrals++;
                    }
                });
                
                if (user.referredBy) totalWithReferralCode++;
            });
            
            const conversionRate = users.length > 0 ? ((totalWithReferralCode / users.length) * 100).toFixed(1) : 0;
            
            return {
                totalReferrals: totalReferrals,
                totalEarnings: totalEarnings,
                totalWithReferralCode: totalWithReferralCode,
                pendingCommission: pendingCommission,
                activeReferrals: activeReferrals,
                conversionRate: conversionRate
            };
        }

        // ---------- ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ† ----------
        function loadUsers() {
            const users = JSON.parse(localStorage.getItem('elite_users')) || [];
            
            users.forEach(user => {
                if (!user.status) user.status = 'active';
                if (!user.totalEarned) user.totalEarned = 0;
                if (!user.totalWithdrawn) user.totalWithdrawn = 0;
                if (!user.tasksCompleted) user.tasksCompleted = 0;
            });
            
            adminData.users = users;
            displayUsers(users);
            updateDashboardStats();
        }

        // ---------- Ø¹Ø±Ø¶ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ† ----------
        function displayUsers(users) {
            const table = document.getElementById('usersTable');
            
            if (users.length === 0) {
                table.innerHTML = `
                    <tr>
                        <td colspan="9" style="text-align: center; padding: 50px; color: #9ca3b8;">
                            <i class="fas fa-users" style="font-size: 3rem; display: block; margin-bottom: 15px;"></i>
                            <p style="font-size: 18px;">Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ† Ø¨Ø¹Ø¯</p>
                            <button class="btn btn-success" onclick="showAddUserModal()" style="margin-top: 15px;">
                                <i class="fas fa-user-plus"></i> Ø¥Ø¶Ø§ÙØ© Ù…Ø³ØªØ®Ø¯Ù…
                            </button>
                        </td>
                    </tr>
                `;
                return;
            }
            
            let filteredUsers = filterUsersData(users);
            
            const searchTerm = document.getElementById('userSearchInput')?.value.toLowerCase() || '';
            if (searchTerm) {
                filteredUsers = filteredUsers.filter(user => 
                    user.name?.toLowerCase().includes(searchTerm) ||
                    user.email?.toLowerCase().includes(searchTerm) ||
                    user.username?.toLowerCase().includes(searchTerm) ||
                    user.phone?.includes(searchTerm) ||
                    (user.referralCode && user.referralCode.toLowerCase().includes(searchTerm))
                );
            }
            
            const packageFilter = document.getElementById('userPackageFilter')?.value || 'all';
            if (packageFilter !== 'all') {
                filteredUsers = filteredUsers.filter(user => 
                    user.package && user.package.category === packageFilter
                );
            }
            
            const totalPages = Math.ceil(filteredUsers.length / usersPerPage);
            const startIndex = (currentPage - 1) * usersPerPage;
            const endIndex = startIndex + usersPerPage;
            const pageUsers = filteredUsers.slice(startIndex, endIndex);
            
            let html = '';
            pageUsers.forEach((user, index) => {
                const userPackage = user.package ? user.package.name : 'Ù„Ø§ ÙŠÙˆØ¬Ø¯';
                const packageAmount = user.package ? user.package.amount : 0;
                const dailyProfit = user.package ? (user.package.dailyProfit || (packageAmount * 0.025)).toFixed(2) : 0;
                const joinDate = user.joinedDate ? new Date(user.joinedDate).toLocaleDateString('ar-SA') : '-';
                
                const referralCount = adminData.users.filter(u => u.referredBy === user.referralCode).length;
                const activeReferrals = adminData.users.filter(u => 
                    u.referredBy === user.referralCode && u.package && u.package.status === 'Ù†Ø´Ø·'
                ).length;
                const referralEarnings = user.referralEarnings || 0;
                
                const withdrawals = JSON.parse(localStorage.getItem(`user_withdrawals_${user.id}`)) || [];
                const totalWithdrawn = withdrawals
                    .filter(w => w.status === 'Ù…ÙƒØªÙ…Ù„')
                    .reduce((sum, w) => sum + (w.amount || 0), 0);
                
                let statusClass = 'status-active';
                let statusText = 'Ù†Ø´Ø·';
                let statusIcon = 'ğŸŸ¢';
                
                if (user.status === 'suspended') {
                    statusClass = 'status-suspended';
                    statusText = 'Ù…Ø¹Ù„Ù‚';
                    statusIcon = 'ğŸŸ ';
                } else if (user.status === 'banned') {
                    statusClass = 'status-banned';
                    statusText = 'Ù…Ø­Ø¸ÙˆØ±';
                    statusIcon = 'ğŸ”´';
                }
                
                const balanceClass = user.balance >= 1000 ? 'success' : user.balance >= 500 ? 'warning' : '';
                const referralCode = user.referralCode || user.username || user.id.toString();
                
                html += `
                    <tr style="${user.status === 'banned' ? 'opacity: 0.7; background: rgba(220,38,38,0.05);' : ''}">
                        <td>${startIndex + index + 1}</td>
                        <td>
                            <div style="display: flex; align-items: center; gap: 10px;">
                                <div style="width: 40px; height: 40px; background: linear-gradient(45deg, var(--admin-primary), var(--admin-secondary)); border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: bold;">
                                    ${user.name?.charAt(0).toUpperCase() || 'Ù…'}
                                </div>
                                <div>
                                    <strong>${user.name || 'ØºÙŠØ± Ù…Ø¹Ø±ÙˆÙ'}</strong><br>
                                    <small style="color: #9ca3af;">@${user.username || 'Ù„Ø§ ÙŠÙˆØ¬Ø¯'}</small>
                                </div>
                            </div>
                        </td>
                        <td>
                            <div>${user.email || 'Ù„Ø§ ÙŠÙˆØ¬Ø¯'}</div>
                            <small style="color: #9ca3af;">${user.phone || 'Ù„Ø§ ÙŠÙˆØ¬Ø¯'}</small>
                            <div style="margin-top: 5px;">
                                <span class="badge ${user.isAdmin ? 'purple' : ''}" style="background: ${user.isAdmin ? 'var(--admin-purple)' : '#64748b'};">
                                    ${user.isAdmin ? 'ğŸ‘‘ Ù…Ø´Ø±Ù' : 'ğŸ‘¤ Ù…Ø³ØªØ®Ø¯Ù…'}
                                </span>
                            </div>
                        </td>
                        <td>
                            ${user.package ? `
                                <strong style="color: var(--admin-success);">${user.package.name}</strong><br>
                                <small>ğŸ’° ${user.package.amount}$</small><br>
                                <small class="text-info">ğŸ“ˆ ${dailyProfit}$/ÙŠÙˆÙ…</small>
                                ${user.package.purchaseDate ? `<br><small style="color: #9ca3af;">ğŸ“… ${new Date(user.package.purchaseDate).toLocaleDateString('ar-SA')}</small>` : ''}
                            ` : `
                                <span style="color: #9ca3af;">Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ø¨Ø§Ù‚Ø©</span>
                            `}
                            <div style="margin-top: 5px;">
                                <small>âœ… Ù…Ù‡Ø§Ù…: ${user.tasksCompleted || 0}</small>
                            </div>
                        </td>
                        <td>
                            <div><strong>${referralCount}</strong> Ø¥Ø¬Ù…Ø§Ù„ÙŠ</div>
                            <div><small class="text-success">${activeReferrals} Ù†Ø´Ø·</small></div>
                            <div><small class="text-warning">ğŸ’° ${referralEarnings.toFixed(2)}$</small></div>
                            <div><span class="referral-code" style="font-size: 11px; padding: 4px 8px;">${referralCode}</span></div>
                        </td>
                        <td>
                            <div style="font-size: 18px; font-weight: bold; color: var(--admin-${balanceClass});">
                                ${(user.balance || 0).toFixed(2)}$
                            </div>
                            <small style="color: #9ca3af;">Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø£Ø±Ø¨Ø§Ø­: ${(user.totalEarned || 0).toFixed(2)}$</small>
                        </td>
                        <td>
                            <div><strong>${totalWithdrawn.toFixed(2)}$</strong></div>
                            <small style="color: #9ca3af;">${withdrawals.length} Ø·Ù„Ø¨</small>
                        </td>
                        <td>
                            <span class="status-badge ${statusClass}" style="display: flex; align-items: center; gap: 5px;">
                                ${statusIcon} ${statusText}
                            </span>
                            ${user.statusReason ? `
                                <small style="color: #9ca3af; display: block; margin-top: 5px;" title="${user.statusReason}">
                                    <i class="fas fa-info-circle"></i> ${user.statusReason.substring(0, 20)}...
                                </small>
                            ` : ''}
                        </td>
                        <td>
                            <div style="display: flex; flex-direction: column; gap: 8px;">
                                <div style="display: flex; gap: 5px; flex-wrap: wrap;">
                                    <button class="btn btn-sm btn-info" onclick="viewUserDetails(${user.id})" title="Ø¹Ø±Ø¶ Ø§Ù„ØªÙØ§ØµÙŠÙ„">
                                        <i class="fas fa-eye"></i>
                                    </button>
                                    <button class="btn btn-sm btn-warning" onclick="showUserStatusModal(${user.id})" title="ØªØºÙŠÙŠØ± Ø§Ù„Ø­Ø§Ù„Ø©">
                                        <i class="fas fa-shield-alt"></i>
                                    </button>
                                    <button class="btn btn-sm btn-purple" onclick="viewUserReferrals(${user.id})" title="Ø¹Ø±Ø¶ Ø§Ù„Ø¥Ø­Ø§Ù„Ø§Øª">
                                        <i class="fas fa-user-friends"></i>
                                    </button>
                                </div>
                                <div style="display: flex; gap: 5px;">
                                    <button class="btn btn-sm btn-success" onclick="addUserBalance(${user.id})" title="Ø¥Ø¶Ø§ÙØ© Ø±ØµÙŠØ¯">
                                        <i class="fas fa-plus-circle"></i>
                                    </button>
                                    <button class="btn btn-sm btn-primary" onclick="editUser(${user.id})" title="ØªØ¹Ø¯ÙŠÙ„">
                                        <i class="fas fa-edit"></i>
                                    </button>
                                    <button class="btn btn-sm btn-danger" onclick="deleteUser(${user.id})" title="Ø­Ø°Ù">
                                        <i class="fas fa-trash"></i>
                                    </button>
                                </div>
                            </div>
                        </td>
                    </tr>
                `;
            });
            
            table.innerHTML = html;
            displayPagination(totalPages);
        }

        // ---------- ÙÙ„ØªØ±Ø© Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ† ----------
        function filterUsersData(users) {
            const statusFilter = document.getElementById('userStatusFilter')?.value || 'all';
            let filtered = [...users];
            
            switch(statusFilter) {
                case 'active':
                    filtered = filtered.filter(u => u.status === 'active' || !u.status);
                    break;
                case 'suspended':
                    filtered = filtered.filter(u => u.status === 'suspended');
                    break;
                case 'banned':
                    filtered = filtered.filter(u => u.status === 'banned');
                    break;
                case 'with-package':
                    filtered = filtered.filter(u => u.package);
                    break;
                case 'without-package':
                    filtered = filtered.filter(u => !u.package);
                    break;
                case 'with-referrals':
                    filtered = filtered.filter(u => 
                        adminData.users.some(ref => ref.referredBy === u.referralCode)
                    );
                    break;
                case 'with-referral-code':
                    filtered = filtered.filter(u => u.referredBy);
                    break;
            }
            
            return filtered;
        }

        // ---------- Ø¹Ø±Ø¶ Ø£Ø²Ø±Ø§Ø± Ø§Ù„ØªØµÙØ­ ----------
        function displayPagination(totalPages) {
            const paginationDiv = document.getElementById('usersPagination');
            if (!paginationDiv) return;
            if (totalPages <= 1) {
                paginationDiv.innerHTML = '';
                return;
            }
            
            let html = '';
            html += `<button class="btn btn-sm" onclick="changePage(${currentPage - 1})" ${currentPage === 1 ? 'disabled' : ''}>
                        <i class="fas fa-chevron-right"></i> Ø§Ù„Ø³Ø§Ø¨Ù‚
                     </button>`;
            
            for (let i = 1; i <= Math.min(totalPages, 5); i++) {
                html += `<button class="btn btn-sm ${i === currentPage ? 'btn-primary' : ''}" onclick="changePage(${i})">
                            ${i}
                         </button>`;
            }
            
            if (totalPages > 5) {
                html += `<span style="margin: 0 5px;">...</span>`;
                html += `<button class="btn btn-sm" onclick="changePage(${totalPages})">${totalPages}</button>`;
            }
            
            html += `<button class="btn btn-sm" onclick="changePage(${currentPage + 1})" ${currentPage === totalPages ? 'disabled' : ''}>
                        Ø§Ù„ØªØ§Ù„ÙŠ <i class="fas fa-chevron-left"></i>
                     </button>`;
            
            paginationDiv.innerHTML = html;
        }

        // ---------- ØªØºÙŠÙŠØ± Ø§Ù„ØµÙØ­Ø© ----------
        function changePage(page) {
            currentPage = page;
            loadUsers();
        }

        // ---------- ÙÙ„ØªØ±Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ† ----------
        function filterUsers() {
            currentPage = 1;
            loadUsers();
        }

        // ---------- Ø§Ù„Ø¨Ø­Ø« Ø¹Ù† Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ† ----------
        function searchUsers() {
            currentPage = 1;
            loadUsers();
        }

        // ---------- Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† ÙÙ„Ø§ØªØ± Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ† ----------
        function resetUserFilters() {
            document.getElementById('userSearchInput').value = '';
            document.getElementById('userStatusFilter').value = 'all';
            document.getElementById('userPackageFilter').value = 'all';
            currentPage = 1;
            loadUsers();
            showAdminNotification('ØªÙ… Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ø§Ù„ÙÙ„Ø§ØªØ±', 'success');
        }

        // ---------- ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ† ----------
        function refreshUsers() {
            loadUsers();
            showAdminNotification('ØªÙ… ØªØ­Ø¯ÙŠØ« Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†', 'success');
        }

        // ---------- Ø¹Ø±Ø¶ Ù†Ø§ÙØ°Ø© ØªØºÙŠÙŠØ± Ø­Ø§Ù„Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… ----------
        function showUserStatusModal(userId) {
            currentUserId = userId;
            const user = adminData.users.find(u => u.id === userId);
            if (!user) return;
            
            const statusInfo = document.getElementById('statusUserInfo');
            statusInfo.innerHTML = `
                <div style="display: flex; align-items: center; gap: 15px;">
                    <div style="width: 50px; height: 50px; background: linear-gradient(45deg, var(--admin-primary), var(--admin-secondary)); border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 20px; font-weight: bold;">
                        ${user.name?.charAt(0).toUpperCase() || 'Ù…'}
                    </div>
                    <div>
                        <h4 style="margin-bottom: 5px;">${user.name || 'ØºÙŠØ± Ù…Ø¹Ø±ÙˆÙ'}</h4>
                        <p style="color: #9ca3af; margin: 0;">${user.email || 'Ù„Ø§ ÙŠÙˆØ¬Ø¯'}</p>
                        <p style="margin-top: 5px;">
                            Ø§Ù„Ø­Ø§Ù„ÙŠØ©: 
                            <span class="status-badge ${user.status === 'suspended' ? 'status-suspended' : user.status === 'banned' ? 'status-banned' : 'status-active'}">
                                ${user.status === 'suspended' ? 'ğŸŸ  Ù…Ø¹Ù„Ù‚' : user.status === 'banned' ? 'ğŸ”´ Ù…Ø­Ø¸ÙˆØ±' : 'ğŸŸ¢ Ù†Ø´Ø·'}
                            </span>
                        </p>
                    </div>
                </div>
            `;
            
            document.getElementById('newUserStatus').value = user.status || 'active';
            document.getElementById('statusReason').value = user.statusReason || '';
            document.getElementById('userStatusModal').classList.add('active');
        }

        // ---------- ØªØ£ÙƒÙŠØ¯ ØªØ­Ø¯ÙŠØ« Ø­Ø§Ù„Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… ----------
        function confirmUpdateUserStatus() {
            const newStatus = document.getElementById('newUserStatus').value;
            const reason = document.getElementById('statusReason').value.trim();
            
            if (!reason && (newStatus === 'suspended' || newStatus === 'banned')) {
                if (!confirm('Ù„Ù… ØªÙ‚Ù… Ø¨Ø¥Ø¯Ø®Ø§Ù„ Ø³Ø¨Ø¨ Ø§Ù„ØªØºÙŠÙŠØ±. Ù‡Ù„ ØªØ±ÙŠØ¯ Ø§Ù„Ù…ØªØ§Ø¨Ø¹Ø©ØŸ')) {
                    return;
                }
            }
            
            const success = window.sharedData.updateUserStatus(currentUserId, newStatus, reason);
            
            if (success) {
                showAdminNotification(`âœ… ØªÙ… ØªØ­Ø¯ÙŠØ« Ø­Ø§Ù„Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø¥Ù„Ù‰ ${getStatusText(newStatus)}`, 'success');
                closeModal('userStatusModal');
                loadUsers();
            } else {
                showAdminNotification('âŒ ÙØ´Ù„ ØªØ­Ø¯ÙŠØ« Ø­Ø§Ù„Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…', 'error');
            }
        }

        // ---------- Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ù†Øµ Ø§Ù„Ø­Ø§Ù„Ø© ----------
        function getStatusText(status) {
            switch(status) {
                case 'active': return 'Ù†Ø´Ø·';
                case 'suspended': return 'Ù…Ø¹Ù„Ù‚';
                case 'banned': return 'Ù…Ø­Ø¸ÙˆØ±';
                default: return status;
            }
        }

// ---------- Ø¹Ø±Ø¶ ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… ----------
        function viewUserDetails(userId) {
            const userDetails = window.sharedData.getUserDetails(userId);
            if (!userDetails) {
                showAdminNotification('Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯', 'error');
                return;
            }
            
            const withdrawals = JSON.parse(localStorage.getItem(`user_withdrawals_${userId}`)) || [];
            const transactions = JSON.parse(localStorage.getItem(`user_transactions_${userId}`)) || [];
            const recentTransactions = transactions.slice(0, 5);
            
            const content = document.getElementById('userDetailsContent');
            content.innerHTML = `
                <div class="user-detail-card">
                    <div class="user-detail-header">
                        <div style="display: flex; align-items: center; gap: 20px;">
                            <div class="user-avatar-large">
                                ${userDetails.name?.charAt(0).toUpperCase() || 'Ù…'}
                            </div>
                            <div>
                                <h2 style="margin-bottom: 5px;">${userDetails.name || 'ØºÙŠØ± Ù…Ø¹Ø±ÙˆÙ'}</h2>
                                <p style="color: #9ca3af; margin-bottom: 5px;">@${userDetails.username || 'Ù„Ø§ ÙŠÙˆØ¬Ø¯'}</p>
                                <p style="margin-bottom: 5px;">
                                    <span class="status-badge ${userDetails.status === 'suspended' ? 'status-suspended' : userDetails.status === 'banned' ? 'status-banned' : 'status-active'}">
                                        ${userDetails.status === 'suspended' ? 'ğŸŸ  Ù…Ø¹Ù„Ù‚' : userDetails.status === 'banned' ? 'ğŸ”´ Ù…Ø­Ø¸ÙˆØ±' : 'ğŸŸ¢ Ù†Ø´Ø·'}
                                    </span>
                                    ${userDetails.isAdmin ? '<span class="badge purple" style="margin-right: 10px;">ğŸ‘‘ Ù…Ø´Ø±Ù</span>' : ''}
                                </p>
                            </div>
                        </div>
                        <div>
                            <button class="btn btn-sm btn-warning" onclick="showUserStatusModal(${userDetails.id})">
                                <i class="fas fa-shield-alt"></i> ØªØºÙŠÙŠØ± Ø§Ù„Ø­Ø§Ù„Ø©
                            </button>
                        </div>
                    </div>
                    
                    <div class="info-grid">
                        <div class="info-item">
                            <div class="info-label">ğŸ“§ Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ</div>
                            <div class="info-value">${userDetails.email || 'Ù„Ø§ ÙŠÙˆØ¬Ø¯'}</div>
                        </div>
                        <div class="info-item">
                            <div class="info-label">ğŸ“± Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ</div>
                            <div class="info-value">${userDetails.phone || 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯'}</div>
                        </div>
                        <div class="info-item">
                            <div class="info-label">ğŸ’° Ø§Ù„Ø±ØµÙŠØ¯ Ø§Ù„Ø­Ø§Ù„ÙŠ</div>
                            <div class="info-value success">${(userDetails.balance || 0).toFixed(2)}$</div>
                        </div>
                        <div class="info-item">
                            <div class="info-label">ğŸ“… ØªØ§Ø±ÙŠØ® Ø§Ù„ØªØ³Ø¬ÙŠÙ„</div>
                            <div class="info-value">${userDetails.joinedDate ? new Date(userDetails.joinedDate).toLocaleDateString('ar-SA') : 'ØºÙŠØ± Ù…Ø¹Ø±ÙˆÙ'}</div>
                        </div>
                        <div class="info-item">
                            <div class="info-label">ğŸ’ Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø£Ø±Ø¨Ø§Ø­</div>
                            <div class="info-value">${(userDetails.totalEarned || 0).toFixed(2)}$</div>
                        </div>
                        <div class="info-item">
                            <div class="info-label">ğŸ’³ Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù…Ø³Ø­ÙˆØ¨Ø§Øª</div>
                            <div class="info-value">${(userDetails.totalWithdrawn || 0).toFixed(2)}$</div>
                        </div>
                        <div class="info-item">
                            <div class="info-label">ğŸ“Š Ø£Ø±Ø¨Ø§Ø­ Ø§Ù„ÙŠÙˆÙ…</div>
                            <div class="info-value warning">${(userDetails.todayEarnings || 0).toFixed(2)}$</div>
                        </div>
                        <div class="info-item">
                            <div class="info-label">âœ… Ø§Ù„Ù…Ù‡Ø§Ù… Ø§Ù„Ù…ÙƒØªÙ…Ù„Ø©</div>
                            <div class="info-value">${userDetails.tasksCompleted || 0}</div>
                        </div>
                    </div>
                    
                    <div style="margin-top: 20px;">
                        <h4 style="color: var(--admin-secondary); margin-bottom: 15px;">
                            <i class="fas fa-crown"></i> Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø¨Ø§Ù‚Ø©
                        </h4>
                        ${userDetails.package ? `
                            <div style="background: rgba(16,185,129,0.1); padding: 15px; border-radius: 10px;">
                                <div style="display: grid; grid-template-columns: repeat(4, 1fr); gap: 15px;">
                                    <div>
                                        <div class="info-label">Ø§Ø³Ù… Ø§Ù„Ø¨Ø§Ù‚Ø©</div>
                                        <div class="info-value">${userDetails.package.name}</div>
                                    </div>
                                    <div>
                                        <div class="info-label">Ø§Ù„Ø§Ø³ØªØ«Ù…Ø§Ø±</div>
                                        <div class="info-value">${userDetails.package.amount}$</div>
                                    </div>
                                    <div>
                                        <div class="info-label">Ø§Ù„Ø±Ø¨Ø­ Ø§Ù„ÙŠÙˆÙ…ÙŠ</div>
                                        <div class="info-value success">${(userDetails.package.dailyProfit || userDetails.package.amount * 0.025).toFixed(2)}$</div>
                                    </div>
                                    <div>
                                        <div class="info-label">ØªØ§Ø±ÙŠØ® Ø§Ù„Ø´Ø±Ø§Ø¡</div>
                                        <div class="info-value">${userDetails.package.purchaseDate ? new Date(userDetails.package.purchaseDate).toLocaleDateString('ar-SA') : 'ØºÙŠØ± Ù…Ø¹Ø±ÙˆÙ'}</div>
                                    </div>
                                </div>
                            </div>
                        ` : `
                            <p style="color: #9ca3af; text-align: center; padding: 20px;">
                                Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ø¨Ø§Ù‚Ø© Ù†Ø´Ø·Ø©
                            </p>
                        `}
                    </div>
                    
                    <div style="margin-top: 20px;">
                        <h4 style="color: var(--admin-purple); margin-bottom: 15px;">
                            <i class="fas fa-user-friends"></i> Ù†Ø¸Ø§Ù… Ø§Ù„Ø¥Ø­Ø§Ù„Ø©
                        </h4>
                        <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 15px;">
                            <div style="background: rgba(139,92,246,0.1); padding: 15px; border-radius: 10px;">
                                <div class="info-label">ÙƒÙˆØ¯ Ø§Ù„Ø¥Ø­Ø§Ù„Ø©</div>
                                <div class="referral-code" style="margin-top: 5px;">${userDetails.referralCode || userDetails.username || 'Ù„Ø§ ÙŠÙˆØ¬Ø¯'}</div>
                            </div>
                            <div style="background: rgba(139,92,246,0.1); padding: 15px; border-radius: 10px;">
                                <div class="info-label">Ø¹Ø¯Ø¯ Ø§Ù„Ø¥Ø­Ø§Ù„Ø§Øª</div>
                                <div class="info-value">${userDetails.referralStats?.referredCount || 0}</div>
                                <small>${userDetails.referralStats?.activeReferrals || 0} Ù†Ø´Ø·</small>
                            </div>
                            <div style="background: rgba(139,92,246,0.1); padding: 15px; border-radius: 10px;">
                                <div class="info-label">Ø£Ø±Ø¨Ø§Ø­ Ø§Ù„Ø¥Ø­Ø§Ù„Ø©</div>
                                <div class="info-value success">${(userDetails.referralEarnings || 0).toFixed(2)}$</div>
                            </div>
                        </div>
                    </div>
                    
                    <div style="margin-top: 20px;">
                        <h4 style="color: var(--admin-info); margin-bottom: 15px;">
                            <i class="fas fa-history"></i> Ø¢Ø®Ø± Ø§Ù„Ù…Ø¹Ø§Ù…Ù„Ø§Øª
                        </h4>
                        <div style="max-height: 200px; overflow-y: auto;">
                            ${recentTransactions.length > 0 ? recentTransactions.map(t => `
                                <div style="display: flex; justify-content: space-between; align-items: center; padding: 10px; background: rgba(255,255,255,0.03); margin-bottom: 8px; border-radius: 8px;">
                                    <div>
                                        <strong>${t.description || t.type}</strong><br>
                                        <small style="color: #9ca3af;">${t.date || ''}</small>
                                    </div>
                                    <span style="color: ${t.type === 'Ø³Ø­Ø¨' ? 'var(--admin-danger)' : t.type === 'Ø§Ø´ØªØ±Ø§Ùƒ' ? 'var(--admin-warning)' : 'var(--admin-success)'}; font-weight: bold;">
                                        ${t.type === 'Ø³Ø­Ø¨' ? '-' : '+'}${(t.amount || 0).toFixed(2)}$
                                    </span>
                                </div>
                            `).join('') : `
                                <p style="color: #9ca3af; text-align: center; padding: 20px;">
                                    Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…Ø¹Ø§Ù…Ù„Ø§Øª
                                </p>
                            `}
                        </div>
                    </div>
                </div>
            `;
            
            document.getElementById('userDetailsModal').classList.add('active');
        }

        // ---------- Ø¥Ø¶Ø§ÙØ© Ø±ØµÙŠØ¯ Ù„Ù„Ù…Ø³ØªØ®Ø¯Ù… ----------
        function addUserBalance(userId) {
            const user = adminData.users.find(u => u.id === userId);
            if (!user) return;
            
            const amount = prompt(`Ø£Ø¯Ø®Ù„ Ø§Ù„Ù…Ø¨Ù„Øº Ø§Ù„Ù…Ø±Ø§Ø¯ Ø¥Ø¶Ø§ÙØªÙ‡ Ù„Ø±ØµÙŠØ¯ ${user.name || 'Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…'}:`, '10');
            if (!amount) return;
            
            const numAmount = parseFloat(amount);
            if (isNaN(numAmount) || numAmount <= 0) {
                showAdminNotification('Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø¥Ø¯Ø®Ø§Ù„ Ù…Ø¨Ù„Øº ØµØ­ÙŠØ­', 'error');
                return;
            }
            
            const success = window.sharedData.addUserBalance(userId, numAmount, `Ø¥Ø¶Ø§ÙØ© Ø±ØµÙŠØ¯ Ø¨ÙˆØ§Ø³Ø·Ø© Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©`);
            
            if (success) {
                showAdminNotification(`âœ… ØªÙ… Ø¥Ø¶Ø§ÙØ© ${numAmount.toFixed(2)}$ Ù„Ø±ØµÙŠØ¯ ${user.name || 'Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…'}`, 'success');
                loadUsers();
            } else {
                showAdminNotification('âŒ ÙØ´Ù„ Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø±ØµÙŠØ¯', 'error');
            }
        }

        // ---------- Ø¹Ø±Ø¶ Ø¥Ø­Ø§Ù„Ø§Øª Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… ----------
        function viewUserReferrals(userId) {
            const user = adminData.users.find(u => u.id === userId);
            if (!user) return;
            
            const referrals = adminData.users.filter(u => u.referredBy === user.referralCode);
            
            let html = `
                <div style="padding: 20px;">
                    <h3 style="margin-bottom: 20px; color: var(--admin-purple);">
                        <i class="fas fa-user-friends"></i> Ø¥Ø­Ø§Ù„Ø§Øª ${user.name || 'Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…'}
                    </h3>
                    <p style="margin-bottom: 15px;">
                        <span class="referral-code">${user.referralCode || user.username || 'Ù„Ø§ ÙŠÙˆØ¬Ø¯'}</span>
                    </p>
            `;
            
            if (referrals.length > 0) {
                html += `
                    <table style="width: 100%;">
                        <thead>
                            <tr>
                                <th>#</th>
                                <th>Ø§Ù„Ø§Ø³Ù…</th>
                                <th>Ø§Ù„Ø¨Ø±ÙŠØ¯</th>
                                <th>Ø§Ù„Ø¨Ø§Ù‚Ø©</th>
                                <th>ØªØ§Ø±ÙŠØ® Ø§Ù„ØªØ³Ø¬ÙŠÙ„</th>
                                <th>Ø§Ù„Ù…ÙƒØ§ÙØ£Ø©</th>
                                <th>Ø§Ù„Ø­Ø§Ù„Ø©</th>
                            </tr>
                        </thead>
                        <tbody>
                `;
                
                referrals.forEach((ref, index) => {
                    html += `
                        <tr>
                            <td>${index + 1}</td>
                            <td>${ref.name || 'ØºÙŠØ± Ù…Ø¹Ø±ÙˆÙ'}</td>
                            <td>${ref.email || 'Ù„Ø§ ÙŠÙˆØ¬Ø¯'}</td>
                            <td>${ref.package ? ref.package.name : 'Ù„Ø§ ÙŠÙˆØ¬Ø¯'}</td>
                            <td>${ref.joinedDate ? new Date(ref.joinedDate).toLocaleDateString('ar-SA') : '-'}</td>
                            <td>${ref.referralRewardPaid ? 'âœ… ØªÙ… ØµØ±ÙÙ‡Ø§' : 'â³ Ø¨Ø§Ù†ØªØ¸Ø§Ø± Ø§Ù„Ø¨Ø§Ù‚Ø©'}</td>
                            <td>
                                <span class="status-badge ${ref.package ? 'status-active' : 'status-pending'}">
                                    ${ref.package ? 'Ù†Ø´Ø·' : 'ØºÙŠØ± Ù†Ø´Ø·'}
                                </span>
                            </td>
                        </tr>
                    `;
                });
                
                html += `</tbody></table>`;
            } else {
                html += `<p style="color: #9ca3af; text-align: center; padding: 30px;">Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¥Ø­Ø§Ù„Ø§Øª Ù„Ù‡Ø°Ø§ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…</p>`;
            }
            
            html += `</div>`;
            
            const modal = document.createElement('div');
            modal.className = 'modal active';
            modal.innerHTML = `
                <div class="modal-content" style="max-width: 800px;">
                    <div style="display: flex; justify-content: space-between; margin-bottom: 20px;">
                        <h3>Ø¥Ø­Ø§Ù„Ø§Øª Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…</h3>
                        <button class="btn btn-sm" style="background: var(--admin-danger);" onclick="this.closest('.modal').remove()">
                            <i class="fas fa-times"></i>
                        </button>
                    </div>
                    ${html}
                </div>
            `;
            document.body.appendChild(modal);
        }

        // ---------- Ø­Ø°Ù Ù…Ø³ØªØ®Ø¯Ù… ----------
        function deleteUser(userId) {
            if (!confirm('âš ï¸ Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø­Ø°Ù Ù‡Ø°Ø§ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ØŸ Ù„Ø§ ÙŠÙ…ÙƒÙ† Ø§Ù„ØªØ±Ø§Ø¬Ø¹ Ø¹Ù† Ù‡Ø°Ø§ Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡.')) return;
            
            const user = adminData.users.find(u => u.id === userId);
            if (!user) return;
            
            const initialLength = adminData.users.length;
            adminData.users = adminData.users.filter(u => u.id !== userId);
            
            if (adminData.users.length < initialLength) {
                localStorage.setItem('elite_users', JSON.stringify(adminData.users));
                showAdminNotification(`âœ… ØªÙ… Ø­Ø°Ù Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… ${user.name || 'Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…'}`, 'success');
                loadUsers();
            }
        }

        // ---------- ØªØ¹Ø¯ÙŠÙ„ Ù…Ø³ØªØ®Ø¯Ù… ----------
        function editUser(userId) {
            const user = adminData.users.find(u => u.id === userId);
            if (!user) return;
            
            document.getElementById('userFullName').value = user.name || '';
            document.getElementById('userUsername').value = user.username || '';
            document.getElementById('userEmail').value = user.email || '';
            document.getElementById('userPhone').value = user.phone || '';
            document.getElementById('userPassword').value = user.password || '';
            document.getElementById('userReferralCode').value = user.referredBy || '';
            document.getElementById('userBalance').value = user.balance || 0;
            document.getElementById('userType').value = user.isAdmin ? 'admin' : 'user';
            document.getElementById('userStatus').value = user.status || 'active';
            
            adminData.users = adminData.users.filter(u => u.id !== userId);
            
            showAdminNotification('ÙŠÙ…ÙƒÙ†Ùƒ ØªØ¹Ø¯ÙŠÙ„ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø«Ù… Ø§Ù„Ø­ÙØ¸', 'info');
            showAddUserModal();
        }

        // ---------- Ø¥Ø¶Ø§ÙØ© Ù…Ø³ØªØ®Ø¯Ù… ----------
        function addUser() {
            const fullName = document.getElementById('userFullName').value.trim();
            const username = document.getElementById('userUsername').value.trim();
            const email = document.getElementById('userEmail').value.trim();
            const phone = document.getElementById('userPhone').value.trim();
            const password = document.getElementById('userPassword').value;
            const referralCode = document.getElementById('userReferralCode').value.trim();
            const balance = parseFloat(document.getElementById('userBalance').value) || 0;
            const userType = document.getElementById('userType').value;
            const userStatus = document.getElementById('userStatus').value;
            
            if (!fullName || !username || !email || !phone || !password) {
                showAdminNotification('ÙŠØ±Ø¬Ù‰ Ù…Ù„Ø¡ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ„ Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©', 'error');
                return;
            }
            
            if (username.includes(' ')) {
                showAdminNotification('Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… ÙŠØ¬Ø¨ Ø£Ù„Ø§ ÙŠØ­ØªÙˆÙŠ Ø¹Ù„Ù‰ Ù…Ø³Ø§ÙØ§Øª', 'error');
                return;
            }
            
            const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
            if (!emailRegex.test(email)) {
                showAdminNotification('Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ ØºÙŠØ± ØµØ§Ù„Ø­', 'error');
                return;
            }
            
            const phoneRegex = /^[0-9]{10,}$/;
            if (!phoneRegex.test(phone.replace(/\D/g, ''))) {
                showAdminNotification('Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ ØºÙŠØ± ØµØ§Ù„Ø­ (ÙŠØ¬Ø¨ Ø£Ù† ÙŠÙƒÙˆÙ† 10 Ø£Ø±Ù‚Ø§Ù… Ø¹Ù„Ù‰ Ø§Ù„Ø£Ù‚Ù„)', 'error');
                return;
            }
            
            if (password.length < 6) {
                showAdminNotification('ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± ÙŠØ¬Ø¨ Ø£Ù† ØªÙƒÙˆÙ† 6 Ø£Ø­Ø±Ù Ø¹Ù„Ù‰ Ø§Ù„Ø£Ù‚Ù„', 'error');
                return;
            }
            
            const userExists = adminData.users.some(u => u.username === username || u.email === email);
            if (userExists) {
                showAdminNotification('Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø£Ùˆ Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ Ù…ÙˆØ¬ÙˆØ¯ Ù…Ø³Ø¨Ù‚Ø§Ù‹', 'error');
                return;
            }
            
            const newUser = {
                id: Date.now(),
                name: fullName,
                username: username,
                email: email,
                phone: phone,
                password: password,
                referredBy: referralCode || null,
                referralCode: null,
                balance: balance,
                package: null,
                pendingPackage: null,
                walletAddress: '',
                walletNetwork: 'TRC20',
                tasksCompleted: 0,
                totalEarned: 0,
                totalWithdrawn: 0,
                referralCount: 0,
                referralEarnings: 0,
                referralRewardPaid: false,
                joinedDate: new Date().toISOString(),
                lastLogin: new Date().toISOString(),
                isAdmin: userType === 'admin',
                status: userStatus
            };
            
            adminData.users.push(newUser);
            localStorage.setItem('elite_users', JSON.stringify(adminData.users));
            
            showAdminNotification(`âœ… ØªÙ… Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… "${fullName}" Ø¨Ù†Ø¬Ø§Ø­`, 'success');
            closeModal('addUserModal');
            loadUsers();
            
            document.getElementById('userFullName').value = '';
            document.getElementById('userUsername').value = '';
            document.getElementById('userEmail').value = '';
            document.getElementById('userPhone').value = '';
            document.getElementById('userPassword').value = '';
            document.getElementById('userReferralCode').value = '';
            document.getElementById('userBalance').value = '0';
        }

        // ---------- ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨Ø§Ù‚Ø§Øª ----------
        function loadPackages() {
            const packages = window.sharedData.getAllPackages();
            adminData.packages = packages;
            
            displayPackages(packages);
            document.getElementById('packagesCount').textContent = packages.length;
            document.getElementById('activePackages').textContent = packages.length;
        }

        // ---------- Ø¹Ø±Ø¶ Ø§Ù„Ø¨Ø§Ù‚Ø§Øª ----------
        function displayPackages(packages) {
            const table = document.getElementById('packagesTable');
            
            if (packages.length === 0) {
                table.innerHTML = `
                    <tr>
                        <td colspan="9" style="text-align: center; padding: 40px;">
                            <i class="fas fa-box-open" style="font-size: 2rem; margin-bottom: 15px;"></i>
                            <p>Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¨Ø§Ù‚Ø§Øª</p>
                        </td>
                    </tr>
                `;
                return;
            }
            
            let html = '';
            packages.forEach(pkg => {
                const usersCount = adminData.users.filter(u => 
                    u.package && u.package.id === pkg.id
                ).length;
                
                const dailyProfit = (pkg.price * (pkg.profit || 2.5) / 100).toFixed(2);
                
                html += `
                    <tr>
                        <td><strong>${pkg.name}</strong></td>
                        <td>${pkg.price}$</td>
                        <td>${pkg.profit || 2.5}% (${dailyProfit}$)</td>
                        <td>
                            <span class="badge ${pkg.category === 'vip' ? 'warning' : pkg.category === 'premium' ? 'purple' : ''}">
                                ${pkg.category === 'vip' ? 'ğŸ’ VIP' : pkg.category === 'premium' ? 'ğŸ¥‡ Ù…Ù…ÙŠØ²Ø©' : 'ğŸ¥ˆ Ø¹Ø§Ø¯ÙŠØ©'}
                            </span>
                        </td>
                        <td>${pkg.tasks || 5}</td>
                        <td>${pkg.duration || 30} ÙŠÙˆÙ…</td>
                        <td>${usersCount}</td>
                        <td><span class="status-badge status-active">Ù†Ø´Ø·</span></td>
                        <td>
                            <button class="btn btn-sm btn-warning" onclick="editPackage(${pkg.id})">
                                <i class="fas fa-edit"></i>
                            </button>
                            <button class="btn btn-sm btn-danger" onclick="deletePackage(${pkg.id})">
                                <i class="fas fa-trash"></i>
                            </button>
                        </td>
                    </tr>
                `;
            });
            
            table.innerHTML = html;
        }

        // ---------- Ø¥Ø¶Ø§ÙØ© Ø¨Ø§Ù‚Ø© ----------
        function addPackage() {
            const name = document.getElementById('packageName').value.trim();
            const price = parseFloat(document.getElementById('packagePrice').value);
            const profit = parseFloat(document.getElementById('packageProfit').value);
            const category = document.getElementById('packageCategory').value;
            const tasks = parseInt(document.getElementById('packageTasks').value);
            const duration = parseInt(document.getElementById('packageDuration').value);
            const description = document.getElementById('packageDescription').value.trim();
            
            if (!name || !price || !profit || !category || !tasks || !duration) {
                showAdminNotification('ÙŠØ±Ø¬Ù‰ Ù…Ù„Ø¡ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ„ Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©', 'error');
                return;
            }
            
            const newPackage = window.sharedData.addPackage({
                name: name,
                price: price,
                profit: profit,
                category: category,
                tasks: tasks,
                duration: duration,
                description: description
            });
            
            showAdminNotification(`âœ… ØªÙ… Ø¥Ø¶Ø§ÙØ© Ø¨Ø§Ù‚Ø© "${name}" Ø¨Ù†Ø¬Ø§Ø­`, 'success');
            closeModal('addPackageModal');
            loadPackages();
            
            document.getElementById('packageName').value = '';
            document.getElementById('packagePrice').value = '';
            document.getElementById('packageProfit').value = '';
            document.getElementById('packageCategory').value = '';
            document.getElementById('packageTasks').value = '';
            document.getElementById('packageDuration').value = '';
            document.getElementById('packageDescription').value = '';
        }

        // ---------- Ø­Ø°Ù Ø¨Ø§Ù‚Ø© ----------
        function deletePackage(packageId) {
            if (!confirm('Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø­Ø°Ù Ù‡Ø°Ù‡ Ø§Ù„Ø¨Ø§Ù‚Ø©ØŸ')) return;
            
            const success = window.sharedData.deletePackage(packageId);
            
            if (success) {
                showAdminNotification('âœ… ØªÙ… Ø­Ø°Ù Ø§Ù„Ø¨Ø§Ù‚Ø© Ø¨Ù†Ø¬Ø§Ø­', 'success');
                loadPackages();
            }
        }

        // ---------- ØªØ¹Ø¯ÙŠÙ„ Ø¨Ø§Ù‚Ø© ----------
        function editPackage(packageId) {
            const pkg = adminData.packages.find(p => p.id === packageId);
            if (!pkg) return;
            
            document.getElementById('packageName').value = pkg.name;
            document.getElementById('packagePrice').value = pkg.price;
            document.getElementById('packageProfit').value = pkg.profit || 2.5;
            document.getElementById('packageCategory').value = pkg.category || 'standard';
            document.getElementById('packageTasks').value = pkg.tasks || 5;
            document.getElementById('packageDuration').value = pkg.duration || 30;
            document.getElementById('packageDescription').value = pkg.description || '';
            
            window.sharedData.deletePackage(packageId);
            
            showAdminNotification('ÙŠÙ…ÙƒÙ†Ùƒ ØªØ¹Ø¯ÙŠÙ„ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¨Ø§Ù‚Ø© Ø«Ù… Ø§Ù„Ø­ÙØ¸', 'info');
            showAddPackageModal();
        }

        // ---------- ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ù‡Ø§Ù… ----------
        function loadTasks() {
            const tasks = window.sharedData.getAllTasks();
            adminData.tasks = tasks;
            
            const stats = window.sharedData.getTasksStats();
            document.getElementById('totalTasks').textContent = stats.total || 0;
            document.getElementById('activeTasks').textContent = stats.total || 0;
            document.getElementById('totalCompletions').textContent = stats.totalCompletions || 0;
            document.getElementById('totalRewards').textContent = (stats.totalReward || 0).toFixed(2) + '$';
            document.getElementById('tasksCount').textContent = stats.total || 0;
            
            displayTasks(tasks);
        }

        // ---------- Ø¹Ø±Ø¶ Ø§Ù„Ù…Ù‡Ø§Ù… ----------
        function displayTasks(tasks) {
            const table = document.getElementById('tasksTable');
            
            if (tasks.length === 0) {
                table.innerHTML = `
                    <tr>
                        <td colspan="9" style="text-align: center; padding: 40px;">
                            <i class="fas fa-tasks" style="font-size: 2rem; margin-bottom: 15px;"></i>
                            <p>Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…Ù‡Ø§Ù…</p>
                        </td>
                    </tr>
                `;
                return;
            }
            
            let html = '';
            tasks.forEach(task => {
                const categories = task.packageCategories || [];
                const categoryText = categories.map(cat => 
                    cat === 'vip' ? 'ğŸ’ VIP' : 
                    cat === 'premium' ? 'ğŸ¥‡ Ù…Ù…ÙŠØ²Ø©' : 'ğŸ¥ˆ Ø¹Ø§Ø¯ÙŠØ©'
                ).join(', ');
                
                html += `
                    <tr>
                        <td><strong>${task.title}</strong></td>
                        <td>${task.description}</td>
                        <td class="text-success">${task.reward}$</td>
                        <td>${task.type === 'daily' ? 'ÙŠÙˆÙ…ÙŠØ©' : 'Ø£Ø³Ø¨ÙˆØ¹ÙŠØ©'}</td>
                        <td>${task.availableFor === 'all' ? 'Ø§Ù„ÙƒÙ„' : task.availableFor === 'premium' ? 'Ù…Ù…ÙŠØ²' : 'VIP'}</td>
                        <td><small>${categoryText}</small></td>
                        <td>${task.completions || 0}</td>
                        <td><span class="status-badge status-active">Ù†Ø´Ø·</span></td>
                        <td>
                            <button class="btn btn-sm btn-warning" onclick="editTask(${task.id})">
                                <i class="fas fa-edit"></i>
                            </button>
                            <button class="btn btn-sm btn-danger" onclick="deleteTaskAdmin(${task.id})">
                                <i class="fas fa-trash"></i>
                            </button>
                        </td>
                    </tr>
                `;
            });
            
            table.innerHTML = html;
        }

        // ---------- Ø¥Ø¶Ø§ÙØ© Ù…Ù‡Ù…Ø© ----------
        function addTask() {
            const title = document.getElementById('taskTitle').value.trim();
            const description = document.getElementById('taskDesc').value.trim();
            const reward = parseFloat(document.getElementById('taskReward').value);
            const type = document.getElementById('taskType').value;
            const level = document.getElementById('taskLevel').value;
            const difficulty = document.getElementById('taskDifficulty').value;
            const timeRequired = parseInt(document.getElementById('taskTime').value) || 2;
            
            const packageCategories = [];
            if (document.getElementById('catStandard').checked) packageCategories.push('standard');
            if (document.getElementById('catPremium').checked) packageCategories.push('premium');
            if (document.getElementById('catVip').checked) packageCategories.push('vip');
            
            if (packageCategories.length === 0) {
                showAdminNotification('âŒ ÙŠØ¬Ø¨ Ø§Ø®ØªÙŠØ§Ø± ÙØ¦Ø© ÙˆØ§Ø­Ø¯Ø© Ø¹Ù„Ù‰ Ø§Ù„Ø£Ù‚Ù„ Ù„Ù„Ù…Ù‡Ù…Ø©', 'error');
                return;
            }
            
            if (!title || !description || !reward) {
                showAdminNotification('âŒ ÙŠØ±Ø¬Ù‰ Ù…Ù„Ø¡ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ„ Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©', 'error');
                return;
            }
            
            if (reward <= 0) {
                showAdminNotification('âŒ Ø§Ù„Ù…ÙƒØ§ÙØ£Ø© ÙŠØ¬Ø¨ Ø£Ù† ØªÙƒÙˆÙ† Ø£ÙƒØ¨Ø± Ù…Ù† ØµÙØ±', 'error');
                return;
            }
            
            const newTask = window.sharedData.addTask({
                title: title,
                description: description,
                reward: reward,
                type: type,
                availableFor: level,
                packageCategories: packageCategories,
                difficulty: difficulty,
                timeRequired: timeRequired
            });
            
            showAdminNotification(`âœ… ØªÙ… Ø¥Ø¶Ø§ÙØ© Ù…Ù‡Ù…Ø© "${title}" Ø¨Ù†Ø¬Ø§Ø­ Ù„Ù„ÙØ¦Ø§Øª: ${packageCategories.join(', ')}`, 'success');
            closeModal('addTaskModal');
            loadTasks();
            
            document.getElementById('taskTitle').value = '';
            document.getElementById('taskDesc').value = '';
            document.getElementById('taskReward').value = '';
            document.getElementById('catStandard').checked = false;
            document.getElementById('catPremium').checked = false;
            document.getElementById('catVip').checked = false;
        }

        // ---------- Ø­Ø°Ù Ù…Ù‡Ù…Ø© ----------
        function deleteTaskAdmin(taskId) {
            if (!confirm('Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø­Ø°Ù Ù‡Ø°Ù‡ Ø§Ù„Ù…Ù‡Ù…Ø©ØŸ')) return;
            
            const success = window.sharedData.deleteTask(taskId);
            
            if (success) {
                showAdminNotification('âœ… ØªÙ… Ø­Ø°Ù Ø§Ù„Ù…Ù‡Ù…Ø© Ø¨Ù†Ø¬Ø§Ø­', 'success');
                loadTasks();
            }
        }

        // ---------- ØªØ¹Ø¯ÙŠÙ„ Ù…Ù‡Ù…Ø© ----------
        function editTask(taskId) {
            const task = adminData.tasks.find(t => t.id === taskId);
            if (!task) return;
            
            document.getElementById('taskTitle').value = task.title;
            document.getElementById('taskDesc').value = task.description;
            document.getElementById('taskReward').value = task.reward;
            document.getElementById('taskType').value = task.type || 'daily';
            document.getElementById('taskLevel').value = task.availableFor || 'all';
            document.getElementById('taskDifficulty').value = task.difficulty || 'easy';
            document.getElementById('taskTime').value = task.timeRequired || 2;
            
            document.getElementById('catStandard').checked = task.packageCategories?.includes('standard') || false;
            document.getElementById('catPremium').checked = task.packageCategories?.includes('premium') || false;
            document.getElementById('catVip').checked = task.packageCategories?.includes('vip') || false;
            
            window.sharedData.deleteTask(taskId);
            
            showAdminNotification('ÙŠÙ…ÙƒÙ†Ùƒ ØªØ¹Ø¯ÙŠÙ„ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ù‡Ù…Ø© Ø«Ù… Ø§Ù„Ø­ÙØ¸', 'info');
            showAddTaskModal();
        }

        // ---------- ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¥Ø­Ø§Ù„Ø§Øª ----------
        function loadReferrals() {
            const users = adminData.users;
            let referrals = [];
            let topMarketers = [];
            
            users.forEach(user => {
                if (user.referralCode) {
                    const userReferrals = users.filter(u => u.referredBy === user.referralCode);
                    if (userReferrals.length > 0) {
                        const totalDeposits = userReferrals
                            .filter(u => u.package)
                            .reduce((sum, u) => sum + (u.package.amount || 0), 0);
                        
                        const commissionDue = userReferrals
                            .filter(u => u.package && !u.referralRewardPaid)
                            .length * 50;
                        
                        topMarketers.push({
                            user: user,
                            referralsCount: userReferrals.length,
                            activeReferrals: userReferrals.filter(u => u.package).length,
                            referralEarnings: user.referralEarnings || 0,
                            pendingCommission: commissionDue,
                            totalDeposits: totalDeposits,
                            referralCode: user.referralCode
                        });
                        
                        userReferrals.forEach(ref => {
                            referrals.push({
                                referredUser: ref,
                                marketer: user,
                                referralCode: ref.referredBy,
                                date: ref.joinedDate,
                                packageAmount: ref.package ? ref.package.amount : 0,
                                packageName: ref.package ? ref.package.name : 'Ù„Ø§ ÙŠÙˆØ¬Ø¯',
                                rewardPaid: ref.referralRewardPaid || false,
                                status: ref.package ? 'Ù†Ø´Ø·' : 'Ø¨Ø§Ù†ØªØ¸Ø§Ø±'
                            });
                        });
                    }
                }
            });
            
            topMarketers.sort((a, b) => b.referralsCount - a.referralsCount || b.pendingCommission - a.pendingCommission);
            
            adminData.referrals = referrals;
            adminData.topMarketers = topMarketers;
            
            displayTopMarketers(topMarketers);
            displayReferralsDetails(referrals);
        }

        // ---------- Ø¹Ø±Ø¶ Ø£ÙØ¶Ù„ Ø§Ù„Ù…Ø³ÙˆÙ‚ÙŠÙ† ----------
        function displayTopMarketers(marketers) {
            const table = document.getElementById('topMarketersTable');
            
            if (marketers.length === 0) {
                table.innerHTML = `
                    <tr>
                        <td colspan="10" style="text-align: center; padding: 40px;">
                            <i class="fas fa-user-friends" style="font-size: 2rem; margin-bottom: 15px;"></i>
                            <p>Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¥Ø­Ø§Ù„Ø§Øª Ø¨Ø¹Ø¯</p>
                        </td>
                    </tr>
                `;
                return;
            }
            
            let html = '';
            marketers.slice(0, 20).forEach((marketer, index) => {
                const user = marketer.user;
                const paidCommission = marketer.referralEarnings;
                const pendingCommission = marketer.pendingCommission;
                
                html += `
                    <tr>
                        <td>${index === 0 ? 'ğŸ¥‡' : index === 1 ? 'ğŸ¥ˆ' : index === 2 ? 'ğŸ¥‰' : `${index + 1}`}</td>
                        <td>
                            <strong>${user.name || 'ØºÙŠØ± Ù…Ø¹Ø±ÙˆÙ'}</strong><br>
                            <small style="color: #9ca3af;">${user.email || 'Ù„Ø§ ÙŠÙˆØ¬Ø¯'}</small>
                        </td>
                        <td><span class="referral-code">${marketer.referralCode}</span></td>
                        <td><strong>${marketer.referralsCount}</strong></td>
                        <td>${marketer.activeReferrals}</td>
                        <td>${(marketer.totalDeposits || 0).toFixed(2)}$</td>
                        <td><span class="commission-badge">${(pendingCommission || 0).toFixed(2)}$</span></td>
                        <td>${(paidCommission || 0).toFixed(2)}$</td>
                        <td class="${pendingCommission > 0 ? 'text-warning' : 'text-success'}">
                            ${pendingCommission > 0 ? `${(pendingCommission).toFixed(2)}$` : '0$'}
                        </td>
                        <td>
                            <button class="btn btn-sm btn-success" onclick="payCommission(${user.id})" ${pendingCommission === 0 ? 'disabled' : ''}>
                                <i class="fas fa-money-bill-wave"></i> ØµØ±Ù
                            </button>
                            <button class="btn btn-sm btn-purple" onclick="viewMarketerDetails(${user.id})">
                                <i class="fas fa-eye"></i>
                            </button>
                        </td>
                    </tr>
                `;
            });
            
            table.innerHTML = html;
        }

        // ---------- Ø¹Ø±Ø¶ ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ø¥Ø­Ø§Ù„Ø§Øª ----------
        function displayReferralsDetails(referrals) {
            const table = document.getElementById('referralsDetailsTable');
            
            if (referrals.length === 0) {
                table.innerHTML = `
                    <tr>
                        <td colspan="10" style="text-align: center; padding: 40px;">
                            <i class="fas fa-user-plus" style="font-size: 2rem; margin-bottom: 15px;"></i>
                            <p>Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¥Ø­Ø§Ù„Ø§Øª Ù…Ø³Ø¬Ù„Ø©</p>
                        </td>
                    </tr>
                `;
                return;
            }
            
            let html = '';
            referrals.slice(0, 50).forEach(ref => {
                const referredUser = ref.referredUser;
                const marketer = ref.marketer;
                const joinDate = ref.date ? new Date(ref.date).toLocaleDateString('ar-SA') : '-';
                
                html += `
                    <tr>
                        <td>
                            <strong>${referredUser.name || 'ØºÙŠØ± Ù…Ø¹Ø±ÙˆÙ'}</strong><br>
                            <small>${referredUser.email || 'Ù„Ø§ ÙŠÙˆØ¬Ø¯'}</small>
                        </td>
                        <td>${marketer.name || 'ØºÙŠØ± Ù…Ø¹Ø±ÙˆÙ'}</td>
                        <td><span class="referral-code" style="font-size: 11px;">${ref.referralCode || ''}</span></td>
                        <td>${ref.packageName}</td>
                        <td>${(ref.packageAmount || 0).toFixed(2)}$</td>
                        <td>
                            ${ref.packageAmount > 0 && !ref.rewardPaid ? 
                                `<span class="commission-badge">20$</span>` : 
                                ref.rewardPaid ? 'âœ… ØªÙ…' : 'â³'}
                        </td>
                        <td>
                            ${ref.packageAmount > 0 ? 
                                `<span class="commission-badge">50$</span>` : 
                                'â³'}
                        </td>
                        <td>${joinDate}</td>
                        <td>
                            <span class="status-badge ${ref.status === 'Ù†Ø´Ø·' ? 'status-active' : 'status-pending'}">
                                ${ref.status}
                            </span>
                        </td>
                        <td>
                            ${ref.packageAmount > 0 && !ref.rewardPaid ? `
                                <button class="btn btn-sm btn-success" onclick="processReferralReward(${referredUser.id})">
                                    <i class="fas fa-gift"></i> ØµØ±Ù
                                </button>
                            ` : ''}
                        </td>
                    </tr>
                `;
            });
            
            table.innerHTML = html;
        }

        // ---------- ØµØ±Ù Ù…ÙƒØ§ÙØ£Ø© Ø¥Ø­Ø§Ù„Ø© ----------
        function processReferralReward(userId) {
            const user = adminData.users.find(u => u.id === userId);
            if (!user || !user.referredBy) return;
            
            const referrer = adminData.users.find(u => u.referralCode === user.referredBy);
            if (!referrer) return;
            
            if (user.referralRewardPaid) {
                showAdminNotification('ØªÙ… ØµØ±Ù Ø§Ù„Ù…ÙƒØ§ÙØ£Ø© Ù…Ø³Ø¨Ù‚Ø§Ù‹', 'warning');
                return;
            }
            
            const result = window.sharedData.processReferralRewardsOnApproval(userId, user.package?.amount || 0);
            
            if (result) {
                showAdminNotification(`âœ… ØªÙ… ØµØ±Ù 20$ Ù„Ù„Ù…Ø³ØªØ®Ø¯Ù… ${user.name || 'Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…'} Ùˆ 50$ Ù„Ù„Ù…Ø³ÙˆÙ‚ ${referrer.name || 'Ø§Ù„Ù…Ø³ÙˆÙ‚'}`, 'success');
                loadUsers();
                loadReferrals();
            }
        }

        // ---------- ØµØ±Ù Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¹Ù…ÙˆÙ„Ø§Øª ----------
        function payAllCommissions() {
            if (!confirm('Ù‡Ù„ ØªØ±ÙŠØ¯ ØµØ±Ù Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¹Ù…ÙˆÙ„Ø§Øª Ø§Ù„Ù…Ø³ØªØ­Ù‚Ø© Ù„Ù„Ù…Ø³ÙˆÙ‚ÙŠÙ†ØŸ')) return;
            
            let paidCount = 0;
            let totalAmount = 0;
            
            adminData.topMarketers.forEach(marketer => {
                if (marketer.pendingCommission > 0) {
                    const user = marketer.user;
                    user.balance = (user.balance || 0) + marketer.pendingCommission;
                    user.referralEarnings = (user.referralEarnings || 0) + marketer.pendingCommission;
                    
                    window.sharedData.addUserTransaction(user.id, {
                        type: 'Ù…ÙƒØ§ÙØ£Ø© Ø¥Ø­Ø§Ù„Ø©',
                        amount: marketer.pendingCommission,
                        description: `ØµØ±Ù Ø¬Ù…ÙŠØ¹ Ø¹Ù…ÙˆÙ„Ø§Øª Ø§Ù„Ø¥Ø­Ø§Ù„Ø©`,
                        date: new Date().toLocaleString('ar-SA')
                    });
                    
                    paidCount++;
                    totalAmount += marketer.pendingCommission;
                    marketer.pendingCommission = 0;
                }
            });
            
            adminData.users.forEach(user => {
                if (user.referredBy) {
                    const referrer = adminData.users.find(u => u.referralCode === user.referredBy);
                    if (referrer && user.package && !user.referralRewardPaid) {
                        user.referralRewardPaid = true;
                    }
                }
            });
            
            localStorage.setItem('elite_users', JSON.stringify(adminData.users));
            
            showAdminNotification(`âœ… ØªÙ… ØµØ±Ù ${totalAmount.toFixed(2)}$ Ù„Ù€ ${paidCount} Ù…Ø³ÙˆÙ‚`, 'success');
            loadUsers();
            loadReferrals();
        }

        // ---------- ØµØ±Ù Ø¹Ù…ÙˆÙ„Ø© ÙØ±Ø¯ÙŠØ© ----------
        function payCommission(userId) {
            const user = adminData.users.find(u => u.id === userId);
            if (!user) return;
            
            const marketer = adminData.topMarketers.find(m => m.user.id === userId);
            if (!marketer || marketer.pendingCommission === 0) {
                showAdminNotification('Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¹Ù…ÙˆÙ„Ø§Øª Ù…Ø³ØªØ­Ù‚Ø©', 'info');
                return;
            }
            
            if (confirm(`Ù‡Ù„ ØªØ±ÙŠØ¯ ØµØ±Ù ${marketer.pendingCommission.toFixed(2)}$ Ø¹Ù…ÙˆÙ„Ø© Ù„Ù„Ù…Ø³ÙˆÙ‚ ${user.name || 'Ø§Ù„Ù…Ø³ÙˆÙ‚'}ØŸ`)) {
                user.balance = (user.balance || 0) + marketer.pendingCommission;
                user.referralEarnings = (user.referralEarnings || 0) + marketer.pendingCommission;
                
                const referredUsers = adminData.users.filter(u => u.referredBy === user.referralCode);
                referredUsers.forEach(ref => {
                    if (ref.package && !ref.referralRewardPaid) {
                        ref.referralRewardPaid = true;
                    }
                });
                
                window.sharedData.addUserTransaction(user.id, {
                    type: 'Ù…ÙƒØ§ÙØ£Ø© Ø¥Ø­Ø§Ù„Ø©',
                    amount: marketer.pendingCommission,
                    description: `ØµØ±Ù Ø¹Ù…ÙˆÙ„Ø© Ø¥Ø­Ø§Ù„Ø©`,
                    date: new Date().toLocaleString('ar-SA')
                });
                
                localStorage.setItem('elite_users', JSON.stringify(adminData.users));
                
                showAdminNotification(`âœ… ØªÙ… ØµØ±Ù ${marketer.pendingCommission.toFixed(2)}$ Ù„Ù„Ù…Ø³ÙˆÙ‚ ${user.name || 'Ø§Ù„Ù…Ø³ÙˆÙ‚'}`, 'success');
                loadUsers();
                loadReferrals();
            }
        }

        // ---------- Ø¹Ø±Ø¶ ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ù…Ø³ÙˆÙ‚ ----------
        function viewMarketerDetails(userId) {
            const user = adminData.users.find(u => u.id === userId);
            if (!user) return;
            
            const referrals = adminData.users.filter(u => u.referredBy === user.referralCode);
            const activeReferrals = referrals.filter(r => r.package);
            const pendingReferrals = referrals.filter(r => r.pendingPackage && !r.package);
            
            let html = `
                <div style="padding: 20px;">
                    <h3 style="margin-bottom: 20px; color: var(--admin-purple);">
                        <i class="fas fa-trophy"></i> ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ù…Ø³ÙˆÙ‚: ${user.name || 'ØºÙŠØ± Ù…Ø¹Ø±ÙˆÙ'}
                    </h3>
                    
                    <div style="display: grid; grid-template-columns: repeat(4, 1fr); gap: 15px; margin-bottom: 20px;">
                        <div style="background: rgba(139,92,246,0.1); padding: 15px; border-radius: 10px; text-align: center;">
                            <div style="font-size: 24px; font-weight: bold; color: var(--admin-purple);">${referrals.length}</div>
                            <div style="color: #9ca3af;">Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø¥Ø­Ø§Ù„Ø§Øª</div>
                        </div>
                        <div style="background: rgba(16,185,129,0.1); padding: 15px; border-radius: 10px; text-align: center;">
                            <div style="font-size: 24px; font-weight: bold; color: var(--admin-success);">${activeReferrals.length}</div>
                            <div style="color: #9ca3af;">Ø¥Ø­Ø§Ù„Ø§Øª Ù†Ø´Ø·Ø©</div>
                        </div>
                        <div style="background: rgba(245,158,11,0.1); padding: 15px; border-radius: 10px; text-align: center;">
                            <div style="font-size: 24px; font-weight: bold; color: var(--admin-warning);">${pendingReferrals.length}</div>
                            <div style="color: #9ca3af;">Ø¨Ø§Ù†ØªØ¸Ø§Ø± Ø§Ù„Ø¨Ø§Ù‚Ø©</div>
                        </div>
                        <div style="background: rgba(6,182,212,0.1); padding: 15px; border-radius: 10px; text-align: center;">
                            <div style="font-size: 24px; font-weight: bold; color: var(--admin-info);">${(user.referralEarnings || 0).toFixed(2)}$</div>
                            <div style="color: #9ca3af;">Ø£Ø±Ø¨Ø§Ø­ Ø§Ù„Ø¥Ø­Ø§Ù„Ø©</div>
                        </div>
                    </div>
                    
                    <h4 style="margin: 20px 0 15px;">Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø¥Ø­Ø§Ù„Ø§Øª</h4>
                    <div style="max-height: 300px; overflow-y: auto;">
                        ${referrals.length > 0 ? referrals.map(ref => `
                            <div style="display: flex; justify-content: space-between; align-items: center; padding: 12px; background: rgba(255,255,255,0.03); margin-bottom: 8px; border-radius: 8px;">
                                <div>
                                    <strong>${ref.name || 'ØºÙŠØ± Ù…Ø¹Ø±ÙˆÙ'}</strong><br>
                                    <small style="color: #9ca3af;">${ref.email || 'Ù„Ø§ ÙŠÙˆØ¬Ø¯'}</small>
                                </div>
                                <div style="text-align: left;">
                                    <span style="display: block; font-weight: bold;">${ref.package ? ref.package.name : 'Ù„Ø§ ÙŠÙˆØ¬Ø¯'}</span>
                                    <small style="color: #9ca3af;">${ref.joinedDate ? new Date(ref.joinedDate).toLocaleDateString('ar-SA') : '-'}</small>
                                </div>
                                <div>
                                    <span class="status-badge ${ref.package ? 'status-active' : 'status-pending'}">
                                        ${ref.package ? 'Ù†Ø´Ø·' : 'Ø¨Ø§Ù†ØªØ¸Ø§Ø±'}
                                    </span>
                                </div>
                            </div>
                        `).join('') : `
                            <p style="color: #9ca3af; text-align: center; padding: 20px;">
                                Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¥Ø­Ø§Ù„Ø§Øª Ù„Ù‡Ø°Ø§ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…
                            </p>
                        `}
                    </div>
                </div>
            `;
            
            const modal = document.createElement('div');
            modal.className = 'modal active';
            modal.innerHTML = `
                <div class="modal-content" style="max-width: 700px;">
                    <div style="display: flex; justify-content: space-between; margin-bottom: 20px;">
                        <h3>ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ù…Ø³ÙˆÙ‚</h3>
                        <button class="btn btn-sm" style="background: var(--admin-danger);" onclick="this.closest('.modal').remove()">
                            <i class="fas fa-times"></i>
                        </button>
                    </div>
                    ${html}
                </div>
            `;
            document.body.appendChild(modal);
        }

        // ---------- ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø·Ù„Ø¨Ø§Øª Ø§Ù„Ù…Ø¹Ù„Ù‚Ø© ----------
        function loadPendingRequests() {
            const pendingPackages = JSON.parse(localStorage.getItem('pending_packages')) || [];
            adminData.pendingPackages = pendingPackages;
            
            let totalPendingAmount = 0;
            let totalPendingTime = 0;
            
            pendingPackages.forEach(pkg => {
                totalPendingAmount += pkg.amount || 0;
                const requestDate = pkg.date ? new Date(pkg.date) : new Date();
                const now = new Date();
                totalPendingTime += (now - requestDate) / (1000 * 60 * 60);
            });
            
            const avgPendingTime = pendingPackages.length > 0 ? (totalPendingTime / pendingPackages.length).toFixed(1) : 0;
            
            const pendingWithdrawals = [];
            let totalWithdrawalAmount = 0;
            
            adminData.users.forEach(user => {
                const userWithdrawals = JSON.parse(localStorage.getItem(`user_withdrawals_${user.id}`)) || [];
                userWithdrawals.forEach(w => {
                    if (w.status === 'Ù…Ø¹Ù„Ù‚') {
                        pendingWithdrawals.push({
                            ...w,
                            userName: user.name,
                            userEmail: user.email,
                            userId: user.id
                        });
                        totalWithdrawalAmount += w.amount || 0;
                    }
                });
            });
            
            adminData.pendingWithdrawals = pendingWithdrawals;
            
            document.getElementById('pendingPackagesCount').textContent = pendingPackages.length;
            document.getElementById('pendingWithdrawalsCount').textContent = pendingWithdrawals.length;
            document.getElementById('totalPendingAmount').textContent = (totalPendingAmount + totalWithdrawalAmount).toFixed(2) + '$';
            document.getElementById('avgPendingTime').textContent = avgPendingTime + 'h';
            
            displayPendingPackages(pendingPackages);
            displayPendingWithdrawals(pendingWithdrawals);
        }

        // ---------- Ø¹Ø±Ø¶ Ø·Ù„Ø¨Ø§Øª Ø§Ù„Ø§Ø´ØªØ±Ø§Ùƒ Ø§Ù„Ù…Ø¹Ù„Ù‚Ø© ----------
        function displayPendingPackages(pending) {
            const table = document.getElementById('pendingPackagesTable');
            
            if (pending.length === 0) {
                table.innerHTML = `
                    <tr>
                        <td colspan="10" style="text-align: center; padding: 40px;">
                            <i class="fas fa-check-circle" style="font-size: 2rem; color: var(--admin-success); margin-bottom: 15px;"></i>
                            <p>Ù„Ø§ ØªÙˆØ¬Ø¯ Ø·Ù„Ø¨Ø§Øª Ø§Ø´ØªØ±Ø§Ùƒ Ù…Ø¹Ù„Ù‚Ø©</p>
                        </td>
                    </tr>
                `;
                return;
            }
            
            let html = '';
            pending.forEach((request, index) => {
                const networkClass = request.network === 'TRC20' ? 'trc20-tag' : 
                                   request.network === 'ERC20' ? 'erc20-tag' : 'bep20-tag';
                const hasReferral = request.referredBy;
                
                html += `
                    <tr>
                        <td>
                            <strong>${request.userName || 'ØºÙŠØ± Ù…Ø¹Ø±ÙˆÙ'}</strong><br>
                            <small>${request.userEmail || 'Ù„Ø§ ÙŠÙˆØ¬Ø¯'}</small>
                        </td>
                        <td>${request.packageName || 'ØºÙŠØ± Ù…Ø¹Ø±ÙˆÙ'}</td>
                        <td><strong>${(request.amount || 0).toFixed(2)}$</strong></td>
                        <td><small style="font-family: monospace;">${request.transactionHash ? request.transactionHash.substring(0, 20) + '...' : 'Ù„Ù… ÙŠØ±ÙØ¹'}</small></td>
                        <td><span class="network-tag ${networkClass}">${request.network || 'TRC20'}</span></td>
                        <td>
                            ${request.fastApproval ? 
                                '<span class="badge success">âš¡ Ø³Ø±ÙŠØ¹</span>' : 
                                '<span class="badge">â³ Ø¹Ø§Ø¯ÙŠ</span>'}
                        </td>
                        <td>${request.date || ''}</td>
                        <td>
                            ${hasReferral ? `
                                <span class="badge purple" style="display: flex; align-items: center; gap: 5px;">
                                    <i class="fas fa-gift"></i> 50$ + 20$
                                </span>
                            ` : '-'}
                        </td>
                        <td>
                            <span class="status-badge status-pending">Ø¨Ø§Ù†ØªØ¸Ø§Ø± Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹Ø©</span>
                        </td>
                        <td>
                            <button class="btn btn-sm btn-success" onclick="showProcessModal(${index})">
                                <i class="fas fa-cog"></i> Ù…Ø¹Ø§Ù„Ø¬Ø©
                            </button>
                            <button class="btn btn-sm btn-info" onclick="viewRequestDetails(${index})">
                                <i class="fas fa-eye"></i>
                            </button>
                        </td>
                    </tr>
                `;
            });
            
            table.innerHTML = html;
        }

        // ---------- Ø¹Ø±Ø¶ Ø·Ù„Ø¨Ø§Øª Ø§Ù„Ø³Ø­Ø¨ Ø§Ù„Ù…Ø¹Ù„Ù‚Ø© ----------
        function displayPendingWithdrawals(pending) {
            const table = document.getElementById('pendingWithdrawalsTable');
            
            if (pending.length === 0) {
                table.innerHTML = `
                    <tr>
                        <td colspan="9" style="text-align: center; padding: 40px;">
                            <i class="fas fa-check-circle" style="font-size: 2rem; color: var(--admin-success); margin-bottom: 15px;"></i>
                            <p>Ù„Ø§ ØªÙˆØ¬Ø¯ Ø·Ù„Ø¨Ø§Øª Ø³Ø­Ø¨ Ù…Ø¹Ù„Ù‚Ø©</p>
                        </td>
                    </tr>
                `;
                return;
            }
            
            let html = '';
            pending.forEach((w, index) => {
                const networkClass = w.network === 'TRC20' ? 'trc20-tag' : 
                                   w.network === 'ERC20' ? 'erc20-tag' : 'bep20-tag';
                
                html += `
                    <tr>
                        <td>#WD${w.id || index + 1}</td>
                        <td>${w.userName || 'Ù…Ø³ØªØ®Ø¯Ù…'}</td>
                        <td><strong>${(w.amount || 0).toFixed(2)}$</strong></td>
                        <td>${w.fee || 5}$</td>
                        <td><small style="font-family: monospace;">${w.wallet ? w.wallet.substring(0, 15) + '...' : 'Ù„Ø§ ÙŠÙˆØ¬Ø¯'}</small></td>
                        <td><span class="network-tag ${networkClass}">${w.network || 'TRC20'}</span></td>
                        <td>${w.date || ''}</td>
                        <td><span class="status-badge status-pending">Ù…Ø¹Ù„Ù‚</span></td>
                        <td>
                            <button class="btn btn-sm btn-success" onclick="showWithdrawalProcessModal(${index})">
                                <i class="fas fa-cog"></i> Ù…Ø¹Ø§Ù„Ø¬Ø©
                            </button>
                        </td>
                    </tr>
                `;
            });
            
            table.innerHTML = html;
        }

        // ---------- Ø¥Ø¸Ù‡Ø§Ø± Ù†Ø§ÙØ°Ø© Ù…Ø¹Ø§Ù„Ø¬Ø© Ø§Ù„Ø·Ù„Ø¨ ----------
        function showProcessModal(requestIndex) {
            currentRequestId = requestIndex;
            const request = adminData.pendingPackages[requestIndex];
            if (!request) return;
            
            const networkClass = request.network === 'TRC20' ? 'trc20-tag' : 
                               request.network === 'ERC20' ? 'erc20-tag' : 'bep20-tag';
            const hasReferral = request.referredBy;
            const referrer = hasReferral ? adminData.users.find(u => u.referralCode === request.referredBy) : null;
            
            document.getElementById('requestDetails').innerHTML = `
                <div style="display: flex; justify-content: space-between; align-items: start;">
                    <div>
                        <h4 style="color: var(--admin-warning); margin-bottom: 10px;">${request.packageName || 'ØºÙŠØ± Ù…Ø¹Ø±ÙˆÙ'}</h4>
                        <p><strong>Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…:</strong> ${request.userName || 'ØºÙŠØ± Ù…Ø¹Ø±ÙˆÙ'}</p>
                        <p><strong>Ø§Ù„Ø¨Ø±ÙŠØ¯:</strong> ${request.userEmail || 'Ù„Ø§ ÙŠÙˆØ¬Ø¯'}</p>
                        <p><strong>Ø§Ù„Ù…Ø¨Ù„Øº:</strong> ${(request.amount || 0).toFixed(2)}$</p>
                        <p><strong>Ø§Ù„Ø´Ø¨ÙƒØ©:</strong> <span class="network-tag ${networkClass}">${request.network || 'TRC20'}</span></p>
                        <p><strong>ØªØ§Ø±ÙŠØ® Ø§Ù„Ø·Ù„Ø¨:</strong> ${request.date || ''}</p>
                    </div>
                    <span class="status-badge status-pending">
                        <i class="fas fa-clock"></i> Ø¨Ø§Ù†ØªØ¸Ø§Ø± Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹Ø©
                    </span>
                </div>
            `;
            
            const rewardInfo = document.getElementById('referralRewardText');
            if (hasReferral && referrer) {
                rewardInfo.innerHTML = `
                    <i class="fas fa-gift" style="color: var(--admin-purple);"></i>
                    <strong>Ù…ÙƒØ§ÙØ£Ø© Ø§Ù„Ø¥Ø­Ø§Ù„Ø©:</strong><br>
                    ğŸ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø§Ù„Ø¬Ø¯ÙŠØ¯ (${request.userName || 'Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…'}) ÙŠØ­ØµÙ„ Ø¹Ù„Ù‰ 20$<br>
                    ğŸ’° Ø§Ù„Ù…Ø³ÙˆÙ‚ (${referrer.name || 'Ø§Ù„Ù…Ø³ÙˆÙ‚'}) ÙŠØ­ØµÙ„ Ø¹Ù„Ù‰ 50$<br>
                    <span style="color: var(--admin-success);">Ø³ÙŠØªÙ… ØµØ±Ù Ø§Ù„Ù…ÙƒØ§ÙØ¢Øª ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹ Ø¹Ù†Ø¯ Ù‚Ø¨ÙˆÙ„ Ø§Ù„Ø·Ù„Ø¨</span>
                `;
                document.getElementById('referralRewardInfo').style.display = 'block';
            } else {
                rewardInfo.innerHTML = 'Ù„Ø§ ÙŠÙˆØ¬Ø¯ ÙƒÙˆØ¯ Ø¥Ø­Ø§Ù„Ø© Ù„Ù‡Ø°Ø§ Ø§Ù„Ø·Ù„Ø¨';
                document.getElementById('referralRewardInfo').style.display = 'block';
                document.getElementById('referralRewardInfo').style.background = 'rgba(100,116,139,0.1)';
            }
            
            document.getElementById('processRequestModal').classList.add('active');
        }

        // ---------- Ù‚Ø¨ÙˆÙ„ Ø·Ù„Ø¨ Ø§Ù„Ø§Ø´ØªØ±Ø§Ùƒ ----------
        function approveRequest() {
            const request = adminData.pendingPackages[currentRequestId];
            if (!request) return;
            
            const notes = document.getElementById('processNotes').value.trim();
            const users = JSON.parse(localStorage.getItem('elite_users')) || [];
            const userIndex = users.findIndex(u => u.id === request.userId);
            
            if (userIndex !== -1) {
                const pkg = window.sharedData.getPackageById(request.packageId);
                if (pkg) {
                    users[userIndex].package = {
                        id: pkg.id,
                        name: pkg.name,
                        amount: request.amount,
                        price: pkg.price,
                        profit: pkg.profit,
                        dailyProfit: (request.amount * (pkg.profit || 2.5) / 100),
                        category: pkg.category,
                        purchaseDate: new Date().toISOString(),
                        duration: pkg.duration || 30,
                        status: 'Ù†Ø´Ø·'
                    };
                    
                    users[userIndex].pendingPackage = null;
                    
                    if (users[userIndex].referredBy) {
                        window.sharedData.processReferralRewardsOnApproval(request.userId, request.amount);
                    }
                    
                    localStorage.setItem('elite_users', JSON.stringify(users));
                }
            }
            
            const transactions = JSON.parse(localStorage.getItem(`user_transactions_${request.userId}`)) || [];
            transactions.unshift({
                id: Date.now(),
                type: 'Ø§Ø´ØªØ±Ø§Ùƒ',
                amount: request.amount,
                description: `ØªÙØ¹ÙŠÙ„ Ø¨Ø§Ù‚Ø© ${request.packageName}`,
                date: new Date().toLocaleString('ar-SA'),
                notes: notes,
                status: 'Ù…ÙƒØªÙ…Ù„'
            });
            localStorage.setItem(`user_transactions_${request.userId}`, JSON.stringify(transactions));
            
            const pendingPackages = JSON.parse(localStorage.getItem('pending_packages')) || [];
            pendingPackages.splice(currentRequestId, 1);
            localStorage.setItem('pending_packages', JSON.stringify(pendingPackages));
            
            closeModal('processRequestModal');
            loadPendingRequests();
            loadUsers();
            loadReferrals();
            loadSubscriptions();
            updateDashboardStats();
            
            showAdminNotification('âœ… ØªÙ… Ù‚Ø¨ÙˆÙ„ Ø·Ù„Ø¨ Ø§Ù„Ø§Ø´ØªØ±Ø§Ùƒ ÙˆØªÙØ¹ÙŠÙ„ Ø§Ù„Ø¨Ø§Ù‚Ø©', 'success');
            window.sharedData.broadcastUpdate('packages');
            window.sharedData.broadcastUpdate('referrals');
        }

        // ---------- Ø±ÙØ¶ Ø·Ù„Ø¨ Ø§Ù„Ø§Ø´ØªØ±Ø§Ùƒ ----------
        function rejectRequest() {
            const request = adminData.pendingPackages[currentRequestId];
            if (!request) return;
            
            const notes = document.getElementById('processNotes').value.trim();
            const users = JSON.parse(localStorage.getItem('elite_users')) || [];
            const userIndex = users.findIndex(u => u.id === request.userId);
            
            if (userIndex !== -1) {
                users[userIndex].pendingPackage = null;
                localStorage.setItem('elite_users', JSON.stringify(users));
            }
            
            const pendingPackages = JSON.parse(localStorage.getItem('pending_packages')) || [];
            pendingPackages.splice(currentRequestId, 1);
            localStorage.setItem('pending_packages', JSON.stringify(pendingPackages));
            
            closeModal('processRequestModal');
            loadPendingRequests();
            
            showAdminNotification('âŒ ØªÙ… Ø±ÙØ¶ Ø·Ù„Ø¨ Ø§Ù„Ø§Ø´ØªØ±Ø§Ùƒ', 'info');
        }

        // ---------- Ø·Ù„Ø¨ Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø¥Ø¶Ø§ÙÙŠØ© ----------
        function requestMoreInfo() {
            showAdminNotification('ğŸ“§ ØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø·Ù„Ø¨ Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø¥Ø¶Ø§ÙÙŠØ© Ù„Ù„Ù…Ø³ØªØ®Ø¯Ù…', 'info');
            closeModal('processRequestModal');
        }

        // ---------- Ø¥Ø¸Ù‡Ø§Ø± Ù†Ø§ÙØ°Ø© Ù…Ø¹Ø§Ù„Ø¬Ø© Ø§Ù„Ø³Ø­Ø¨ ----------
        function showWithdrawalProcessModal(withdrawalIndex) {
            currentWithdrawalId = withdrawalIndex;
            const withdrawal = adminData.pendingWithdrawals[withdrawalIndex];
            if (!withdrawal) return;
            
            const networkClass = withdrawal.network === 'TRC20' ? 'trc20-tag' : 
                               withdrawal.network === 'ERC20' ? 'erc20-tag' : 'bep20-tag';
            
            document.getElementById('withdrawalDetails').innerHTML = `
                <div style="background: rgba(245,158,11,0.1); padding: 20px; border-radius: 10px;">
                    <div style="display: flex; justify-content: space-between; align-items: start;">
                        <div>
                            <h4 style="color: var(--admin-warning);">Ø·Ù„Ø¨ Ø³Ø­Ø¨ #${withdrawal.id || withdrawalIndex + 1}</h4>
                            <p><strong>Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…:</strong> ${withdrawal.userName || 'Ù…Ø³ØªØ®Ø¯Ù…'}</p>
                            <p><strong>Ø§Ù„Ù…Ø¨Ù„Øº:</strong> ${(withdrawal.amount || 0).toFixed(2)}$</p>
                            <p><strong>Ø§Ù„Ø±Ø³ÙˆÙ…:</strong> ${withdrawal.fee || 5}$</p>
                            <p><strong>Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹:</strong> ${((withdrawal.amount || 0) + (withdrawal.fee || 5)).toFixed(2)}$</p>
                            <p><strong>Ø§Ù„Ø´Ø¨ÙƒØ©:</strong> <span class="network-tag ${networkClass}">${withdrawal.network || 'TRC20'}</span></p>
                        </div>
                        <span class="status-badge status-pending">
                            <i class="fas fa-clock"></i> Ù…Ø¹Ù„Ù‚
                        </span>
                    </div>
                    <div style="margin-top: 15px;">
                        <p><strong>Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ù…Ø­ÙØ¸Ø©:</strong> <span style="font-family: monospace;">${withdrawal.wallet || 'Ù„Ø§ ÙŠÙˆØ¬Ø¯'}</span></p>
                        <p><strong>ØªØ§Ø±ÙŠØ® Ø§Ù„Ø·Ù„Ø¨:</strong> ${withdrawal.date || ''}</p>
                        ${withdrawal.notes ? `<p><strong>Ù…Ù„Ø§Ø­Ø¸Ø§Øª:</strong> ${withdrawal.notes}</p>` : ''}
                    </div>
                </div>
            `;
            
            document.getElementById('processWithdrawalModal').classList.add('active');
        }

        // ---------- Ø¥ÙƒÙ…Ø§Ù„ Ø·Ù„Ø¨ Ø§Ù„Ø³Ø­Ø¨ ----------
        function completeWithdrawal() {
            const withdrawal = adminData.pendingWithdrawals[currentWithdrawalId];
            if (!withdrawal) return;
            
            const txHash = document.getElementById('withdrawalTxHash').value.trim();
            
            if (!txHash) {
                showAdminNotification('ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ø±Ù‚Ù… Ø§Ù„Ù…Ø¹Ø§Ù…Ù„Ø©', 'error');
                return;
            }
            
            const users = JSON.parse(localStorage.getItem('elite_users')) || [];
            const userIndex = users.findIndex(u => u.id === withdrawal.userId);
            
            if (userIndex !== -1) {
                const userWithdrawals = JSON.parse(localStorage.getItem(`user_withdrawals_${withdrawal.userId}`)) || [];
                const withdrawalIndex = userWithdrawals.findIndex(w => w.id === withdrawal.id);
                
                if (withdrawalIndex !== -1) {
                    userWithdrawals[withdrawalIndex].status = 'Ù…ÙƒØªÙ…Ù„';
                    userWithdrawals[withdrawalIndex].txHash = txHash;
                    userWithdrawals[withdrawalIndex].processedDate = new Date().toLocaleString('ar-SA');
                    
                    localStorage.setItem(`user_withdrawals_${withdrawal.userId}`, JSON.stringify(userWithdrawals));
                    users[userIndex].totalWithdrawn = (users[userIndex].totalWithdrawn || 0) + (withdrawal.amount || 0);
                    localStorage.setItem('elite_users', JSON.stringify(users));
                }
            }
            
            closeModal('processWithdrawalModal');
            loadWithdrawals();
            loadPendingRequests();
            
            showAdminNotification('âœ… ØªÙ… ØªØ£ÙƒÙŠØ¯ Ø¥Ø±Ø³Ø§Ù„ Ø·Ù„Ø¨ Ø§Ù„Ø³Ø­Ø¨', 'success');
        }

        // ---------- Ø±ÙØ¶ Ø·Ù„Ø¨ Ø§Ù„Ø³Ø­Ø¨ ----------
        function rejectWithdrawal() {
            const withdrawal = adminData.pendingWithdrawals[currentWithdrawalId];
            if (!withdrawal) return;
            
            const notes = document.getElementById('withdrawalNotes').value.trim();
            const users = JSON.parse(localStorage.getItem('elite_users')) || [];
            const userIndex = users.findIndex(u => u.id === withdrawal.userId);
            
            if (userIndex !== -1) {
                const userWithdrawals = JSON.parse(localStorage.getItem(`user_withdrawals_${withdrawal.userId}`)) || [];
                const withdrawalIndex = userWithdrawals.findIndex(w => w.id === withdrawal.id);
                
                if (withdrawalIndex !== -1) {
                    userWithdrawals[withdrawalIndex].status = 'Ù…Ø±ÙÙˆØ¶';
                    userWithdrawals[withdrawalIndex].processorNotes = notes;
                    
                    users[userIndex].balance += (withdrawal.amount || 0) + (withdrawal.fee || 5);
                    
                    localStorage.setItem(`user_withdrawals_${withdrawal.userId}`, JSON.stringify(userWithdrawals));
                    localStorage.setItem('elite_users', JSON.stringify(users));
                    
                    const transactions = JSON.parse(localStorage.getItem(`user_transactions_${withdrawal.userId}`)) || [];
                    transactions.unshift({
                        id: Date.now(),
                        type: 'Ø¥Ù„ØºØ§Ø¡ Ø³Ø­Ø¨',
                        amount: (withdrawal.amount || 0) + (withdrawal.fee || 5),
                        description: `ØªÙ… Ø¥Ù„ØºØ§Ø¡ Ø·Ù„Ø¨ Ø§Ù„Ø³Ø­Ø¨ Ø±Ù‚Ù… #${withdrawal.id || ''} ÙˆØ¥Ø¹Ø§Ø¯Ø© Ø§Ù„Ù…Ø¨Ù„Øº Ù„Ù„Ø±ØµÙŠØ¯`,
                        date: new Date().toLocaleString('ar-SA'),
                        notes: notes
                    });
                    localStorage.setItem(`user_transactions_${withdrawal.userId}`, JSON.stringify(transactions));
                }
            }
            
            closeModal('processWithdrawalModal');
            loadWithdrawals();
            loadPendingRequests();
            loadUsers();
            
            showAdminNotification('âœ… ØªÙ… Ø±ÙØ¶ Ø·Ù„Ø¨ Ø§Ù„Ø³Ø­Ø¨ ÙˆØ¥Ø¹Ø§Ø¯Ø© Ø§Ù„Ù…Ø¨Ù„Øº Ù„Ù„Ù…Ø³ØªØ®Ø¯Ù…', 'success');
        }

        // ---------- Ø¹Ø±Ø¶ ØªÙØ§ØµÙŠÙ„ Ø·Ù„Ø¨ Ø§Ù„Ø§Ø´ØªØ±Ø§Ùƒ ----------
        function viewRequestDetails(requestIndex) {
            const request = adminData.pendingPackages[requestIndex];
            if (!request) return;
            
            const networkClass = request.network === 'TRC20' ? 'trc20-tag' : 
                               request.network === 'ERC20' ? 'erc20-tag' : 'bep20-tag';
            
            let html = `
                <div style="padding: 20px;">
                    <h3 style="margin-bottom: 20px; color: var(--admin-warning);">
                        <i class="fas fa-file-invoice"></i> ØªÙØ§ØµÙŠÙ„ Ø·Ù„Ø¨ Ø§Ù„Ø§Ø´ØªØ±Ø§Ùƒ
                    </h3>
                    
                    <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 20px;">
                        <div style="background: rgba(255,255,255,0.03); padding: 15px; border-radius: 10px;">
                            <h4 style="color: var(--admin-secondary); margin-bottom: 15px;">Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…</h4>
                            <p><strong>Ø§Ù„Ø§Ø³Ù…:</strong> ${request.userName || 'ØºÙŠØ± Ù…Ø¹Ø±ÙˆÙ'}</p>
                            <p><strong>Ø§Ù„Ø¨Ø±ÙŠØ¯:</strong> ${request.userEmail || 'Ù„Ø§ ÙŠÙˆØ¬Ø¯'}</p>
                            <p><strong>Ø§Ù„Ù‡Ø§ØªÙ:</strong> ${request.userPhone || 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯'}</p>
                        </div>
                        
                        <div style="background: rgba(255,255,255,0.03); padding: 15px; border-radius: 10px;">
                            <h4 style="color: var(--admin-secondary); margin-bottom: 15px;">Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø¨Ø§Ù‚Ø©</h4>
                            <p><strong>Ø§Ù„Ø¨Ø§Ù‚Ø©:</strong> ${request.packageName || 'ØºÙŠØ± Ù…Ø¹Ø±ÙˆÙ'}</p>
                            <p><strong>Ø§Ù„Ù…Ø¨Ù„Øº:</strong> ${(request.amount || 0).toFixed(2)}$</p>
                            <p><strong>Ø§Ù„ÙØ¦Ø©:</strong> ${request.packageCategory || 'Ø¹Ø§Ø¯ÙŠØ©'}</p>
                        </div>
                        
                        <div style="background: rgba(255,255,255,0.03); padding: 15px; border-radius: 10px;">
                            <h4 style="color: var(--admin-secondary); margin-bottom: 15px;">Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø¯ÙØ¹</h4>
                            <p><strong>Ø§Ù„Ø´Ø¨ÙƒØ©:</strong> <span class="network-tag ${networkClass}">${request.network || 'TRC20'}</span></p>
                            <p><strong>Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ù…Ø­ÙØ¸Ø©:</strong> <span style="font-family: monospace;">${request.wallet || 'Tymk60K9JvCqS7Fqy6BpWpZp8hLpVHw7D'}</span></p>
                            <p><strong>Ø±Ù‚Ù… Ø§Ù„Ù…Ø¹Ø§Ù…Ù„Ø©:</strong> ${request.transactionHash || 'ØºÙŠØ± Ù…Ø±ÙÙˆØ¹'}</p>
                            <p><strong>Ø§Ù„Ø³Ø±Ø¹Ø©:</strong> ${request.fastApproval ? 'Ø³Ø±ÙŠØ¹Ø©' : 'Ø¹Ø§Ø¯ÙŠØ©'}</p>
                        </div>
                        
                        <div style="background: rgba(255,255,255,0.03); padding: 15px; border-radius: 10px;">
                            <h4 style="color: var(--admin-secondary); margin-bottom: 15px;">Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø·Ù„Ø¨</h4>
                            <p><strong>Ø§Ù„ØªØ§Ø±ÙŠØ®:</strong> ${request.date || ''}</p>
                            <p><strong>Ø§Ù„Ø­Ø§Ù„Ø©:</strong> <span class="status-badge status-pending">Ø¨Ø§Ù†ØªØ¸Ø§Ø± Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹Ø©</span></p>
                            <p><strong>ÙƒÙˆØ¯ Ø§Ù„Ø¥Ø­Ø§Ù„Ø©:</strong> ${request.referredBy || 'Ù„Ø§ ÙŠÙˆØ¬Ø¯'}</p>
                        </div>
                    </div>
                    
                    ${request.paymentProof ? `
                        <div style="margin-top: 20px;">
                            <h4 style="color: var(--admin-secondary); margin-bottom: 15px;">ØµÙˆØ±Ø© Ø¥Ø«Ø¨Ø§Øª Ø§Ù„ØªØ­ÙˆÙŠÙ„</h4>
                            <div style="background: rgba(0,0,0,0.3); padding: 20px; border-radius: 10px; text-align: center;">
                                <img src="${request.paymentProof}" style="max-width: 100%; max-height: 300px; border-radius: 8px; border: 2px solid var(--admin-primary);">
                            </div>
                        </div>
                    ` : ''}
                    
                    <div style="margin-top: 25px; text-align: left;">
                        <button class="btn btn-sm btn-success" onclick="showProcessModal(${requestIndex}); this.closest('.modal').remove();">
                            <i class="fas fa-cog"></i> Ù…Ø¹Ø§Ù„Ø¬Ø© Ø§Ù„Ø·Ù„Ø¨
                        </button>
                    </div>
                </div>
            `;
            
            const modal = document.createElement('div');
            modal.className = 'modal active';
            modal.innerHTML = `
                <div class="modal-content" style="max-width: 900px;">
                    <div style="display: flex; justify-content: space-between; margin-bottom: 20px;">
                        <h3>ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ø·Ù„Ø¨</h3>
                        <button class="btn btn-sm" style="background: var(--admin-danger);" onclick="this.closest('.modal').remove()">
                            <i class="fas fa-times"></i> Ø¥ØºÙ„Ø§Ù‚
                        </button>
                    </div>
                    ${html}
                </div>
            `;
            document.body.appendChild(modal);
        }

        // ---------- ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø§Ø´ØªØ±Ø§ÙƒØ§Øª ----------
        function loadSubscriptions() {
            const users = adminData.users;
            let subscriptions = [];
            let activeSubscriptions = 0;
            let totalInvestments = 0;
            let dailyRevenue = 0;
            
            users.forEach(user => {
                if (user.package && user.package.status === 'Ù†Ø´Ø·') {
                    const purchaseDate = new Date(user.package.purchaseDate);
                    const endDate = new Date(purchaseDate);
                    endDate.setDate(endDate.getDate() + (user.package.duration || 30));
                    
                    const daysLeft = Math.max(0, Math.ceil((endDate - new Date()) / (1000 * 60 * 60 * 24)));
                    
                    subscriptions.push({
                        userId: user.id,
                        userName: user.name,
                        userEmail: user.email,
                        packageName: user.package.name,
                        packageAmount: user.package.amount,
                        dailyProfit: user.package.dailyProfit || (user.package.amount * 0.025),
                        startDate: user.package.purchaseDate,
                        endDate: endDate.toISOString(),
                        daysLeft: daysLeft,
                        status: 'Ù†Ø´Ø·'
                    });
                    
                    activeSubscriptions++;
                    totalInvestments += user.package.amount || 0;
                    dailyRevenue += user.package.dailyProfit || (user.package.amount * 0.025);
                }
            });
            
            adminData.subscriptions = subscriptions;
            document.getElementById('subscriptionsCount').textContent = subscriptions.length;
            document.getElementById('activeSubscriptionsCount').textContent = activeSubscriptions;
            document.getElementById('totalInvestments').textContent = (totalInvestments || 0).toFixed(2) + '$';
            document.getElementById('dailyRevenue').textContent = (dailyRevenue || 0).toFixed(2) + '$';
            
            displaySubscriptions(subscriptions);
        }

        // ---------- Ø¹Ø±Ø¶ Ø§Ù„Ø§Ø´ØªØ±Ø§ÙƒØ§Øª ----------
        function displaySubscriptions(subscriptions) {
            const table = document.getElementById('subscriptionsTable');
            
            if (subscriptions.length === 0) {
                table.innerHTML = `
                    <tr>
                        <td colspan="9" style="text-align: center; padding: 40px;">
                            <i class="fas fa-box-open" style="font-size: 2rem; margin-bottom: 15px;"></i>
                            <p>Ù„Ø§ ØªÙˆØ¬Ø¯ Ø§Ø´ØªØ±Ø§ÙƒØ§Øª Ù†Ø´Ø·Ø©</p>
                        </td>
                    </tr>
                `;
                return;
            }
            
            let html = '';
            subscriptions.forEach(sub => {
                html += `
                    <tr>
                        <td>
                            <strong>${sub.userName || 'ØºÙŠØ± Ù…Ø¹Ø±ÙˆÙ'}</strong><br>
                            <small>${sub.userEmail || 'Ù„Ø§ ÙŠÙˆØ¬Ø¯'}</small>
                        </td>
                        <td>${sub.packageName}</td>
                        <td>${(sub.packageAmount || 0).toFixed(2)}$</td>
                        <td class="text-success">${(sub.dailyProfit || 0).toFixed(2)}$</td>
                        <td>${sub.startDate ? new Date(sub.startDate).toLocaleDateString('ar-SA') : '-'}</td>
                        <td>${sub.endDate ? new Date(sub.endDate).toLocaleDateString('ar-SA') : '-'}</td>
                        <td>
                            <span class="badge ${sub.daysLeft < 7 ? 'warning' : ''}">
                                ${sub.daysLeft} ÙŠÙˆÙ…
                            </span>
                        </td>
                        <td><span class="status-badge status-active">Ù†Ø´Ø·</span></td>
                        <td>
                            <button class="btn btn-sm btn-info" onclick="viewSubscriptionDetails(${sub.userId})">
                                <i class="fas fa-eye"></i>
                            </button>
                        </td>
                    </tr>
                `;
            });
            
            table.innerHTML = html;
        }

        // ---------- Ø¹Ø±Ø¶ ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ø§Ø´ØªØ±Ø§Ùƒ ----------
        function viewSubscriptionDetails(userId) {
            const user = adminData.users.find(u => u.id === userId);
            if (!user || !user.package) return;
            
            const purchaseDate = new Date(user.package.purchaseDate);
            const endDate = new Date(purchaseDate);
            endDate.setDate(endDate.getDate() + (user.package.duration || 30));
            const daysLeft = Math.max(0, Math.ceil((endDate - new Date()) / (1000 * 60 * 60 * 24)));
            
            let html = `
                <div style="padding: 20px;">
                    <h3 style="margin-bottom: 20px; color: var(--admin-success);">
                        <i class="fas fa-crown"></i> ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ø§Ø´ØªØ±Ø§Ùƒ
                    </h3>
                    
                    <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 20px;">
                        <div style="background: rgba(255,255,255,0.03); padding: 15px; border-radius: 10px;">
                            <h4 style="color: var(--admin-secondary); margin-bottom: 15px;">Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…</h4>
                            <p><strong>Ø§Ù„Ø§Ø³Ù…:</strong> ${user.name || 'ØºÙŠØ± Ù…Ø¹Ø±ÙˆÙ'}</p>
                            <p><strong>Ø§Ù„Ø¨Ø±ÙŠØ¯:</strong> ${user.email || 'Ù„Ø§ ÙŠÙˆØ¬Ø¯'}</p>
                        </div>
                        
                        <div style="background: rgba(255,255,255,0.03); padding: 15px; border-radius: 10px;">
                            <h4 style="color: var(--admin-secondary); margin-bottom: 15px;">Ø§Ù„Ø¨Ø§Ù‚Ø©</h4>
                            <p><strong>Ø§Ù„Ø§Ø³Ù…:</strong> ${user.package.name}</p>
                            <p><strong>Ø§Ù„Ø§Ø³ØªØ«Ù…Ø§Ø±:</strong> ${(user.package.amount || 0).toFixed(2)}$</p>
                            <p><strong>Ø§Ù„ÙØ¦Ø©:</strong> ${user.package.category === 'vip' ? 'ğŸ’ VIP' : user.package.category === 'premium' ? 'ğŸ¥‡ Ù…Ù…ÙŠØ²Ø©' : 'ğŸ¥ˆ Ø¹Ø§Ø¯ÙŠØ©'}</p>
                        </div>
                        
                        <div style="background: rgba(255,255,255,0.03); padding: 15px; border-radius: 10px;">
                            <h4 style="color: var(--admin-secondary); margin-bottom: 15px;">Ø§Ù„Ø£Ø±Ø¨Ø§Ø­</h4>
                            <p><strong>Ø§Ù„Ø±Ø¨Ø­ Ø§Ù„ÙŠÙˆÙ…ÙŠ:</strong> <span class="text-success">${(user.package.dailyProfit || user.package.amount * 0.025).toFixed(2)}$</span></p>
                            <p><strong>Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø£Ø±Ø¨Ø§Ø­:</strong> <span class="text-success">${(user.totalEarned || 0).toFixed(2)}$</span></p>
                            <p><strong>Ø£Ø±Ø¨Ø§Ø­ Ø§Ù„ÙŠÙˆÙ…:</strong> <span class="text-warning">${(user.package.dailyProfit || user.package.amount * 0.025).toFixed(2)}$</span></p>
                        </div>
                        
                        <div style="background: rgba(255,255,255,0.03); padding: 15px; border-radius: 10px;">
                            <h4 style="color: var(--admin-secondary); margin-bottom: 15px;">Ù…Ø¯Ø© Ø§Ù„Ø§Ø´ØªØ±Ø§Ùƒ</h4>
                            <p><strong>ØªØ§Ø±ÙŠØ® Ø§Ù„Ø¨Ø¯Ø¡:</strong> ${purchaseDate.toLocaleDateString('ar-SA')}</p>
                            <p><strong>ØªØ§Ø±ÙŠØ® Ø§Ù„Ø§Ù†ØªÙ‡Ø§Ø¡:</strong> ${endDate.toLocaleDateString('ar-SA')}</p>
                            <p><strong>Ø§Ù„Ø£ÙŠØ§Ù… Ø§Ù„Ù…ØªØ¨Ù‚ÙŠØ©:</strong> <span class="badge ${daysLeft < 7 ? 'warning' : ''}">${daysLeft} ÙŠÙˆÙ…</span></p>
                        </div>
                    </div>
                </div>
            `;
            
            const modal = document.createElement('div');
            modal.className = 'modal active';
            modal.innerHTML = `
                <div class="modal-content" style="max-width: 700px;">
                    <div style="display: flex; justify-content: space-between; margin-bottom: 20px;">
                        <h3>ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ø§Ø´ØªØ±Ø§Ùƒ</h3>
                        <button class="btn btn-sm" style="background: var(--admin-danger);" onclick="this.closest('.modal').remove()">
                            <i class="fas fa-times"></i> Ø¥ØºÙ„Ø§Ù‚
                        </button>
                    </div>
                    ${html}
                </div>
            `;
            document.body.appendChild(modal);
        }

        // ---------- ØªØ­Ù…ÙŠÙ„ Ø·Ù„Ø¨Ø§Øª Ø§Ù„Ø³Ø­Ø¨ ----------
        function loadWithdrawals() {
            let withdrawals = [];
            let pendingWithdrawals = 0;
            let totalWithdrawn = 0;
            let rejectedWithdrawals = 0;
            let totalWithdrawalAmount = 0;
            let count = 0;
            
            adminData.users.forEach(user => {
                const userWithdrawals = JSON.parse(localStorage.getItem(`user_withdrawals_${user.id}`)) || [];
                
                userWithdrawals.forEach(w => {
                    withdrawals.push({
                        ...w,
                        userName: user.name,
                        userEmail: user.email,
                        userId: user.id
                    });
                    
                    totalWithdrawalAmount += w.amount || 0;
                    count++;
                    
                    if (w.status === 'Ù…Ø¹Ù„Ù‚') pendingWithdrawals++;
                    if (w.status === 'Ù…ÙƒØªÙ…Ù„') totalWithdrawn += w.amount || 0;
                    if (w.status === 'Ù…Ø±ÙÙˆØ¶') rejectedWithdrawals++;
                });
            });
            
            withdrawals.sort((a, b) => new Date(b.date || 0) - new Date(a.date || 0));
            
            adminData.withdrawals = withdrawals;
            
            const avgWithdrawal = count > 0 ? (totalWithdrawalAmount / count).toFixed(2) : 0;
            
            document.getElementById('withdrawalsCount').textContent = withdrawals.length;
            document.getElementById('totalWithdrawalsCount').textContent = withdrawals.length;
            document.getElementById('totalWithdrawnAmount').textContent = (totalWithdrawn || 0).toFixed(2) + '$';
            document.getElementById('avgWithdrawal').textContent = avgWithdrawal + '$';
            document.getElementById('rejectedWithdrawals').textContent = rejectedWithdrawals;
            
            displayWithdrawals(withdrawals);
        }

        // ---------- Ø¹Ø±Ø¶ Ø·Ù„Ø¨Ø§Øª Ø§Ù„Ø³Ø­Ø¨ ----------
        function displayWithdrawals(withdrawals) {
            const table = document.getElementById('withdrawalsTable');
            
            if (withdrawals.length === 0) {
                table.innerHTML = `
                    <tr>
                        <td colspan="9" style="text-align: center; padding: 40px;">
                            <i class="fas fa-money-bill-wave" style="font-size: 2rem; margin-bottom: 15px;"></i>
                            <p>Ù„Ø§ ØªÙˆØ¬Ø¯ Ø·Ù„Ø¨Ø§Øª Ø³Ø­Ø¨</p>
                        </td>
                    </tr>
                `;
                return;
            }
            
            let filtered = withdrawals;
            const statusFilter = document.getElementById('withdrawalStatusFilter')?.value || 'all';
            if (statusFilter !== 'all') {
                const statusMap = { 'pending': 'Ù…Ø¹Ù„Ù‚', 'approved': 'Ù…ÙƒØªÙ…Ù„', 'rejected': 'Ù…Ø±ÙÙˆØ¶' };
                filtered = filtered.filter(w => w.status === statusMap[statusFilter]);
            }
            
            const dateFilter = document.getElementById('withdrawalDateFilter')?.value;
            if (dateFilter) {
                filtered = filtered.filter(w => {
                    const wDate = w.date ? new Date(w.date).toISOString().split('T')[0] : '';
                    return wDate === dateFilter;
                });
            }
            
            let html = '';
            filtered.slice(0, 50).forEach(w => {
                let statusClass = 'status-pending';
                let statusText = w.status;
                
                if (w.status === 'Ù…ÙƒØªÙ…Ù„') {
                    statusClass = 'status-active';
                } else if (w.status === 'Ù…Ø±ÙÙˆØ¶') {
                    statusClass = 'status-rejected';
                }
                
                const networkClass = w.network === 'TRC20' ? 'trc20-tag' : 
                                   w.network === 'ERC20' ? 'erc20-tag' : 'bep20-tag';
                
                html += `
                    <tr>
                        <td>#WD${w.id || ''}</td>
                        <td>
                            <strong>${w.userName || 'Ù…Ø³ØªØ®Ø¯Ù…'}</strong><br>
                            <small>${w.userEmail || ''}</small>
                        </td>
                        <td><strong>${(w.amount || 0).toFixed(2)}$</strong></td>
                        <td>${w.fee || 5}$</td>
                        <td><span class="network-tag ${networkClass}">${w.network || 'TRC20'}</span></td>
                        <td><small style="font-family: monospace;">${w.wallet ? w.wallet.substring(0, 20) + '...' : ''}</small></td>
                        <td>${w.date || ''}</td>
                        <td><span class="status-badge ${statusClass}">${statusText}</span></td>
                        <td>
                            ${w.status === 'Ù…Ø¹Ù„Ù‚' ? `
                                <button class="btn btn-sm btn-success" onclick="showWithdrawalProcessModalById(${w.id})">
                                    <i class="fas fa-cog"></i>
                                </button>
                            ` : ''}
                            <button class="btn btn-sm btn-info" onclick="viewWithdrawalDetails(${w.id})">
                                <i class="fas fa-eye"></i>
                            </button>
                        </td>
                    </tr>
                `;
            });
            
            table.innerHTML = html;
        }

        // ---------- Ø¹Ø±Ø¶ ØªÙØ§ØµÙŠÙ„ Ø·Ù„Ø¨ Ø§Ù„Ø³Ø­Ø¨ ----------
        function viewWithdrawalDetails(withdrawalId) {
            const withdrawal = adminData.withdrawals.find(w => w.id === withdrawalId);
            if (!withdrawal) return;
            
            const networkClass = withdrawal.network === 'TRC20' ? 'trc20-tag' : 
                               withdrawal.network === 'ERC20' ? 'erc20-tag' : 'bep20-tag';
            
            let statusClass = 'status-pending';
            let statusText = withdrawal.status;
            if (withdrawal.status === 'Ù…ÙƒØªÙ…Ù„') statusClass = 'status-active';
            if (withdrawal.status === 'Ù…Ø±ÙÙˆØ¶') statusClass = 'status-rejected';
            
            let html = `
                <div style="padding: 20px;">
                    <h3 style="margin-bottom: 20px; color: var(--admin-warning);">
                        <i class="fas fa-money-bill-wave"></i> ØªÙØ§ØµÙŠÙ„ Ø·Ù„Ø¨ Ø§Ù„Ø³Ø­Ø¨ #${withdrawal.id || ''}
                    </h3>
                    
                    <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 20px;">
                        <div style="background: rgba(255,255,255,0.03); padding: 15px; border-radius: 10px;">
                            <h4 style="color: var(--admin-secondary); margin-bottom: 15px;">Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…</h4>
                            <p><strong>Ø§Ù„Ø§Ø³Ù…:</strong> ${withdrawal.userName || 'ØºÙŠØ± Ù…Ø¹Ø±ÙˆÙ'}</p>
                            <p><strong>Ø§Ù„Ø¨Ø±ÙŠØ¯:</strong> ${withdrawal.userEmail || 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯'}</p>
                        </div>
                        
                        <div style="background: rgba(255,255,255,0.03); padding: 15px; border-radius: 10px;">
                            <h4 style="color: var(--admin-secondary); margin-bottom: 15px;">Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø³Ø­Ø¨</h4>
                            <p><strong>Ø§Ù„Ù…Ø¨Ù„Øº:</strong> ${(withdrawal.amount || 0).toFixed(2)}$</p>
                            <p><strong>Ø§Ù„Ø±Ø³ÙˆÙ…:</strong> ${withdrawal.fee || 5}$</p>
                            <p><strong>Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹:</strong> ${((withdrawal.amount || 0) + (withdrawal.fee || 5)).toFixed(2)}$</p>
                            <p><strong>Ø§Ù„Ø´Ø¨ÙƒØ©:</strong> <span class="network-tag ${networkClass}">${withdrawal.network || 'TRC20'}</span></p>
                        </div>
                        
                        <div style="background: rgba(255,255,255,0.03); padding: 15px; border-radius: 10px;">
                            <h4 style="color: var(--admin-secondary); margin-bottom: 15px;">Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ù…Ø­ÙØ¸Ø©</h4>
                            <p style="font-family: monospace; word-break: break-all;">${withdrawal.wallet || 'Ù„Ø§ ÙŠÙˆØ¬Ø¯'}</p>
                        </div>
                        
                        <div style="background: rgba(255,255,255,0.03); padding: 15px; border-radius: 10px;">
                            <h4 style="color: var(--admin-secondary); margin-bottom: 15px;">Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø·Ù„Ø¨</h4>
                            <p><strong>Ø§Ù„ØªØ§Ø±ÙŠØ®:</strong> ${withdrawal.date || ''}</p>
                            <p><strong>Ø§Ù„Ø­Ø§Ù„Ø©:</strong> <span class="status-badge ${statusClass}">${withdrawal.status}</span></p>
                            ${withdrawal.txHash ? `<p><strong>Ø±Ù‚Ù… Ø§Ù„Ù…Ø¹Ø§Ù…Ù„Ø©:</strong> <span style="font-family: monospace;">${withdrawal.txHash}</span></p>` : ''}
                            ${withdrawal.processedDate ? `<p><strong>ØªØ§Ø±ÙŠØ® Ø§Ù„Ù…Ø¹Ø§Ù„Ø¬Ø©:</strong> ${withdrawal.processedDate}</p>` : ''}
                        </div>
                    </div>
                    
                    ${withdrawal.notes ? `
                        <div style="margin-top: 20px; background: rgba(255,255,255,0.03); padding: 15px; border-radius: 10px;">
                            <h4 style="color: var(--admin-secondary); margin-bottom: 10px;">Ù…Ù„Ø§Ø­Ø¸Ø§Øª Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…</h4>
                            <p>${withdrawal.notes}</p>
                        </div>
                    ` : ''}
                    
                    ${withdrawal.processorNotes ? `
                        <div style="margin-top: 20px; background: rgba(255,255,255,0.03); padding: 15px; border-radius: 10px;">
                            <h4 style="color: var(--admin-secondary); margin-bottom: 10px;">Ù…Ù„Ø§Ø­Ø¸Ø§Øª Ø§Ù„Ù…Ø¹Ø§Ù„Ø¬Ø©</h4>
                            <p>${withdrawal.processorNotes}</p>
                        </div>
                    ` : ''}
                    
                    ${withdrawal.status === 'Ù…Ø¹Ù„Ù‚' ? `
                        <div style="margin-top: 25px; text-align: left;">
                            <button class="btn btn-success" onclick="showWithdrawalProcessModalById(${withdrawal.id}); this.closest('.modal').remove();">
                                <i class="fas fa-cog"></i> Ù…Ø¹Ø§Ù„Ø¬Ø© Ø§Ù„Ø·Ù„Ø¨
                            </button>
                        </div>
                    ` : ''}
                </div>
            `;
            
            const modal = document.createElement('div');
            modal.className = 'modal active';
            modal.innerHTML = `
                <div class="modal-content" style="max-width: 800px;">
                    <div style="display: flex; justify-content: space-between; margin-bottom: 20px;">
                        <h3>ØªÙØ§ØµÙŠÙ„ Ø·Ù„Ø¨ Ø§Ù„Ø³Ø­Ø¨</h3>
                        <button class="btn btn-sm" style="background: var(--admin-danger);" onclick="this.closest('.modal').remove()">
                            <i class="fas fa-times"></i> Ø¥ØºÙ„Ø§Ù‚
                        </button>
                    </div>
                    ${html}
                </div>
            `;
            document.body.appendChild(modal);
        }

        // ---------- Ø¥Ø¸Ù‡Ø§Ø± Ù†Ø§ÙØ°Ø© Ù…Ø¹Ø§Ù„Ø¬Ø© Ø§Ù„Ø³Ø­Ø¨ Ø¨ÙˆØ§Ø³Ø·Ø© ID ----------
        function showWithdrawalProcessModalById(withdrawalId) {
            const withdrawal = adminData.pendingWithdrawals.find(w => w.id === withdrawalId);
            if (!withdrawal) return;
            
            const index = adminData.pendingWithdrawals.indexOf(withdrawal);
            showWithdrawalProcessModal(index);
        }

        // ---------- ØªØ­Ù…ÙŠÙ„ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…Ø¹Ø§Ù…Ù„Ø§Øª ----------
        function loadAllTransactions() {
            let allTransactions = [];
            
            adminData.users.forEach(user => {
                const userTransactions = JSON.parse(localStorage.getItem(`user_transactions_${user.id}`)) || [];
                userTransactions.forEach(t => {
                    allTransactions.push({
                        ...t,
                        userName: user.name,
                        userEmail: user.email,
                        userId: user.id
                    });
                });
            });
            
            allTransactions.sort((a, b) => new Date(b.date || 0) - new Date(a.date || 0));
            
            adminData.transactions = allTransactions;
            displayAllTransactions(allTransactions);
        }

        // ---------- Ø¹Ø±Ø¶ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…Ø¹Ø§Ù…Ù„Ø§Øª ----------
        function displayAllTransactions(transactions) {
            const table = document.getElementById('transactionsTable');
            if (!table) return;
            
            if (transactions.length === 0) {
                table.innerHTML = `
                    <tr>
                        <td colspan="7" style="text-align: center; padding: 40px;">
                            <i class="fas fa-exchange-alt" style="font-size: 2rem; margin-bottom: 15px;"></i>
                            <p>Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…Ø¹Ø§Ù…Ù„Ø§Øª</p>
                        </td>
                    </tr>
                `;
                return;
            }
            
            let filtered = transactions;
            const searchTerm = document.getElementById('transactionSearch')?.value.toLowerCase();
            if (searchTerm) {
                filtered = filtered.filter(t => 
                    t.userName?.toLowerCase().includes(searchTerm) ||
                    t.description?.toLowerCase().includes(searchTerm) ||
                    t.type?.toLowerCase().includes(searchTerm)
                );
            }
            
            const typeFilter = document.getElementById('transactionTypeFilter')?.value;
            if (typeFilter && typeFilter !== 'all') {
                filtered = filtered.filter(t => t.type === typeFilter);
            }
            
            const dateFilter = document.getElementById('transactionDateFilter')?.value;
            if (dateFilter) {
                filtered = filtered.filter(t => {
                    const tDate = t.date ? new Date(t.date).toISOString().split('T')[0] : '';
                    return tDate === dateFilter;
                });
            }
            
            let html = '';
            filtered.slice(0, 100).forEach(t => {
                let typeColor = 'var(--admin-success)';
                let typeIcon = 'fa-plus-circle';
                
                if (t.type === 'Ø³Ø­Ø¨') {
                    typeColor = 'var(--admin-danger)';
                    typeIcon = 'fa-minus-circle';
                } else if (t.type === 'Ø§Ø´ØªØ±Ø§Ùƒ') {
                    typeColor = 'var(--admin-warning)';
                    typeIcon = 'fa-shopping-cart';
                } else if (t.type === 'Ù…ÙƒØ§ÙØ£Ø© Ø¥Ø­Ø§Ù„Ø©' || t.type === 'Ù…ÙƒØ§ÙØ£Ø©') {
                    typeColor = 'var(--admin-purple)';
                    typeIcon = 'fa-gift';
                }
                
                html += `
                    <tr>
                        <td>
                            <strong>${t.userName || 'ØºÙŠØ± Ù…Ø¹Ø±ÙˆÙ'}</strong><br>
                            <small>${t.userEmail || ''}</small>
                        </td>
                        <td>
                            <i class="fas ${typeIcon}" style="color: ${typeColor};"></i>
                            ${t.type || ''}
                        </td>
                        <td>${t.description || ''}</td>
                        <td style="color: ${typeColor}; font-weight: bold;">
                            ${t.type === 'Ø³Ø­Ø¨' ? '-' : '+'}${(t.amount || 0).toFixed(2)}$
                        </td>
                        <td>${t.date || ''}</td>
                        <td>
                            <span class="status-badge status-active">
                                ${t.status || 'Ù…ÙƒØªÙ…Ù„'}
                            </span>
                        </td>
                        <td>
                            <button class="btn btn-sm btn-info" onclick="viewTransactionDetails('${t.id}', ${t.userId})">
                                <i class="fas fa-eye"></i>
                            </button>
                        </td>
                    </tr>
                `;
            });
            
            table.innerHTML = html;
        }

        // ---------- Ø¹Ø±Ø¶ ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ù…Ø¹Ø§Ù…Ù„Ø© ----------
        function viewTransactionDetails(transactionId, userId) {
            const transactions = JSON.parse(localStorage.getItem(`user_transactions_${userId}`)) || [];
            const transaction = transactions.find(t => t.id == transactionId);
            if (!transaction) return;
            
            const user = adminData.users.find(u => u.id === userId);
            
            let typeColor = 'var(--admin-success)';
            let typeIcon = 'fa-plus-circle';
            if (transaction.type === 'Ø³Ø­Ø¨') {
                typeColor = 'var(--admin-danger)';
                typeIcon = 'fa-minus-circle';
            } else if (transaction.type === 'Ø§Ø´ØªØ±Ø§Ùƒ') {
                typeColor = 'var(--admin-warning)';
                typeIcon = 'fa-shopping-cart';
            } else if (transaction.type === 'Ù…ÙƒØ§ÙØ£Ø© Ø¥Ø­Ø§Ù„Ø©' || transaction.type === 'Ù…ÙƒØ§ÙØ£Ø©') {
                typeColor = 'var(--admin-purple)';
                typeIcon = 'fa-gift';
            }
            
            let html = `
                <div style="padding: 20px;">
                    <h3 style="margin-bottom: 20px; color: ${typeColor};">
                        <i class="fas ${typeIcon}"></i> ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ù…Ø¹Ø§Ù…Ù„Ø©
                    </h3>
                    
                    <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 20px;">
                        <div style="background: rgba(255,255,255,0.03); padding: 15px; border-radius: 10px;">
                            <h4 style="color: var(--admin-secondary); margin-bottom: 15px;">Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…</h4>
                            <p><strong>Ø§Ù„Ø§Ø³Ù…:</strong> ${user?.name || 'ØºÙŠØ± Ù…Ø¹Ø±ÙˆÙ'}</p>
                            <p><strong>Ø§Ù„Ø¨Ø±ÙŠØ¯:</strong> ${user?.email || ''}</p>
                        </div>
                        
                        <div style="background: rgba(255,255,255,0.03); padding: 15px; border-radius: 10px;">
                            <h4 style="color: var(--admin-secondary); margin-bottom: 15px;">Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ù…Ø¹Ø§Ù…Ù„Ø©</h4>
                            <p><strong>Ø§Ù„Ù†ÙˆØ¹:</strong> ${transaction.type}</p>
                            <p><strong>Ø§Ù„Ù…Ø¨Ù„Øº:</strong> <span style="color: ${typeColor};">${transaction.type === 'Ø³Ø­Ø¨' ? '-' : '+'}${(transaction.amount || 0).toFixed(2)}$</span></p>
                            <p><strong>Ø§Ù„ØªØ§Ø±ÙŠØ®:</strong> ${transaction.date}</p>
                            <p><strong>Ø§Ù„Ø­Ø§Ù„Ø©:</strong> <span class="status-badge status-active">${transaction.status || 'Ù…ÙƒØªÙ…Ù„'}</span></p>
                        </div>
                    </div>
                    
                    <div style="margin-top: 20px; background: rgba(255,255,255,0.03); padding: 15px; border-radius: 10px;">
                        <h4 style="color: var(--admin-secondary); margin-bottom: 10px;">ÙˆØµÙ Ø§Ù„Ù…Ø¹Ø§Ù…Ù„Ø©</h4>
                        <p style="font-size: 16px;">${transaction.description}</p>
                    </div>
                    
                    ${transaction.referralCode ? `
                        <div style="margin-top: 20px; background: rgba(139,92,246,0.1); padding: 15px; border-radius: 10px;">
                            <h4 style="color: var(--admin-purple); margin-bottom: 10px;">Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø¥Ø­Ø§Ù„Ø©</h4>
                            <p><strong>ÙƒÙˆØ¯ Ø§Ù„Ø¥Ø­Ø§Ù„Ø©:</strong> <span class="referral-code">${transaction.referralCode}</span></p>
                            ${transaction.referredUserName ? `<p><strong>Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø§Ù„Ù…Ø­Ø§Ù„:</strong> ${transaction.referredUserName}</p>` : ''}
                        </div>
                    ` : ''}
                </div>
            `;
            
            const modal = document.createElement('div');
            modal.className = 'modal active';
            modal.innerHTML = `
                <div class="modal-content" style="max-width: 600px;">
                    <div style="display: flex; justify-content: space-between; margin-bottom: 20px;">
                        <h3>ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ù…Ø¹Ø§Ù…Ù„Ø©</h3>
                        <button class="btn btn-sm" style="background: var(--admin-danger);" onclick="this.closest('.modal').remove()">
                            <i class="fas fa-times"></i> Ø¥ØºÙ„Ø§Ù‚
                        </button>
                    </div>
                    ${html}
                </div>
            `;
            document.body.appendChild(modal);
        }

        // ---------- ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù†Ø´Ø§Ø·Ø§Øª Ø§Ù„Ø£Ø®ÙŠØ±Ø© ----------
        function updateRecentActivities() {
            const activities = [];
            
            adminData.transactions.slice(0, 10).forEach(t => {
                activities.push({
                    user: t.userName,
                    action: t.description || t.type,
                    amount: `${t.type === 'Ø³Ø­Ø¨' ? '-' : '+'}${(t.amount || 0).toFixed(2)}$`,
                    date: t.date,
                    status: t.status || 'Ù…ÙƒØªÙ…Ù„'
                });
            });
            
            adminData.pendingPackages.slice(0, 5).forEach(p => {
                activities.push({
                    user: p.userName,
                    action: `Ø·Ù„Ø¨ Ø§Ø´ØªØ±Ø§Ùƒ: ${p.packageName}`,
                    amount: `${(p.amount || 0).toFixed(2)}$`,
                    date: p.date,
                    status: 'Ø¨Ø§Ù†ØªØ¸Ø§Ø±'
                });
            });
            
            adminData.pendingWithdrawals.slice(0, 5).forEach(w => {
                activities.push({
                    user: w.userName,
                    action: 'Ø·Ù„Ø¨ Ø³Ø­Ø¨',
                    amount: `-${(w.amount || 0).toFixed(2)}$`,
                    date: w.date,
                    status: 'Ø¨Ø§Ù†ØªØ¸Ø§Ø±'
                });
            });
            
            adminData.referrals.slice(0, 5).forEach(r => {
                activities.push({
                    user: r.marketer?.name,
                    action: `Ø¥Ø­Ø§Ù„Ø© Ø¬Ø¯ÙŠØ¯Ø©: ${r.referredUser?.name}`,
                    amount: '50$',
                    date: r.date,
                    status: r.packageAmount > 0 ? 'Ù†Ø´Ø·' : 'Ø¨Ø§Ù†ØªØ¸Ø§Ø±'
                });
            });
            
            activities.sort((a, b) => new Date(b.date || 0) - new Date(a.date || 0));
            
            const table = document.getElementById('recentActivities');
            
            if (activities.length === 0) {
                table.innerHTML = `
                    <tr>
                        <td colspan="5" style="text-align: center; padding: 40px;">
                            <i class="fas fa-history" style="font-size: 2rem; margin-bottom: 15px;"></i>
                            <p>Ù„Ø§ ØªÙˆØ¬Ø¯ Ù†Ø´Ø§Ø·Ø§Øª Ø­Ø¯ÙŠØ«Ø©</p>
                        </td>
                    </tr>
                `;
                return;
            }
            
            let html = '';
            activities.slice(0, 10).forEach(activity => {
                let statusClass = 'status-active';
                if (activity.status === 'Ø¨Ø§Ù†ØªØ¸Ø§Ø±') statusClass = 'status-pending';
                
                html += `
                    <tr>
                        <td>${activity.user || 'ØºÙŠØ± Ù…Ø¹Ø±ÙˆÙ'}</td>
                        <td>${activity.action || ''}</td>
                        <td class="${activity.amount?.startsWith('+') ? 'text-success' : 'text-danger'}">${activity.amount || '0$'}</td>
                        <td>${activity.date || ''}</td>
                        <td><span class="status-badge ${statusClass}">${activity.status}</span></td>
                    </tr>
                `;
            });
            
            table.innerHTML = html;
        }

        // ---------- ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù…Ø®Ø·Ø·Ø§Øª ----------
        function updateCharts() {
            updatePackagesChart();
            updateRevenueChart();
        }

        // ---------- ØªØ­Ø¯ÙŠØ« Ù…Ø®Ø·Ø· Ø§Ù„Ø¨Ø§Ù‚Ø§Øª ----------
        function updatePackagesChart() {
            const ctx = document.getElementById('packagesChartCanvas');
            if (!ctx) return;
            
            const packages = adminData.packages;
            const users = adminData.users;
            
            const packageData = {};
            packages.forEach(pkg => {
                packageData[pkg.name] = users.filter(u => 
                    u.package && u.package.id === pkg.id
                ).length;
            });
            
            if (packagesChart) packagesChart.destroy();
            
            packagesChart = new Chart(ctx, {
                type: 'pie',
                data: {
                    labels: Object.keys(packageData),
                    datasets: [{
                        data: Object.values(packageData),
                        backgroundColor: ['#3b82f6', '#8b5cf6', '#10b981', '#f59e0b', '#ef4444'],
                        borderWidth: 1
                    }]
                },
                options: {
                    responsive: true,
                    plugins: {
                        legend: { position: 'bottom', rtl: true, labels: { color: 'white' } }
                    }
                }
            });
        }

        // ---------- ØªØ­Ø¯ÙŠØ« Ù…Ø®Ø·Ø· Ø§Ù„Ø¥ÙŠØ±Ø§Ø¯Ø§Øª ----------
        function updateRevenueChart() {
            const ctx = document.getElementById('revenueChartCanvas');
            if (!ctx) return;
            
            const revenueByDay = {};
            const today = new Date();
            
            for (let i = 6; i >= 0; i--) {
                const date = new Date(today);
                date.setDate(date.getDate() - i);
                const dateStr = date.toLocaleDateString('ar-SA', { weekday: 'short' });
                revenueByDay[dateStr] = 0;
            }
            
            adminData.transactions.forEach(t => {
                if (t.type === 'Ø§Ø´ØªØ±Ø§Ùƒ' && t.amount) {
                    const tDate = t.date ? new Date(t.date).toLocaleDateString('ar-SA', { weekday: 'short' }) : '';
                    if (revenueByDay.hasOwnProperty(tDate)) {
                        revenueByDay[tDate] += t.amount;
                    }
                }
            });
            
            if (revenueChart) revenueChart.destroy();
            
            revenueChart = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: Object.keys(revenueByDay),
                    datasets: [{
                        label: 'Ø§Ù„Ø¥ÙŠØ±Ø§Ø¯Ø§Øª ($)',
                        data: Object.values(revenueByDay),
                        borderColor: '#10b981',
                        backgroundColor: 'rgba(16, 185, 129, 0.1)',
                        borderWidth: 2,
                        fill: true,
                        tension: 0.4
                    }]
                },
                options: {
                    responsive: true,
                    scales: {
                        y: { beginAtZero: true, ticks: { callback: v => v + '$', color: 'white' }, grid: { color: 'rgba(255,255,255,0.1)' } },
                        x: { ticks: { color: 'white' }, grid: { color: 'rgba(255,255,255,0.1)' } }
                    },
                    plugins: { legend: { rtl: true, labels: { color: 'white' } } }
                }
            });
        }

        // ---------- ØªØ­Ø¯ÙŠØ« Ø§Ù„ÙˆÙ‚Øª ----------
        function updateTime() {
            const now = new Date();
            const timeString = now.toLocaleString('ar-SA', {
                weekday: 'long', year: 'numeric', month: 'long', day: 'numeric',
                hour: '2-digit', minute: '2-digit', second: '2-digit'
            });
            document.getElementById('currentTime').textContent = timeString;
        }

        // ---------- ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¯Ø§Ø´Ø¨ÙˆØ±Ø¯ ----------
        function refreshDashboard() {
            loadAllData();
            showAdminNotification('âœ… ØªÙ… ØªØ­Ø¯ÙŠØ« Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª', 'success');
        }

        // ---------- ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø·Ù„Ø¨Ø§Øª Ø§Ù„Ù…Ø¹Ù„Ù‚Ø© ----------
        function refreshPending() {
            loadPendingRequests();
            showAdminNotification('ØªÙ… ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø·Ù„Ø¨Ø§Øª Ø§Ù„Ù…Ø¹Ù„Ù‚Ø©', 'success');
        }

        // ---------- ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø§Ø´ØªØ±Ø§ÙƒØ§Øª ----------
        function refreshSubscriptions() {
            loadSubscriptions();
            showAdminNotification('ØªÙ… ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø§Ø´ØªØ±Ø§ÙƒØ§Øª', 'success');
        }

        // ---------- ÙÙ„ØªØ±Ø© Ø·Ù„Ø¨Ø§Øª Ø§Ù„Ø³Ø­Ø¨ ----------
        function filterWithdrawals() {
            loadWithdrawals();
        }

        // ---------- ÙÙ„ØªØ±Ø© Ø§Ù„Ù…Ø¹Ø§Ù…Ù„Ø§Øª ----------
        function filterTransactions() {
            loadAllTransactions();
        }

        // ---------- Ø§Ù„Ø¨Ø­Ø« ÙÙŠ Ø§Ù„Ù…Ø¹Ø§Ù…Ù„Ø§Øª ----------
        function searchTransactions() {
            loadAllTransactions();
        }

        // ---------- Ø¥Ø¸Ù‡Ø§Ø± Ù†Ø§ÙØ°Ø© Ø¥Ø¶Ø§ÙØ© Ù…Ø³ØªØ®Ø¯Ù… ----------
        function showAddUserModal() {
            document.getElementById('addUserModal').classList.add('active');
        }

        // ---------- Ø¥Ø¸Ù‡Ø§Ø± Ù†Ø§ÙØ°Ø© Ø¥Ø¶Ø§ÙØ© Ø¨Ø§Ù‚Ø© ----------
        function showAddPackageModal() {
            document.getElementById('addPackageModal').classList.add('active');
        }

        // ---------- Ø¥Ø¸Ù‡Ø§Ø± Ù†Ø§ÙØ°Ø© Ø¥Ø¶Ø§ÙØ© Ù…Ù‡Ù…Ø© ----------
        function showAddTaskModal() {
            document.getElementById('addTaskModal').classList.add('active');
        }

        // ---------- Ø¥Ø¸Ù‡Ø§Ø± Ù†Ø§ÙØ°Ø© Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ø¥Ø­Ø§Ù„Ø© ----------
        function showReferralSettings() {
            document.getElementById('modalReferrerReward').value = window.sharedData.REFERRAL_SETTINGS.referrerReward;
            document.getElementById('modalRefereeReward').value = window.sharedData.REFERRAL_SETTINGS.refereeReward;
            document.getElementById('referralActive').value = 'true';
            document.getElementById('referralSettingsModal').classList.add('active');
        }

        // ---------- Ø¥ØºÙ„Ø§Ù‚ Ø§Ù„Ù†ÙˆØ§ÙØ° Ø§Ù„Ù…Ù†Ø¨Ø«Ù‚Ø© ----------
        function closeModal(modalId) {
            document.getElementById(modalId).classList.remove('active');
        }

        // ---------- Ø­ÙØ¸ Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ø¥Ø­Ø§Ù„Ø© ----------
        function saveReferralSettings() {
            const referrerReward = parseFloat(document.getElementById('modalReferrerReward').value);
            const refereeReward = parseFloat(document.getElementById('modalRefereeReward').value);
            const isActive = document.getElementById('referralActive').value === 'true';
            
            window.sharedData.REFERRAL_SETTINGS.referrerReward = referrerReward;
            window.sharedData.REFERRAL_SETTINGS.refereeReward = refereeReward;
            
            const settings = { referrerReward, refereeReward, isActive };
            localStorage.setItem('referral_settings', JSON.stringify(settings));
            
            showAdminNotification('âœ… ØªÙ… Ø­ÙØ¸ Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ù†Ø¸Ø§Ù… Ø§Ù„Ø¥Ø­Ø§Ù„Ø©', 'success');
            closeModal('referralSettingsModal');
            loadReferrals();
        }

        // ---------- Ø­ÙØ¸ Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ù†Ø¸Ø§Ù… ----------
        function saveSystemSettings() {
            const referrerReward = document.getElementById('referrerReward')?.value;
            const refereeReward = document.getElementById('refereeReward')?.value;
            const minWithdrawal = document.getElementById('minWithdrawal').value;
            const trc20Fee = document.getElementById('trc20Fee').value;
            const erc20Fee = document.getElementById('erc20Fee').value;
            const bep20Fee = document.getElementById('bep20Fee').value;
            
            const settings = {
                referrerReward: parseFloat(referrerReward) || 50,
                refereeReward: parseFloat(refereeReward) || 20,
                minWithdrawal: parseFloat(minWithdrawal) || 50,
                withdrawalFees: {
                    TRC20: parseFloat(trc20Fee) || 5,
                    ERC20: parseFloat(erc20Fee) || 15,
                    BEP20: parseFloat(bep20Fee) || 3
                }
            };
            
            localStorage.setItem('system_settings', JSON.stringify(settings));
            
            if (referrerReward && refereeReward) {
                window.sharedData.REFERRAL_SETTINGS.referrerReward = parseFloat(referrerReward);
                window.sharedData.REFERRAL_SETTINGS.refereeReward = parseFloat(refereeReward);
            }
            
            showAdminNotification('âœ… ØªÙ… Ø­ÙØ¸ Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ù†Ø¸Ø§Ù…', 'success');
        }

        // ---------- ØªØµØ¯ÙŠØ± Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ† ----------
        function exportUsers() {
            const users = adminData.users;
            let csv = 'Ø§Ù„Ø§Ø³Ù…,Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…,Ø§Ù„Ø¨Ø±ÙŠØ¯,Ø§Ù„Ù‡Ø§ØªÙ,Ø§Ù„Ø±ØµÙŠØ¯,Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø£Ø±Ø¨Ø§Ø­,Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù…Ø³Ø­ÙˆØ¨Ø§Øª,Ø§Ù„Ø¨Ø§Ù‚Ø©,ØªØ§Ø±ÙŠØ® Ø§Ù„ØªØ³Ø¬ÙŠÙ„,Ø§Ù„Ø­Ø§Ù„Ø©\n';
            
            users.forEach(user => {
                csv += `"${user.name || ''}","${user.username || ''}","${user.email || ''}","${user.phone || ''}",${user.balance || 0},${user.totalEarned || 0},${user.totalWithdrawn || 0},"${user.package?.name || 'Ù„Ø§ ÙŠÙˆØ¬Ø¯'}",${user.joinedDate || ''},"${user.status || 'active'}"\n`;
            });
            
            downloadCSV(csv, `users_${new Date().toISOString().split('T')[0]}.csv`);
            showAdminNotification('âœ… ØªÙ… ØªØµØ¯ÙŠØ± Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†', 'success');
        }

        // ---------- ØªØµØ¯ÙŠØ± Ø·Ù„Ø¨Ø§Øª Ø§Ù„Ø³Ø­Ø¨ ----------
        function exportWithdrawals() {
            const withdrawals = adminData.withdrawals;
            let csv = 'Ø±Ù‚Ù… Ø§Ù„Ø·Ù„Ø¨,Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…,Ø§Ù„Ù…Ø¨Ù„Øº,Ø§Ù„Ø±Ø³ÙˆÙ…,Ø§Ù„Ø´Ø¨ÙƒØ©,Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ù…Ø­ÙØ¸Ø©,Ø§Ù„Ø­Ø§Ù„Ø©,Ø§Ù„ØªØ§Ø±ÙŠØ®\n';
            
            withdrawals.forEach(w => {
                csv += `#WD${w.id || ''},"${w.userName || ''}",${w.amount || 0},${w.fee || 5},"${w.network || 'TRC20'}","${w.wallet || ''}",${w.status || ''},${w.date || ''}\n`;
            });
            
            downloadCSV(csv, `withdrawals_${new Date().toISOString().split('T')[0]}.csv`);
            showAdminNotification('âœ… ØªÙ… ØªØµØ¯ÙŠØ± Ø·Ù„Ø¨Ø§Øª Ø§Ù„Ø³Ø­Ø¨', 'success');
        }

        // ---------- ØªØµØ¯ÙŠØ± Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…Ø¹Ø§Ù…Ù„Ø§Øª ----------
        function exportAllTransactions() {
            const transactions = adminData.transactions;
            let csv = 'Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…,Ø§Ù„Ù†ÙˆØ¹,Ø§Ù„ÙˆØµÙ,Ø§Ù„Ù…Ø¨Ù„Øº,Ø§Ù„ØªØ§Ø±ÙŠØ®,Ø§Ù„Ø­Ø§Ù„Ø©\n';
            
            transactions.forEach(t => {
                csv += `"${t.userName || ''}",${t.type || ''},"${t.description || ''}",${t.amount || 0},${t.date || ''},${t.status || 'Ù…ÙƒØªÙ…Ù„'}\n`;
            });
            
            downloadCSV(csv, `transactions_${new Date().toISOString().split('T')[0]}.csv`);
            showAdminNotification('âœ… ØªÙ… ØªØµØ¯ÙŠØ± Ø§Ù„Ù…Ø¹Ø§Ù…Ù„Ø§Øª', 'success');
        }

        // ---------- ØªØµØ¯ÙŠØ± Ø§Ù„Ù†Ø´Ø§Ø·Ø§Øª ----------
        function exportActivities() {
            const activities = [];
            
            adminData.transactions.slice(0, 100).forEach(t => {
                activities.push({
                    user: t.userName,
                    action: t.description || t.type,
                    amount: t.amount,
                    date: t.date,
                    status: t.status || 'Ù…ÙƒØªÙ…Ù„'
                });
            });
            
            let csv = 'Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…,Ø§Ù„Ù†Ø´Ø§Ø·,Ø§Ù„Ù…Ø¨Ù„Øº,Ø§Ù„ØªØ§Ø±ÙŠØ®,Ø§Ù„Ø­Ø§Ù„Ø©\n';
            activities.forEach(a => {
                csv += `"${a.user || ''}","${a.action || ''}",${a.amount || 0},${a.date || ''},${a.status || ''}\n`;
            });
            
            downloadCSV(csv, `activities_${new Date().toISOString().split('T')[0]}.csv`);
            showAdminNotification('âœ… ØªÙ… ØªØµØ¯ÙŠØ± Ø§Ù„Ù†Ø´Ø§Ø·Ø§Øª', 'success');
        }

        // ---------- ØªØ­Ù…ÙŠÙ„ Ù…Ù„Ù CSV ----------
        function downloadCSV(csv, filename) {
            const blob = new Blob(['\ufeff' + csv], { type: 'text/csv;charset=utf-8;' });
            const link = document.createElement('a');
            link.href = URL.createObjectURL(blob);
            link.download = filename;
            link.click();
            URL.revokeObjectURL(link.href);
        }

        // ---------- Ø¥Ù†Ø´Ø§Ø¡ ØªÙ‚Ø±ÙŠØ± ----------
        function generateReport(type) {
            const stats = window.sharedData.getDashboardStats();
            const userStats = window.sharedData.getUserManagementStats();
            const referralStats = calculateReferralStats();
            
            let reportData = {};
            
            if (type === 'daily') {
                reportData = {
                    'Ù†ÙˆØ¹ Ø§Ù„ØªÙ‚Ø±ÙŠØ±': 'ØªÙ‚Ø±ÙŠØ± ÙŠÙˆÙ…ÙŠ',
                    'Ø§Ù„ØªØ§Ø±ÙŠØ®': new Date().toLocaleDateString('ar-SA'),
                    'Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†': stats.totalUsers || 0,
                    'Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ† Ø¬Ø¯Ø¯ Ø§Ù„ÙŠÙˆÙ…': adminData.users.filter(u => {
                        const joinDate = u.joinedDate ? new Date(u.joinedDate).toDateString() : '';
                        return joinDate === new Date().toDateString();
                    }).length,
                    'Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ† Ø§Ù„Ù†Ø´Ø·ÙŠÙ†': userStats.active || 0,
                    'Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ† Ø§Ù„Ù…Ø¹Ù„Ù‚ÙŠÙ†': userStats.suspended || 0,
                    'Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ† Ø§Ù„Ù…Ø­Ø¸ÙˆØ±ÙŠÙ†': userStats.banned || 0,
                    'Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø¥ÙŠØ¯Ø§Ø¹Ø§Øª': `${(stats.totalDeposits || 0).toFixed(2)}$`,
                    'Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù…Ø³Ø­ÙˆØ¨Ø§Øª': `${(stats.totalWithdrawals || 0).toFixed(2)}$`,
                    'Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø£Ø±Ø¨Ø§Ø­': `${(stats.totalProfits || 0).toFixed(2)}$`,
                    'Ø§Ù„Ø§Ø´ØªØ±Ø§ÙƒØ§Øª Ø§Ù„Ù†Ø´Ø·Ø©': stats.activeSubscriptions || 0,
                    'Ø·Ù„Ø¨Ø§Øª Ù…Ø¹Ù„Ù‚Ø©': (stats.pendingPackages || 0) + (stats.pendingWithdrawals || 0),
                    'Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø¥Ø­Ø§Ù„Ø§Øª': referralStats.totalReferrals || 0,
                    'Ø£Ø±Ø¨Ø§Ø­ Ø§Ù„Ø¥Ø­Ø§Ù„Ø©': `${(referralStats.totalEarnings || 0).toFixed(2)}$`,
                    'Ø¹Ù…ÙˆÙ„Ø§Øª Ù…Ø¹Ù„Ù‚Ø©': `${(referralStats.pendingCommission || 0).toFixed(2)}$`
                };
            } else {
                reportData = {
                    'Ù†ÙˆØ¹ Ø§Ù„ØªÙ‚Ø±ÙŠØ±': 'ØªÙ‚Ø±ÙŠØ± Ø´Ù‡Ø±ÙŠ',
                    'Ø§Ù„Ø´Ù‡Ø±': new Date().toLocaleDateString('ar-SA', { month: 'long', year: 'numeric' }),
                    'Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†': stats.totalUsers || 0,
                    'Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ† Ø§Ù„Ø¬Ø¯Ø¯ Ù‡Ø°Ø§ Ø§Ù„Ø´Ù‡Ø±': adminData.users.filter(u => {
                        const joinDate = u.joinedDate ? new Date(u.joinedDate) : null;
                        const now = new Date();
                        return joinDate && joinDate.getMonth() === now.getMonth() && joinDate.getFullYear() === now.getFullYear();
                    }).length,
                    'Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø¥ÙŠØ¯Ø§Ø¹Ø§Øª': `${(stats.totalDeposits || 0).toFixed(2)}$`,
                    'Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù…Ø³Ø­ÙˆØ¨Ø§Øª': `${(stats.totalWithdrawals || 0).toFixed(2)}$`,
                    'ØµØ§ÙÙŠ Ø§Ù„Ø±Ø¨Ø­': `${((stats.totalDeposits || 0) - (stats.totalWithdrawals || 0)).toFixed(2)}$`,
                    'Ø§Ù„Ø§Ø´ØªØ±Ø§ÙƒØ§Øª Ø§Ù„Ù†Ø´Ø·Ø©': stats.activeSubscriptions || 0,
                    'Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø¥Ø­Ø§Ù„Ø§Øª': referralStats.totalReferrals || 0,
                    'Ø£Ø±Ø¨Ø§Ø­ Ø§Ù„Ø¥Ø­Ø§Ù„Ø©': `${(referralStats.totalEarnings || 0).toFixed(2)}$`,
                    'Ù…Ø¹Ø¯Ù„ Ø§Ù„ØªØ­ÙˆÙŠÙ„': `${referralStats.conversionRate || 0}%`
                };
            }
            
            const reportWindow = window.open('', '_blank');
            reportWindow.document.write(`
                <!DOCTYPE html>
                <html dir="rtl">
                <head>
                    <title>${reportData['Ù†ÙˆØ¹ Ø§Ù„ØªÙ‚Ø±ÙŠØ±']} - Elite Investors</title>
                    <meta charset="UTF-8">
                    <style>
                        body { font-family: 'Arial', sans-serif; padding: 30px; background: #0f172a; color: white; }
                        h1 { color: #7c3aed; border-bottom: 2px solid #7c3aed; padding-bottom: 15px; margin-bottom: 30px; }
                        h2 { color: #06b6d4; margin-top: 30px; }
                        table { width: 100%; border-collapse: collapse; margin: 20px 0; background: #1e293b; border-radius: 10px; overflow: hidden; }
                        th { background: #7c3aed; color: white; padding: 15px; text-align: right; }
                        td { padding: 12px 15px; border-bottom: 1px solid #334155; color: #e2e8f0; }
                        tr:hover { background: #2d3a4f; }
                        .stat-box { background: #1e293b; border-radius: 10px; padding: 20px; margin: 15px 0; border-right: 5px solid #7c3aed; }
                        .stat-value { font-size: 24px; font-weight: bold; color: #10b981; }
                        .footer { margin-top: 40px; text-align: center; color: #94a3b8; font-size: 14px; border-top: 1px solid #334155; padding-top: 20px; }
                    </style>
                </head>
                <body>
                    <h1>ğŸ“Š ${reportData['Ù†ÙˆØ¹ Ø§Ù„ØªÙ‚Ø±ÙŠØ±']}</h1>
                    <p style="color: #94a3b8;">ØªØ§Ø±ÙŠØ® Ø§Ù„Ø¥Ù†Ø´Ø§Ø¡: ${new Date().toLocaleString('ar-SA')}</p>
                    
                    <div class="stat-box">
                        <h2 style="margin-top: 0;">ğŸ“ˆ Ù…Ù„Ø®Øµ Ø³Ø±ÙŠØ¹</h2>
                        <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 20px;">
                            <div><p>Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†</p><div class="stat-value">${reportData['Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†']}</div></div>
                            <div><p>Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø¥ÙŠØ¯Ø§Ø¹Ø§Øª</p><div class="stat-value">${reportData['Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø¥ÙŠØ¯Ø§Ø¹Ø§Øª']}</div></div>
                            <div><p>Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø¥Ø­Ø§Ù„Ø§Øª</p><div class="stat-value">${reportData['Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø¥Ø­Ø§Ù„Ø§Øª']}</div></div>
                            <div><p>Ø£Ø±Ø¨Ø§Ø­ Ø§Ù„Ø¥Ø­Ø§Ù„Ø©</p><div class="stat-value">${reportData['Ø£Ø±Ø¨Ø§Ø­ Ø§Ù„Ø¥Ø­Ø§Ù„Ø©']}</div></div>
                        </div>
                    </div>
                    
                    <h2>ğŸ“‹ ØªÙØ§ØµÙŠÙ„ Ø§Ù„ØªÙ‚Ø±ÙŠØ±</h2>
                    <table>
                        <thead><tr><th>Ø§Ù„Ø¨ÙŠØ§Ù†</th><th>Ø§Ù„Ù‚ÙŠÙ…Ø©</th></tr></thead>
                        <tbody>
                            ${Object.entries(reportData).map(([key, value]) => `<tr><td style="font-weight: bold;">${key}</td><td>${value}</td></tr>`).join('')}
                        </tbody>
                    </table>
                    
                    <div class="footer">
                        <p>ØªÙ… Ø¥Ù†Ø´Ø§Ø¡ Ù‡Ø°Ø§ Ø§Ù„ØªÙ‚Ø±ÙŠØ± ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹ Ø¨ÙˆØ§Ø³Ø·Ø© Ù†Ø¸Ø§Ù… Elite Investors</p>
                        <p>Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ‚ Ù…Ø­ÙÙˆØ¸Ø© Â© ${new Date().getFullYear()}</p>
                    </div>
                </body>
                </html>
            `);
            reportWindow.document.close();
            
            showAdminNotification(`âœ… ØªÙ… Ø¥Ù†Ø´Ø§Ø¡ ${reportData['Ù†ÙˆØ¹ Ø§Ù„ØªÙ‚Ø±ÙŠØ±']}`, 'success');
        }

        // ---------- Ø¥Ø¸Ù‡Ø§Ø± Ø¥Ø´Ø¹Ø§Ø± Ø§Ù„Ø¥Ø¯Ø§Ø±Ø© ----------
        function showAdminNotification(message, type = 'success') {
            const notification = document.createElement('div');
            notification.className = `admin-notification ${type === 'error' ? 'error' : type === 'warning' ? 'warning' : ''}`;
            notification.innerHTML = `
                <div style="display: flex; align-items: center; gap: 12px;">
                    <i class="fas fa-${type === 'success' ? 'check-circle' : type === 'error' ? 'times-circle' : 'exclamation-triangle'}" 
                       style="color: ${type === 'success' ? 'var(--admin-success)' : type === 'error' ? 'var(--admin-danger)' : 'var(--admin-warning)'}; font-size: 20px;"></i>
                    <span style="font-size: 15px;">${message}</span>
                </div>
            `;
            document.body.appendChild(notification);
            setTimeout(() => notification.remove(), 4000);
        }

        // ---------- Ø§Ù„ØªÙ†Ù‚Ù„ Ø¨ÙŠÙ† Ø§Ù„Ø£Ù‚Ø³Ø§Ù… ----------
        function showSection(sectionId) {
            document.querySelectorAll('.section').forEach(s => s.classList.remove('active'));
            document.querySelectorAll('.sidebar-menu a').forEach(l => l.classList.remove('active'));
            
            document.getElementById(sectionId + '-section').classList.add('active');
            event.currentTarget.classList.add('active');
            
            if (sectionId === 'dashboard') { updateDashboardStats(); updateCharts(); }
            else if (sectionId === 'users') loadUsers();
            else if (sectionId === 'referrals') loadReferrals();
            else if (sectionId === 'pending') loadPendingRequests();
            else if (sectionId === 'subscriptions') loadSubscriptions();
            else if (sectionId === 'withdrawals') loadWithdrawals();
            else if (sectionId === 'transactions') loadAllTransactions();
        }

        // ---------- ØªÙ‡ÙŠØ¦Ø© Ø§Ù„ØµÙØ­Ø© ----------
        document.addEventListener('DOMContentLoaded', function() {
            initAdminPanel();
            
            const savedSettings = JSON.parse(localStorage.getItem('system_settings'));
            if (savedSettings) {
                if (document.getElementById('minWithdrawal')) document.getElementById('minWithdrawal').value = savedSettings.minWithdrawal || 50;
                if (document.getElementById('trc20Fee')) document.getElementById('trc20Fee').value = savedSettings.withdrawalFees?.TRC20 || 5;
                if (document.getElementById('erc20Fee')) document.getElementById('erc20Fee').value = savedSettings.withdrawalFees?.ERC20 || 15;
                if (document.getElementById('bep20Fee')) document.getElementById('bep20Fee').value = savedSettings.withdrawalFees?.BEP20 || 3;
                if (document.getElementById('referrerReward')) document.getElementById('referrerReward').value = savedSettings.referrerReward || 50;
                if (document.getElementById('refereeReward')) document.getElementById('refereeReward').value = savedSettings.refereeReward || 20;
            }
            
            const referralSettings = JSON.parse(localStorage.getItem('referral_settings'));
            if (referralSettings) {
                window.sharedData.REFERRAL_SETTINGS.referrerReward = referralSettings.referrerReward || 50;
                window.sharedData.REFERRAL_SETTINGS.refereeReward = referralSettings.refereeReward || 20;
            }
            
            console.log('âœ… Ù„ÙˆØ­Ø© Ø§Ù„Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…ØªÙ‚Ø¯Ù…Ø© Ø¬Ø§Ù‡Ø²Ø© Ù„Ù„Ø¹Ù…Ù„');
        });
    </script>
</body>
</html>